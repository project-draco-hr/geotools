{
  if (conn == null)   return;
  Statement st=conn.createStatement();
  if (!first) {
    try {
      st.execute("DROP TABLE ora_test_points");
      st.executeUpdate("DELETE FROM user_sdo_geom_metadata WHERE TABLE_NAME='ORA_TEST_POINTS'");
    }
 catch (    SQLException noPrevRun) {
    }
    first=true;
  }
  try {
    if (st.executeQuery("SELECT TABLE_NAME FROM USER_TABLES WHERE TABLE_NAME = 'ORA_TEST_POINTS'").next()) {
      try {
        st.executeUpdate("DELETE FROM ORA_TEST_POINTS");
      }
 catch (      SQLException fine) {
        fine.printStackTrace();
      }
    }
 else {
      st.execute("CREATE TABLE ORA_TEST_POINTS (" + "       NAME VARCHAR2(15)," + "       INTVAL NUMBER(12,0),"+ ""+ "       ID NUMBER(3,0) PRIMARY KEY,"+ "       SHAPE MDSYS.SDO_GEOMETRY )");
      st.execute("INSERT INTO user_sdo_geom_metadata (TABLE_NAME, COLUMN_NAME, DIMINFO, SRID )" + "VALUES('ORA_TEST_POINTS','SHAPE'," + "MDSYS.SDO_DIM_ARRAY(MDSYS.SDO_DIM_ELEMENT('X',0,-20,0.5),MDSYS.SDO_DIM_ELEMENT('Y',0,10,0.5)),"+ "4326)");
      st.execute("CREATE INDEX ORA_TEST_POINTS_SHAPE_IDX " + "ON ORA_TEST_POINTS (SHAPE) INDEXTYPE IS " + "MDSYS.SPATIAL_INDEX PARAMETERS (' SDO_INDX_DIMS=2 LAYER_GTYPE=\"POINT\"') ");
    }
  }
 catch (  SQLException fine) {
    fine.printStackTrace();
  }
  if (st.executeQuery("SELECT TABLE_NAME FROM USER_TABLES WHERE TABLE_NAME = 'ORA_TEST_LINES'").next()) {
    try {
      st.execute("DROP TABLE ORA_TEST_LINES");
      st.executeUpdate("DELETE FROM user_sdo_geom_metadata WHERE TABLE_NAME='ORA_TEST_LINES'");
    }
 catch (    SQLException noPrevRun) {
      noPrevRun.printStackTrace();
    }
  }
  try {
    st.execute("CREATE TABLE ORA_TEST_LINES (" + "    name    VARCHAR(255)," + "    intval  NUMBER,"+ "    id      NUMBER  PRIMARY KEY,"+ "    shape   MDSYS.SDO_GEOMETRY"+ ")");
    st.execute("INSERT INTO USER_SDO_GEOM_METADATA VALUES (" + "    'ORA_TEST_LINES'," + "    'SHAPE',"+ "    MDSYS.SDO_DIM_ARRAY("+ "        MDSYS.SDO_DIM_ELEMENT('X',-180,180,0.005),"+ "        MDSYS.SDO_DIM_ELEMENT('Y',-90,90,0.005)"+ "    ),"+ "    82465"+ ")");
    st.execute("create index test_line_index on ORA_TEST_LINES(SHAPE) INDEXTYPE IS MDSYS.SPATIAL_INDEX");
  }
 catch (  SQLException fine) {
    fine.printStackTrace();
  }
  st.execute("INSERT INTO ORA_TEST_POINTS VALUES ('point 1',10,1," + "MDSYS.SDO_GEOMETRY(2001,4326," + "MDSYS.SDO_POINT_TYPE(10.0, 10.0, NULL),"+ "NULL,NULL))");
  st.execute("INSERT INTO ORA_TEST_POINTS VALUES ('point 2',20,2," + "MDSYS.SDO_GEOMETRY(2001,4326," + "MDSYS.SDO_POINT_TYPE(20.0, 10.0, NULL),"+ "NULL,NULL))");
  st.execute("INSERT INTO ORA_TEST_POINTS VALUES ('point 3',30,3," + "MDSYS.SDO_GEOMETRY(2001,4326," + "SDO_POINT_TYPE(20.0, 30.0, NULL),"+ "NULL,NULL))");
  st.execute("INSERT INTO ORA_TEST_POINTS VALUES ('point 4',40,4," + "MDSYS.SDO_GEOMETRY(2001,4326," + "SDO_POINT_TYPE(30.0, 10.0, NULL),"+ "NULL,NULL))");
  st.execute("INSERT INTO ORA_TEST_POINTS VALUES ('point 5',50,5," + "MDSYS.SDO_GEOMETRY(2001,4326," + "SDO_POINT_TYPE(-20.0, 10.0, NULL),"+ "NULL,NULL))");
  st.execute("INSERT INTO ORA_TEST_LINES VALUES ('line1',50,2," + "MDSYS.SDO_GEOMETRY(2002,82465,NULL," + "SDO_ELEM_INFO_ARRAY(1,2,1),"+ "SDO_ORDINATE_ARRAY(0,0, 10, 10)))");
  st.execute("INSERT INTO ORA_TEST_LINES VALUES ('line2',100,4," + "MDSYS.SDO_GEOMETRY(2002,82465,NULL," + "SDO_ELEM_INFO_ARRAY(1,2,1),"+ "SDO_ORDINATE_ARRAY(25,25, 25, 30)))");
}
