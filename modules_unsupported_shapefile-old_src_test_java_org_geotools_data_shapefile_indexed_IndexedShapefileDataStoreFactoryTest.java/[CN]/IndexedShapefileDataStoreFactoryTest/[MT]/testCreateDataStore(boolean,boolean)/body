{
  File f=copyShapefiles(IndexedShapefileDataStoreTest.STATE_POP);
  Map map=new HashMap();
  map.put(ShapefileDataStoreFactory.URLP.key,f.toURI().toURL());
  map.put(ShapefileDataStoreFactory.CREATE_SPATIAL_INDEX.key,createIndex ? Boolean.TRUE : Boolean.FALSE);
  ShapefileDataStore ds;
  if (newDS) {
    ds=(ShapefileDataStore)factory.createNewDataStore(map);
  }
 else {
    ds=(ShapefileDataStore)factory.createDataStore(map);
  }
  if (ds instanceof IndexedShapefileDataStore) {
    IndexedShapefileDataStore indexed=(IndexedShapefileDataStore)ds;
    testDataStore(IndexType.QIX,createIndex,indexed);
  }
  return ds;
}
