{
  String database=(String)DATABASE.lookUp(params);
  String host=(String)HOST.lookUp(params);
  Boolean mvcc=(Boolean)MVCC.lookUp(params);
  BasicDataSource dataSource=new BasicDataSource();
  if (host != null && !host.equals("")) {
    Integer port=(Integer)PORT.lookUp(params);
    if (port != null && !port.equals("")) {
      dataSource.setUrl("jdbc:h2:tcp://" + host + ":"+ port+ "/"+ database);
    }
 else {
      dataSource.setUrl("jdbc:h2:tcp://" + host + "/"+ database);
    }
  }
 else   if (baseDirectory == null) {
    dataSource.setUrl("jdbc:h2:" + database + ";AUTO_SERVER=TRUE"+ (mvcc != null ? (";MVCC=" + mvcc) : ""));
  }
 else {
    String location;
    if (!new File(database).isAbsolute()) {
      location=new File(baseDirectory,database).getAbsolutePath();
    }
 else {
      location=database;
    }
    dataSource.setUrl("jdbc:h2:file:" + location + ";AUTO_SERVER=TRUE"+ (mvcc != null ? (";MVCC=" + mvcc) : ""));
  }
  String username=(String)USER.lookUp(params);
  if (username != null) {
    dataSource.setUsername(username);
  }
  String password=(String)PASSWD.lookUp(params);
  if (password != null) {
    dataSource.setPassword(password);
  }
  dataSource.setDriverClassName("org.h2.Driver");
  dataSource.setPoolPreparedStatements(false);
  return new DBCPDataSource(dataSource);
}
