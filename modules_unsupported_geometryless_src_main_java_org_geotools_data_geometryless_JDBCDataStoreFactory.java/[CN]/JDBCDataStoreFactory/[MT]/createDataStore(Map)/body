{
  if (canProcess(params)) {
  }
 else {
    throw new IOException("The parameteres map isn't correct!!");
  }
  String user=(String)USER.lookUp(params);
  String passwd=(String)PASSWD.lookUp(params);
  Charset charSet=(Charset)CHARSET.lookUp(params);
  String schema=(String)SCHEMA.lookUp(params);
  String namespace=(String)NAMESPACE.lookUp(params);
  String driver=(String)DRIVER.lookUp(params);
  String urlprefix=(String)URLPREFIX.lookUp(params);
  if (!canProcess(params)) {
    return null;
  }
  DataSource dataSource=DataSourceUtil.buildDefaultDataSource(urlprefix,driver,user,passwd,null);
  JDBCDataStore dataStore;
  if (namespace != null) {
    dataStore=new JDBCDataStore(dataSource,schema,namespace);
  }
 else {
    dataStore=new JDBCDataStore(dataSource);
  }
  ViewRegisteringFactoryHelper.registerSqlViews(dataStore,params);
  return dataStore;
}
