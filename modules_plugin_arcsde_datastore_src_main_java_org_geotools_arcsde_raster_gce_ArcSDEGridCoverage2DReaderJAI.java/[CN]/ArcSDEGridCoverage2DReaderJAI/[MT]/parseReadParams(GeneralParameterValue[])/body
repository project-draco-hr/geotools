{
  if (params == null) {
    throw new IllegalArgumentException("No GeneralParameterValue given to read operation");
  }
  GeneralEnvelope reqEnvelope=null;
  GridEnvelope dim=null;
  OverviewPolicy overviewPolicy=null;
  for (int i=0; i < params.length; i++) {
    final ParameterValue<?> param=(ParameterValue<?>)params[i];
    final String name=param.getDescriptor().getName().getCode();
    if (name.equals(AbstractGridFormat.READ_GRIDGEOMETRY2D.getName().toString())) {
      final GridGeometry2D gg=(GridGeometry2D)param.getValue();
      reqEnvelope=new GeneralEnvelope((Envelope)gg.getEnvelope2D());
      final GeneralEnvelope coverageEnvelope=getOriginalEnvelope();
      CoordinateReferenceSystem nativeCrs=coverageEnvelope.getCoordinateReferenceSystem();
      CoordinateReferenceSystem requestCrs=reqEnvelope.getCoordinateReferenceSystem();
      if (!CRS.equalsIgnoreMetadata(nativeCrs,requestCrs)) {
        LOGGER.fine("Request CRS and native CRS differ, " + "reprojecting request envelope to native CRS");
        ReferencedEnvelope nativeCrsEnv;
        nativeCrsEnv=toNativeCrs(reqEnvelope,nativeCrs);
        reqEnvelope=new GeneralEnvelope(nativeCrsEnv);
      }
      dim=gg.getGridRange2D();
      continue;
    }
    if (name.equals(AbstractGridFormat.OVERVIEW_POLICY.getName().toString())) {
      overviewPolicy=(OverviewPolicy)param.getValue();
      continue;
    }
  }
  if (reqEnvelope == null && dim == null) {
    reqEnvelope=getOriginalEnvelope();
    dim=getOriginalGridRange();
  }
  if (reqEnvelope == null) {
    reqEnvelope=getOriginalEnvelope();
  }
  if (dim == null) {
    final GeneralEnvelope adjustedGRange;
    try {
      MathTransform gridToWorld=getOriginalGridToWorld(PixelInCell.CELL_CENTER);
      MathTransform worldToGrid=gridToWorld.inverse();
      adjustedGRange=CRS.transform(worldToGrid,reqEnvelope);
    }
 catch (    Exception e) {
      throw new RuntimeException(e);
    }
    int xmin=(int)Math.floor(adjustedGRange.getMinimum(0));
    int ymin=(int)Math.floor(adjustedGRange.getMinimum(1));
    int xmax=(int)Math.ceil(adjustedGRange.getMaximum(0));
    int ymax=(int)Math.ceil(adjustedGRange.getMaximum(1));
    dim=new GridEnvelope2D(xmin,ymin,xmax - xmin,ymax - ymin);
  }
  if (!reqEnvelope.intersects(getOriginalEnvelope(),true)) {
    throw new IllegalArgumentException("The requested extend does not overlap the coverage extent: " + getOriginalEnvelope());
  }
  if (dim.getSpan(0) <= 0 || dim.getSpan(1) <= 0) {
    throw new IllegalArgumentException("The requested coverage dimension can't be null: " + dim);
  }
  if (overviewPolicy == null) {
    overviewPolicy=OverviewPolicy.NEAREST;
    LOGGER.finer("No overview policy requested, defaulting to " + overviewPolicy);
  }
  LOGGER.fine("Overview policy is " + overviewPolicy);
  ArcSDEGridCoverage2DReaderJAI.ReadParameters parsedParams=new ArcSDEGridCoverage2DReaderJAI.ReadParameters();
  parsedParams.requestedEnvelope=reqEnvelope;
  parsedParams.dim=dim;
  parsedParams.overviewPolicy=overviewPolicy;
  return parsedParams;
}
