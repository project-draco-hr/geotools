{
  final AbstractGridFormat format=(AbstractGridFormat)GridFormatFinder.findFormat(inputLocation);
  if (format == null) {
    String message="Could not find a format for this coverage";
    fireException(message,0,new IOException(message));
    return;
  }
  final GridCoverage2DReader inReader=(GridCoverage2DReader)format.getReader(inputLocation);
  if (inReader == null) {
    String message="Unable to instantiate a reader for this coverage";
    fireException(message,0,new IOException(message));
    return;
  }
  envelope=inReader.getOriginalEnvelope();
  try {
    inReader.dispose();
  }
 catch (  IOException e) {
    LOGGER.log(Level.SEVERE,"Failure occurred while closing grid coverage reader",e);
  }
  if (!outputLocation.exists())   if (!outputLocation.mkdir()) {
    String message="Could not create output directory: " + outputLocation;
    fireException(message,0,new IOException(message));
    return;
  }
  totalSteps=(numSteps + 1) * 2;
  currStep=1;
  File outputDir=new File(outputLocation,"0");
  if (!checkLayerDir(outputDir))   return;
  resolutions=new double[2][numSteps + 1];
  tileInput(outputDir);
  if (exceptionOccurred)   return;
  currStep++;
  double[] resolution=mosaicLevel(0);
  resolutions[0][0]=resolution[0];
  resolutions[1][0]=resolution[1];
  if (exceptionOccurred)   return;
  currStep++;
  int currLevel=scaleFactor;
  int prevLevel=0;
  for (int step=0; step < numSteps; step++) {
    final File prevLevelDirectory=new File(outputLocation,String.valueOf(prevLevel));
    final File currLevelDirectory=new File(outputLocation,String.valueOf(currLevel));
    if (!checkLayerDir(currLevelDirectory))     return;
    buildNewLayer(prevLevelDirectory,currLevelDirectory);
    if (exceptionOccurred)     return;
    currStep++;
    resolution=mosaicLevel(currLevel);
    resolutions[0][step + 1]=resolution[0];
    resolutions[1][step + 1]=resolution[1];
    if (exceptionOccurred)     return;
    currStep++;
    prevLevel=currLevel;
    currLevel*=scaleFactor;
  }
  fireEvent("Creating final properties file ",99.9);
  createPropertiesFiles();
  if (!exceptionOccurred)   fireEvent("Done!!!",100);
}
