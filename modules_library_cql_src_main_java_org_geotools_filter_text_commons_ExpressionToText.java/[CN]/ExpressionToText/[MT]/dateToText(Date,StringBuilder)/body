{
  final DateFormat formatter;
  if (date.getTime() % 1000 == 0) {
    formatter=new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssz");
  }
 else {
    formatter=new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSSz");
  }
  formatter.setTimeZone(TimeZone.getTimeZone("GMT+00:00"));
  String text=formatter.format(date);
  text=text.replace("GMT","");
  output.append(text);
  return output;
}
