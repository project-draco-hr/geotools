{
  double minDist=Double.MAX_VALUE;
  int count=-1;
  int countunique=-1;
  float proportion=Float.NaN;
  float proportionUnique=Float.NaN;
  for (SimpleFeatureIterator it=result.features(); it.hasNext(); ) {
    SimpleFeature f=it.next();
    Coordinate outPt=((Point)f.getDefaultGeometry()).getCoordinate();
    double dist=outPt.distance(testPt);
    if (dist < minDist) {
      minDist=dist;
      count=(Integer)f.getAttribute(PointStackerProcess.ATTR_COUNT);
      countunique=(Integer)f.getAttribute(PointStackerProcess.ATTR_COUNT_UNIQUE);
      if (expectedProportion != null) {
        proportion=(Float)f.getAttribute(PointStackerProcess.ATTR_PROPORTION);
        proportionUnique=(Float)f.getAttribute(PointStackerProcess.ATTR_PROPORTION_UNIQUE);
      }
    }
  }
  assertEquals(expectedCount,count);
  assertEquals(expectedCountUnique,countunique);
  if (expectedProportion != null)   assertEquals(expectedProportion,proportion,0.0001);
  if (expectedProportionUnique != null)   assertEquals(expectedProportionUnique,proportionUnique,0.0001);
}
