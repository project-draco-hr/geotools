{
  if (!verticalSubset.isEmpty()) {
    for (    NumberRange<Double> envelope : verticalSubset) {
      VerticalExtent ve=sd.getVerticalExtent();
      if (ve != null) {
        NumberRange<Double> verticalEnvelope=NumberRange.create(ve.getMinimumValue().doubleValue(),ve.getMaximumValue().doubleValue());
        if (verticalEnvelope.contains(envelope)) {
          final int imageIndex=((SliceDescriptor)sd).getImageIndex();
          GridCoverage gc=Utilities.compute(DefaultFileDriver.urlToFile(access.getInput()),imageIndex,needTransformation,emptyRequest,useJAI,imageReadParam,false,sampleDimensions,GRIB1Driver.spi,this.name.toString(),coverageFactory,access.raster2ModelMap.get(this.name),access.spatialReferenceSystem2DMap.get(this.name),access.coverageEnvelope2DMap.get(this.name));
          if (gc != null)           response.addResult(gc);
        }
      }
    }
  }
 else {
    final int imageIndex=((SliceDescriptor)sd).getImageIndex();
    GridCoverage gc=Utilities.compute(DefaultFileDriver.urlToFile(access.getInput()),imageIndex,needTransformation,emptyRequest,useJAI,imageReadParam,false,sampleDimensions,GRIB1Driver.spi,this.name.toString(),coverageFactory,access.raster2ModelMap.get(this.name),access.spatialReferenceSystem2DMap.get(this.name),access.coverageEnvelope2DMap.get(this.name));
    if (gc != null)     response.addResult(gc);
  }
}
