{
  if (imageMetadata == null)   throw new NullPointerException(Errors.format(ErrorKeys.NULL_ARGUMENT_$1,"imageMetadata"));
  rootNode=(IIOMetadataNode)imageMetadata.getAsTree(imageMetadata.getNativeMetadataFormatName());
  if (rootNode == null) {
    throw new IllegalArgumentException("Unable to retrieve metadata");
  }
  tiffTagsEntries=(IIOMetadataNode)rootNode.getFirstChild().getChildNodes();
  if (tiffTagsEntries == null) {
    throw new IllegalArgumentException("Unable to retrieve metadata");
  }
  numTiffTasEntries=tiffTagsEntries.getLength();
  geoKeyDir=getTiffField(GeoTIFFTagSet.TAG_GEO_KEY_DIRECTORY);
  if (geoKeyDir != null) {
    geoKeyDirEntries=geoKeyDir.getFirstChild().getChildNodes();
    geoKeyDirVersion=getTiffShort(geoKeyDir,GeoTiffGCSCodes.GEO_KEY_DIRECTORY_VERSION_INDEX);
    geoKeyRevision=getTiffShort(geoKeyDir,GeoTiffGCSCodes.GEO_KEY_REVISION_INDEX);
    if (geoKeyRevision != 1) {
      geoKeyRevision=1;
    }
    geoKeyMinorRevision=getTiffShort(geoKeyDir,GeoTiffGCSCodes.GEO_KEY_MINOR_REVISION_INDEX);
    geoKeyDirTagsNum=getTiffShort(geoKeyDir,GeoTiffGCSCodes.GEO_KEY_NUM_KEYS_INDEX);
    geoKeyDirEntriesNum=geoKeyDirEntries.getLength();
  }
  geoKeyDoubleParams=getTiffField(GeoTIFFTagSet.TAG_GEO_DOUBLE_PARAMS);
  geoKeyAsciiParams=getTiffField(GeoTIFFTagSet.TAG_GEO_ASCII_PARAMS);
}
