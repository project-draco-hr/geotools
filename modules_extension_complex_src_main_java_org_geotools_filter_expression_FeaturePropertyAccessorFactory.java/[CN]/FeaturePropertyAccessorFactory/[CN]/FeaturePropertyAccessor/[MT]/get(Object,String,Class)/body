{
  JXPathContext context=JXPathContext.newContext(object);
  Enumeration declaredPrefixes=namespaces.getDeclaredPrefixes();
  while (declaredPrefixes.hasMoreElements()) {
    String prefix=(String)declaredPrefixes.nextElement();
    String uri=namespaces.getURI(prefix);
    context.registerNamespace(prefix,uri);
  }
  Iterator it=context.iterate(xpath);
  List results=new ArrayList<Object>();
  while (it.hasNext()) {
    results.add(it.next());
  }
  if (results.size() == 0) {
    throw new IllegalArgumentException("x-path gives no results.");
  }
 else   if (results.size() == 1) {
    return results.get(0);
  }
 else {
    return results;
  }
}
