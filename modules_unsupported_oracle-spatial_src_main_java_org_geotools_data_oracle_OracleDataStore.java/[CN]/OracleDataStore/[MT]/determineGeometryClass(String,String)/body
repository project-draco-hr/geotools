{
  Connection conn=null;
  Statement statement=null;
  ResultSet result=null;
  try {
    String sqlStatement="select meta.sdo_layer_gtype \n" + "from mdsys.ALL_SDO_INDEX_INFO info \n" + " inner join mdsys.user_sdo_index_metadata meta \n"+ " on info.index_name = meta.sdo_index_name \n"+ "where info.table_name = '" + tableName + "' \n"+ "and info.column_name = '"+ columnName+ "'";
    String schema=config.getDatabaseSchemaName();
    if (schema != null && !"".equals(schema)) {
      sqlStatement+=" and info.table_owner = '" + schema + "'";
    }
    conn=getConnection(Transaction.AUTO_COMMIT);
    LOGGER.finer("the sql statement for geometry type check is " + sqlStatement);
    statement=conn.createStatement();
    result=statement.executeQuery(sqlStatement);
    if (result.next()) {
      String gType=result.getString(1);
      Class geometryClass=(Class)TT.GEOM_CLASSES.get(gType);
      if (geometryClass == null)       geometryClass=Geometry.class;
      return geometryClass;
    }
 else {
      return Geometry.class;
    }
  }
 catch (  SQLException sqle) {
    String message=sqle.getMessage();
    LOGGER.fine("Could not determine geometry class due to an error_: " + sqle);
    throw new DataSourceException(message,sqle);
  }
 finally {
    JDBCUtils.close(result);
    JDBCUtils.close(statement);
    JDBCUtils.close(conn,Transaction.AUTO_COMMIT,null);
  }
}
