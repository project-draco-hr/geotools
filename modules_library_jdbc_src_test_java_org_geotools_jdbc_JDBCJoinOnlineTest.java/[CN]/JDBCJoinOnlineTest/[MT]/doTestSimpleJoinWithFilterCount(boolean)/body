{
  dataStore.setExposePrimaryKeyColumns(exposePrimaryKeys);
  FilterFactory ff=dataStore.getFilterFactory();
  Query q=new Query(tname("ft1"));
  Join j=new Join(tname("ftjoin"),ff.equal(ff.property(aname("stringProperty")),ff.property(aname("name")),true));
  j.filter(ff.greater(ff.property(aname("join1intProperty")),ff.literal(1)));
  q.getJoins().add(j);
  q.setFilter(ff.less(ff.property(aname("intProperty")),ff.literal(3)));
  assertEquals(1,dataStore.getFeatureSource(tname("ft1")).getCount(q));
}
