{
  if (image == null) {
    final int numBands=variables.size();
    if (numBands == 0) {
      image=new BufferedImage(width,height,BufferedImage.TYPE_BYTE_GRAY);
    }
 else {
      final GridSampleDimension sd=variables.get(0).getSampleDimension();
      final ColorModel cm;
      if (numBands == 1) {
        cm=sd.getColorModel();
      }
 else {
        cm=sd.getColorModel(0,numBands);
      }
      final WritableRaster raster=cm.createCompatibleWritableRaster(width,height);
      image=new BufferedImage(cm,raster,false,null);
    }
  }
  return image;
}
