{
  GeneralMatrix l=new GeneralMatrix(3 * getMappedPositions().size(),1);
  GeneralMatrix R=new GeneralMatrix(3,3);
  GeneralMatrix T=new GeneralMatrix(3,1,new double[]{-dx,-dy,-dz});
  GeneralMatrix qMatrix=new GeneralMatrix(1,1,new double[]{q});
  GeneralMatrix qx=new GeneralMatrix(X.getNumRow(),X.getNumCol());
  qx.mul(x,qMatrix);
  R.mul(getRalfa(),getRbeta());
  R.mul(getRgamma());
  l.sub(specialMul(R,qx),X);
  l=specialSub(T,l);
  return l;
}
