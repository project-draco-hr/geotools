{
  query=joinQuery(query);
  query=resolvePropertyNames(query);
  FeatureWriter<SimpleFeatureType,SimpleFeature> writer=getWriterInternal(query,flags);
  LockingManager lockingManager=getDataStore().getLockingManager();
  return ((InProcessLockingManager)lockingManager).checkedWriter(writer,transaction);
}
