{
  List<FeatureId> ids=new LinkedList<FeatureId>();
  FeatureWriter<SimpleFeatureType,SimpleFeature> writer=getWriterAppend();
  FeatureIterator<SimpleFeature> f=collection.features();
  try {
    while (f.hasNext()) {
      SimpleFeature feature=(SimpleFeature)f.next();
      FeatureId id=addFeature(feature,writer);
      ids.add(id);
    }
  }
  finally {
    writer.close();
    f.close();
  }
  return ids;
}
