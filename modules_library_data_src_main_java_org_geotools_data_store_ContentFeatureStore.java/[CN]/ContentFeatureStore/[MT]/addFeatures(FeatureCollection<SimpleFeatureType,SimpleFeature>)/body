{
  List<FeatureId> ids=new LinkedList<FeatureId>();
  FeatureWriter<SimpleFeatureType,SimpleFeature> writer=getWriter(Filter.INCLUDE,WRITER_ADD);
  Iterator f=collection.iterator();
  try {
    while (f.hasNext()) {
      SimpleFeature feature=(SimpleFeature)f.next();
      FeatureId id=addFeature(feature,writer);
      ids.add(id);
    }
  }
  finally {
    writer.close();
    collection.close(f);
  }
  return ids;
}
