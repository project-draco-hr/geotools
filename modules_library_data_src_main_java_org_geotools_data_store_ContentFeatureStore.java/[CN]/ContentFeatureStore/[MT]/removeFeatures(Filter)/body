{
  if (filter == null) {
    String msg="Must specify a filter, must not be null.";
    throw new IllegalArgumentException(msg);
  }
  filter=resolvePropertyNames(filter);
  FeatureWriter<SimpleFeatureType,SimpleFeature> writer=getWriter(filter,WRITER_UPDATE);
  try {
    while (writer.hasNext()) {
      writer.next();
      writer.remove();
      writer.write();
    }
  }
  finally {
    writer.close();
  }
}
