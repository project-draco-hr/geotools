{
  String host=(String)HOST.lookUp(params);
  String user=(String)USER.lookUp(params);
  String passwd=(String)PASSWD.lookUp(params);
  Integer maxConn=(Integer)MAXCONN.lookUp(params);
  Integer minConn=(Integer)MINCONN.lookUp(params);
  Boolean validateConn=(Boolean)VALIDATECONN.lookUp(params);
  int port=((Integer)PORT.lookUp(params)).intValue();
  String database=(String)DATABASE.lookUp(params);
  String namespace=(String)NAMESPACE.lookUp(params);
  Boolean wkbEnabled=(Boolean)WKBENABLED.lookUp(params);
  if (!canProcess(params)) {
    LOGGER.warning("Can not process : " + params);
    throw new IOException("The parameteres map isn't correct!!");
  }
  boolean validate=(validateConn != null) && validateConn.booleanValue();
  int maxActive=(maxConn != null) ? maxConn.intValue() : 10;
  int maxIdle=(minConn != null) ? minConn.intValue() : 4;
  DataSource ds=getDefaultDataSource(host,user,passwd,port,database,maxActive,maxIdle,validate);
  MySQLDataStore store;
  if (namespace != null) {
    store=new MySQLDataStore(ds,null,namespace);
  }
 else {
    store=new MySQLDataStore(ds);
  }
  if (wkbEnabled != null)   store.setWKBEnabled(wkbEnabled.booleanValue());
  return store;
}
