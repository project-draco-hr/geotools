{
  Node currdn=(Node)current;
  AStarNode currAsn;
  AStarNode nextAsn;
  currAsn=(AStarNode)m_nodemap.get(currdn);
  if (currAsn == null) {
    throw new IllegalArgumentException("AStarIterator: The node is not in the open list");
  }
  currAsn.close();
  for (Iterator itr=currdn.getRelated(); itr.hasNext(); ) {
    Node next=(Node)itr.next();
    if (m_nodemap.containsKey(next)) {
      nextAsn=(AStarNode)m_nodemap.get(next);
      if (!nextAsn.isClosed()) {
        if ((currAsn.getG() + m_afuncs.cost(currAsn,nextAsn)) < nextAsn.getG()) {
          nextAsn.setG(currAsn.getG() + m_afuncs.cost(currAsn,nextAsn));
          nextAsn.setParent(currAsn);
          m_pqueue.update(nextAsn);
        }
      }
    }
 else {
      nextAsn=new AStarNode(next,m_afuncs.h(next));
      nextAsn.setG(currAsn.getG() + m_afuncs.cost(currAsn,nextAsn));
      nextAsn.setParent(currAsn);
      m_pqueue.add(nextAsn);
      m_nodemap.put(next,nextAsn);
    }
  }
}
