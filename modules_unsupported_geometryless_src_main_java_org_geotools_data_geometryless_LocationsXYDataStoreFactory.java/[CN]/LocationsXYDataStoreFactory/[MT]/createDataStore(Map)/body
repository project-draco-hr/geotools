{
  if (canProcess(params)) {
  }
 else {
    throw new IOException("The parameteres map isn't correct!!");
  }
  String user=(String)USER.lookUp(params);
  String passwd=(String)PASSWD.lookUp(params);
  Charset charSet=(Charset)CHARSET.lookUp(params);
  String namespace=(String)NAMESPACE.lookUp(params);
  String schema=(String)SCHEMA.lookUp(params);
  String driver=(String)DRIVER.lookUp(params);
  String urlprefix=(String)URLPREFIX.lookUp(params);
  String xcolumn=(String)XCOLUMN.lookUp(params);
  String ycolumn=(String)YCOLUMN.lookUp(params);
  String geom_name=(String)GEOMNAME.lookUp(params);
  if (!canProcess(params)) {
    return null;
  }
  DataSource dataSource=DataSourceUtil.buildDefaultDataSource(urlprefix,driver,user,passwd,null);
  LocationsXYDataStore dataStore=new LocationsXYDataStore(dataSource,schema,namespace,xcolumn,ycolumn,geom_name);
  ViewRegisteringFactoryHelper.registerSqlViews(dataStore,params);
  return dataStore;
}
