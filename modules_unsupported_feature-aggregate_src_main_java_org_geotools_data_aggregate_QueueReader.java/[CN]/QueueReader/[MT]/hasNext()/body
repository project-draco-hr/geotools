{
  if (next != null && next != FeatureQueue.END_MARKER) {
    return true;
  }
  Exception e=queue.getException();
  if (e != null) {
    throw new IOException("Data retrieval failed",e);
  }
  try {
    while (next == null || next == FeatureQueue.END_MARKER) {
      if (queue.isDone()) {
        return false;
      }
      next=queue.take();
    }
  }
 catch (  InterruptedException ie) {
    throw new IOException("Error while waiting for next feature",ie);
  }
  return true;
}
