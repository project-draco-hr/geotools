{
  Object ds=null;
  int mode=update ? 1 : 0;
  if (ogrDriver != null) {
    Object driver=ogr.GetDriverByName(ogrDriver);
    if (driver == null) {
      throw new IOException("Could not find a driver named " + driver);
    }
    ds=ogr.DriverOpen(driver,ogrSourceName,mode);
    if (ds == null) {
      throw new IOException("OGR could not open '" + ogrSourceName + "' in "+ (update ? "read-write" : "read-only")+ " mode with driver "+ ogrDriver);
    }
  }
 else {
    ds=ogr.OpenShared(ogrSourceName,mode);
    if (ds == null) {
      throw new IOException("OGR could not open '" + ogrSourceName + "' in "+ (update ? "read-write" : "read-only")+ " mode");
    }
  }
  return ds;
}
