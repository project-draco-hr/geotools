{
  List<Expression> params=new ArrayList<Expression>();
  params.add(ff.literal(point(x,y)));
  params.add(ff.literal(limit));
  if (cql != null) {
    params.add(ff.literal(cql));
    if (batch > 0) {
      params.add(ff.literal(batch));
    }
  }
  Function sdo_nn=ff.function("sdo_nn",params.toArray(new Expression[params.size()]));
  PropertyIsEqualTo equalsFilter=ff.equal(sdo_nn,ff.literal(true),false);
  Query query=new Query(tname("NEIGHBORS"),equalsFilter);
  SimpleFeatureCollection features=source.getFeatures(query);
  return features.features();
}
