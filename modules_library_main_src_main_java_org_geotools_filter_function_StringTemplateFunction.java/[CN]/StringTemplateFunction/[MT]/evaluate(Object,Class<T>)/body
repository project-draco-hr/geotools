{
  String defaultValue;
  if (parameters.size() == 4) {
    defaultValue=parameters.get(3).evaluate(object,String.class);
  }
 else {
    defaultValue=null;
  }
  String input=parameters.get(0).evaluate(object,String.class);
  Pattern pattern=getPattern(object);
  String template=parameters.get(2).evaluate(object,String.class);
  String result=defaultValue;
  if (input != null && template != null && pattern != null) {
    Matcher matcher=pattern.matcher(input);
    if (matcher.matches()) {
      result=applyTemplate(template,matcher);
    }
  }
  if (context != null) {
    return Converters.convert(result,context);
  }
 else {
    return (T)result;
  }
}
