{
  if (writer == null) {
    throw new IOException("Writer has been closed");
  }
  String fid=null;
  SimpleFeatureType type=reader.type;
  try {
    if (hasNext()) {
      reader.next();
      fid=reader.getFeatureID();
      Object values[]=new Object[reader.getAttributeCount()];
      for (int i=0; i < reader.getAttributeCount(); i++) {
        values[i]=reader.read(i);
      }
      origional=SimpleFeatureBuilder.build(type,values,fid);
      live=SimpleFeatureBuilder.copy(origional);
      return live;
    }
 else {
      fid=type.getName() + "." + System.currentTimeMillis();
      Object values[]=DataUtilities.defaultValues(type);
      origional=null;
      live=SimpleFeatureBuilder.build(type,values,fid);
      return live;
    }
  }
 catch (  IllegalAttributeException e) {
    String message="Problem creating feature " + (fid != null ? fid : "");
    throw new DataSourceException(message,e);
  }
}
