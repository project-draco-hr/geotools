{
  final ImageReferencing referencing=metadata.getReferencing();
  final Identification identDatum=referencing.getDatum();
  if (identDatum == null) {
    throw new MetadataException("The datum is not defined.");
  }
  final String name=identDatum.name;
  if (name == null) {
    throw new MetadataException("Datum name not defined.");
  }
  if (name.toUpperCase().contains("WGS84")) {
    return DefaultGeodeticDatum.WGS84;
  }
  final String primeMeridianName=referencing.getPrimeMeridianName();
  final PrimeMeridian primeMeridian;
  if ((primeMeridianName == null) || (primeMeridianName != null && primeMeridianName.toLowerCase().contains("greenwich"))) {
    primeMeridian=DefaultPrimeMeridian.GREENWICH;
  }
 else {
    final double greenwichLon=referencing.getPrimeMeridianGreenwichLongitude();
    primeMeridian=(Double.isNaN(greenwichLon)) ? DefaultPrimeMeridian.GREENWICH : new DefaultPrimeMeridian(primeMeridianName,greenwichLon);
  }
  return new DefaultGeodeticDatum(name,getEllipsoid(),primeMeridian);
}
