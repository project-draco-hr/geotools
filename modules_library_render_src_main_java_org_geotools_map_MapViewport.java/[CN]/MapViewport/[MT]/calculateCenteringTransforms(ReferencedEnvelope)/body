{
  if (!(requestedBounds.isEmpty() || screenArea.isEmpty())) {
    double xscale=screenArea.getWidth() / requestedBounds.getWidth();
    double yscale=screenArea.getHeight() / requestedBounds.getHeight();
    double scale=Math.min(xscale,yscale);
    double xoff=requestedBounds.getMedian(0) * scale - screenArea.getCenterX();
    double yoff=requestedBounds.getMedian(1) * scale + screenArea.getCenterY();
    worldToScreen=new AffineTransform(scale,0,0,-scale,-xoff,yoff);
    try {
      screenToWorld=worldToScreen.createInverse();
    }
 catch (    NoninvertibleTransformException ex) {
      throw new RuntimeException("Unable to create coordinate transforms.",ex);
    }
  }
}
