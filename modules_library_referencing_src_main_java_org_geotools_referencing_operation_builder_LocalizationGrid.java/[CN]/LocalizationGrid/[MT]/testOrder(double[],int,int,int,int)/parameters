double[] grid
int offset
int num
int step
int flags
