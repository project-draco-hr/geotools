{
  joinReaders=new ArrayList<JDBCFeatureReader>();
  int offset=featureType.getAttributeCount();
  if (!featureSource.isExposePrimaryKeyColumns()) {
    offset+=getPrimaryKey().getColumns().size();
  }
  for (  JoinPart part : join.getParts()) {
    SimpleFeatureType ft=part.getQueryFeatureType();
    JDBCFeatureReader joinReader=new JDBCFeatureReader(rs,cx,offset,featureSource.getDataStore().getAbsoluteFeatureSource(ft.getTypeName()),ft,hints){
      @Override protected void finalize() throws Throwable {
      }
    }
;
    joinReaders.add(joinReader);
    offset+=ft.getAttributeCount() + joinReader.getPrimaryKey().getColumns().size();
  }
  joinFeatureBuilder=new SimpleFeatureBuilder(retype(featureType,join));
}
