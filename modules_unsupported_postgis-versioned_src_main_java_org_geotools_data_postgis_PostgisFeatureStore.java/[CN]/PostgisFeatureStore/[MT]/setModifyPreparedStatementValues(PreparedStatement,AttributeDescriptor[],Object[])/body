{
  final int arrLength=types.length;
  if (arrLength != values.length) {
    throw new IllegalArgumentException("length of value array is not " + "same length as type array");
  }
  final PostgisDataStore dataStore=getPostgisDataStore();
  for (int i=0; i < arrLength; i++) {
    Object newValue=values[i];
    AttributeDescriptor curType=types[i];
    if (curType instanceof GeometryDescriptor) {
      newValue=geometryWriter.write((Geometry)newValue);
      statement.setObject(1 + i,newValue);
    }
 else {
      final Class target=curType.getType().getBinding();
      final int jdbcType=dataStore.getJdbcType(target).intValue();
      statement.setObject(1 + i,newValue,jdbcType);
    }
  }
}
