{
  handler=type.getShapeHandler(gf);
  writeHeaders(geometries,type);
  lp=shapeBuffer.position();
  for (int i=0, ii=geometries.getNumGeometries(); i < ii; i++) {
    Geometry g=geometries.getGeometryN(i);
    writeGeometry(g);
  }
  close();
}
