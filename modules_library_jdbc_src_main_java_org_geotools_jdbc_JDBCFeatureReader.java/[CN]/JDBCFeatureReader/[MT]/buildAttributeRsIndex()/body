{
  LinkedHashSet<String> pkColumns=dataStore.getColumnNames(pkey);
  List<String> pkColumnsList=new ArrayList<String>(pkColumns);
  int[] indexes=new int[featureType.getAttributeCount()];
  int exposedPks=0;
  for (int i=0; i < indexes.length; i++) {
    String attName=featureType.getDescriptor(i).getLocalName();
    if (pkColumns.contains(attName)) {
      indexes[i]=pkColumnsList.indexOf(attName) + 1;
      exposedPks++;
    }
 else {
      indexes[i]=i + pkColumns.size() - exposedPks + 1;
    }
  }
  return indexes;
}
