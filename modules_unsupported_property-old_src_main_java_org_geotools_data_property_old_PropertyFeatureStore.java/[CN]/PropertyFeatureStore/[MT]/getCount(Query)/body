{
  if (Filter.INCLUDE == query.getFilter() && getTransaction() == Transaction.AUTO_COMMIT) {
    File file=new File(store.directory,typeName + ".properties");
    if (!(cacheCount != -1 && file.lastModified() == cacheTimestamp)) {
      cacheCount=PropertyDataStore.countFile(file);
      cacheTimestamp=file.lastModified();
    }
    if (query.getMaxFeatures() >= 0) {
      return Math.min(cacheCount,query.getMaxFeatures());
    }
 else {
      return cacheCount;
    }
  }
  return -1;
}
