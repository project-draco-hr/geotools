{
  final List<SingleCRS> singles;
  if (crs instanceof DefaultCompoundCRS) {
    singles=((DefaultCompoundCRS)crs).getSingleCRS();
  }
 else   if (crs instanceof CompoundCRS) {
    final List<CoordinateReferenceSystem> elements=((CompoundCRS)crs).getCoordinateReferenceSystems();
    singles=new ArrayList<SingleCRS>(elements.size());
    getSingleCRS(elements,singles);
  }
 else {
    singles=Collections.singletonList((SingleCRS)crs);
  }
  return singles;
}
