{
  featureType=state.getFeatureType();
  final MemoryDataStore store=(MemoryDataStore)state.getEntry().getDataStore();
  final Map<String,SimpleFeature> features=store.features(featureType.getTypeName());
synchronized (features) {
    final Collection<SimpleFeature> featureCollection=features.values();
    final List<SimpleFeature> internalCollection=new ArrayList<SimpleFeature>();
    if (features != null) {
      internalCollection.addAll(featureCollection);
    }
    iterator=internalCollection.iterator();
  }
}
