{
  if (featureReader == null) {
    throw new IOException("Writer closed");
  }
  if (currentFeature != null) {
    write();
  }
  if (featureReader.hasNext()) {
    try {
      return currentFeature=featureReader.next();
    }
 catch (    IllegalAttributeException iae) {
      throw new DataSourceException("Error in reading",iae);
    }
  }
  try {
    String featureID=getFeatureType().getTypeName() + "." + (records + 1);
    return currentFeature=DataUtilities.template(getFeatureType(),featureID,emptyAtts);
  }
 catch (  IllegalAttributeException iae) {
    throw new DataSourceException("Error creating empty Feature",iae);
  }
}
