{
  ResultSet resultSet=null;
  try {
    String query="SELECT max(" + fidColumn + ") FROM "+ tablename;
    Statement statement=conn.createStatement();
    resultSet=statement.executeQuery(query);
    if (resultSet.next()) {
      Number number=(Number)resultSet.getObject(1);
      current=number.intValue();
    }
 else {
      throw new DataSourceException("Could not get max for " + fidColumn);
    }
  }
 catch (  SQLException e) {
    throw new DataSourceException("SQL Error occured when " + "generating unique key",e);
  }
catch (  ClassCastException e) {
    throw new DataSourceException("Error casting fid column " + "to a number",e);
  }
 finally {
    try {
      if (resultSet != null) {
        resultSet.close();
      }
    }
 catch (    SQLException e1) {
    }
  }
}
