{
  final InternationalString name=getName();
  final CoordinateReferenceSystem crs=CRS.getHorizontalCRS(this.crs);
  if (crs == null) {
    throw new CannotEvaluateException(Errors.format(ErrorKeys.CANT_SEPARATE_CRS_$1,this.crs.getName()));
  }
  final RenderedImage image=getRenderableImage(time).createDefaultRendering();
  final GridSampleDimension[] bands=new GridSampleDimension[getNumSampleDimensions()];
  for (int i=0; i < getNumSampleDimensions(); i++) {
    bands[i]=GridSampleDimension.wrap(getSampleDimension(i));
  }
  final MathTransform gridToCRS;
  gridToCRS=ProjectiveTransform.create((AffineTransform)image.getProperty("gridToCRS"));
  if (factory == null) {
    factory=CoverageFactoryFinder.getGridCoverageFactory(HINTS);
  }
  return factory.create(name,image,crs,gridToCRS,bands,null,null);
}
