{
  final RefDatabase refDatabase=repo.getRefDatabase();
  final Ref initialTypesTreeRef=refDatabase.getRef(GeoGitDataStore.TYPE_NAMES_REF_TREE);
  assertNotNull(initialTypesTreeRef);
  final SimpleFeatureType featureType=super.linesType;
  dataStore.createSchema(featureType);
  assertTypeRefs(Collections.singleton(super.linesType));
  dataStore.createSchema(super.pointsType);
  Set<SimpleFeatureType> expected=new HashSet<SimpleFeatureType>();
  expected.add(super.linesType);
  expected.add(super.pointsType);
  assertTypeRefs(expected);
  try {
    dataStore.createSchema(super.pointsType);
    fail("Expected IOException on existing type");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("already exists"));
  }
}
