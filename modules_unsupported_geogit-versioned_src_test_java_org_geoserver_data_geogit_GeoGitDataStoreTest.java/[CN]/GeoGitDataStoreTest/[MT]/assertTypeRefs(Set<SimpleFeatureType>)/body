{
  final RefDatabase refDatabase=repo.getRefDatabase();
  for (  SimpleFeatureType featureType : expectedTypes) {
    final Name typeName=featureType.getName();
    final Ref typesTreeRef=refDatabase.getRef(GeoGitDataStore.TYPE_NAMES_REF_TREE);
    assertNotNull(typesTreeRef);
    RevTree typesTree=repo.getTree(typesTreeRef.getObjectId());
    List<String> path=Arrays.asList(typeName.getNamespaceURI(),typeName.getLocalPart());
    ObjectDatabase objectDatabase=repo.getObjectDatabase();
    Ref typeRef=objectDatabase.getTreeChild(typesTree,path);
    assertNotNull(typeRef);
    assertEquals(TYPE.BLOB,typeRef.getType());
    WrappedSerialisingFactory serialisingFactory;
    serialisingFactory=WrappedSerialisingFactory.getInstance();
    SimpleFeatureType readType=objectDatabase.get(typeRef.getObjectId(),serialisingFactory.createSimpleFeatureTypeReader(featureType.getName()));
    assertEquals(featureType,readType);
  }
}
