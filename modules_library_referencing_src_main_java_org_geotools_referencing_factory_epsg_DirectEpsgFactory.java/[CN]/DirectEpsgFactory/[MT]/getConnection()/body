{
  if (connection == null) {
    connection=dataSource.getConnection();
  }
 else {
    if (connection.isClosed() || !isConnectionValid(connection)) {
      statements.clear();
      try {
        connection.close();
      }
 catch (      Exception e) {
        LOGGER.log(Level.FINER,"Error occurred while closing an invalid connection",e);
      }
      connection=dataSource.getConnection();
    }
  }
  return connection;
}
