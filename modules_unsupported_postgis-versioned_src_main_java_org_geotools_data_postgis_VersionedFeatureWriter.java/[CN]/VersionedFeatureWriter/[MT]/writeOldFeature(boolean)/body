{
  try {
    if (expire)     oldFeature.setAttribute("expired",new Long(state.getRevision()));
    updateWriter.write();
  }
 catch (  IllegalAttributeException e) {
    throw new DataSourceException("Error writing expiration tag on old feature. " + "Should not happen, there's a bug at work.",e);
  }
catch (  FeatureLockException fle) {
    String unversionedFid=mapper.getUnversionedFid(fle.getFeatureID());
    FeatureLockException mangled=new FeatureLockException(fle.getMessage(),unversionedFid,fle.getCause());
    throw mangled;
  }
}
