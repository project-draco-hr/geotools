{
  ByteArrayInputStream bis=new ByteArrayInputStream(data);
  Object source=bis;
  ImageInputStream iis=ImageIO.createImageInputStream(source);
  Iterator<?> readers=ImageIO.getImageReaders(iis);
  ImageReader reader=(ImageReader)readers.next();
  reader.setInput(iis,true);
  ImageReadParam param=reader.getDefaultReadParam();
  return reader.read(0,param);
}
