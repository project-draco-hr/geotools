{
  double scale=XAffineTransform.getScale(worldToScreen);
  if (crs instanceof GeographicCRS) {
    return (OGC_DEGREE_TO_METERS * getDpi(hints)) / (scale * 0.0254);
  }
 else {
    return (getDpi(hints)) / (scale * 0.0254);
  }
}
