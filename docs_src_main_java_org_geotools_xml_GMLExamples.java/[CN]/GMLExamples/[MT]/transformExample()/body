{
  SimpleFeatureType TYPE=DataUtilities.createType("urn:org.geotools.xml.examples","location","geom:Point,name:String");
  TYPE.getUserData().put("prefix","ex");
  WKTReader2 wkt=new WKTReader2();
  List<SimpleFeature> collection=new LinkedList<SimpleFeature>();
  collection.add(SimpleFeatureBuilder.build(TYPE,new Object[]{wkt.read("POINT (1 2)"),"name1"},null));
  collection.add(SimpleFeatureBuilder.build(TYPE,new Object[]{wkt.read("POINT (4 4)"),"name2"},null));
  SimpleFeatureCollection featureCollection=new ListFeatureCollection(TYPE,collection);
  FeatureTransformer transform=new FeatureTransformer();
  transform.setEncoding(Charset.defaultCharset());
  transform.setIndentation(4);
  transform.setGmlPrefixing(true);
  final SimpleFeatureType schema=featureCollection.getSchema();
  String prefix=(String)schema.getUserData().get("prefix");
  String namespace=schema.getName().getNamespaceURI();
  transform.getFeatureTypeNamespaces().declareDefaultNamespace(prefix,namespace);
  transform.addSchemaLocation(prefix,namespace);
  String srsName=CRS.toSRS(schema.getCoordinateReferenceSystem());
  if (srsName != null) {
    transform.setSrsName(srsName);
  }
  transform.setCollectionPrefix("col");
  transform.setCollectionNamespace("urn:org.geotools.xml.example.collection");
  transform.setCollectionBounding(true);
  ByteArrayOutputStream xml=new ByteArrayOutputStream();
  transform.transform(featureCollection,xml);
  xml.close();
  System.out.println(xml.toString());
}
