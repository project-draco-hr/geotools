{
  KVP params;
  DataStore ds;
  URL remoteUrl=TestData.url(STATE_POP);
  File f=copyShapefiles(STATE_POP);
  URL localUrl=f.toURI().toURL();
  params=new KVP(URLP.key,remoteUrl,ENABLE_SPATIAL_INDEX.key,true);
  ds=factory.createDataStore(params);
  assertNotNull("Null datastore should not be returned",ds);
  assertTrue("should be a non indexed shapefile",ds instanceof org.geotools.data.shapefile.ShapefileDataStore);
  ds.dispose();
  params=new KVP(URLP.key,localUrl);
  ds=factory.createDataStore(params);
  assertNotNull("Null datastore should not be returned",ds);
  assertTrue("should be a indexed shapefile",ds instanceof org.geotools.data.shapefile.indexed.IndexedShapefileDataStore);
  ds.dispose();
  params=new KVP(URLP.key,localUrl,ENABLE_SPATIAL_INDEX.key,false);
  ds=factory.createDataStore(params);
  assertNotNull("Null datastore should not be returned",ds);
  assertTrue("should be a non indexed shapefile",ds instanceof org.geotools.data.shapefile.ShapefileDataStore);
  ds.dispose();
  params=new KVP(URLP.key,localUrl,ENABLE_SPATIAL_INDEX.key,true);
  ds=factory.createDataStore(params);
  assertNotNull("Null datastore should not be returned",ds);
  assertTrue("should be a indexed shapefile",ds instanceof org.geotools.data.shapefile.indexed.IndexedShapefileDataStore);
  ds.dispose();
}
