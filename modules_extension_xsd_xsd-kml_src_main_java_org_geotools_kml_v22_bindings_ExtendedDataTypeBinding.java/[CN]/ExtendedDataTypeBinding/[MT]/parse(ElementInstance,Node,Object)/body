{
  Map<String,Object> extendedData=new HashMap<String,Object>();
  Map<String,Object> unTypedData=new LinkedHashMap<String,Object>();
  for (  Node n : (List<Node>)node.getChildren("Data")) {
    unTypedData.put((String)n.getAttributeValue("name"),n.getChildValue("value"));
  }
  Map<String,Object> typedData=new LinkedHashMap<String,Object>();
  List<URI> schemas=new ArrayList<URI>();
  for (  Node schemaData : (List<Node>)node.getChildren("SchemaData")) {
    URI schemaUrl=(URI)schemaData.getAttributeValue("schemaUrl");
    if (schemaUrl != null) {
      for (      Node n : (List<Node>)schemaData.getChildren("SimpleData")) {
        typedData.put((String)n.getAttributeValue("name"),n.getValue());
      }
      schemas.add(schemaUrl);
    }
  }
  for (  Node freeExtendedData : (List<Node>)node.getChildren("Data")) {
    for (    Node n : (List<Node>)freeExtendedData.getChildren("Data")) {
      Node v=n.getChild("value");
      if (v != null)       typedData.put((String)n.getAttributeValue("name"),v.getValue());
    }
  }
  extendedData.put("schemas",schemas);
  extendedData.put("untyped",unTypedData);
  extendedData.put("typed",typedData);
  return extendedData;
}
