{
  try {
    if (!(statement instanceof PGStatement)) {
      UnWrapper uw=DataSourceFinder.getUnWrapper(statement);
      if (uw != null)       statement=uw.unwrap(statement);
    }
    PGStatement pgStatement=(PGStatement)statement;
    return String.valueOf(pgStatement.getLastOID());
  }
 catch (  SQLException e) {
    throw new DataSourceException("Problems occurred while getting last generate oid from Postgresql statement",e);
  }
catch (  ClassCastException e) {
    throw new DataSourceException("Statement is not a PGStatement. OIDFidMapper can be used only with Postgres!",e);
  }
}
