{
  while (it.hasNext()) {
    TreeAttributeMapping attMapping=it.next();
    final Expression sourceExpression=attMapping.getIdentifierExpression();
    List<Pair> ls=elements.get(attMapping.getParentLabel());
    if (ls != null) {
      for (int i=0; i < ls.size(); i++) {
        Pair parentAttribute=ls.get(i);
        String instancePath=attMapping.getInstanceXpath();
        int count=1;
        String countXpath=null;
        if (instancePath != null) {
          countXpath=parentAttribute.getXpath() + XPATH_SEPARATOR + attMapping.getInstanceXpath();
        }
        for (int j=0; j < count; j++) {
          final String bracketIndex="";
          String xpath=null;
          if (instancePath == null) {
            xpath=parentAttribute.getXpath() + XPATH_SEPARATOR + sourceExpression.toString();
          }
 else {
            xpath=parentAttribute.getXpath() + XPATH_SEPARATOR + attMapping.getInstanceXpath()+ bracketIndex+ XPATH_SEPARATOR+ sourceExpression.toString();
          }
          String label=getFullQueryPath(attMapping,attMapping.getTargetQueryString());
          String idSuffix=XPATH_PROPERTY_SEPARATOR + "gml:id";
          mapping.put(label + idSuffix,xpath);
          StepList sl=attMapping.getTargetXPath();
          setPathIndex(j,sl);
          Attribute subFeature=null;
          elements.put(attMapping.getLabel(),countXpath + bracketIndex,subFeature);
        }
      }
    }
  }
}
