{
  HttpURLConnection connection=(HttpURLConnection)finalURL.openConnection();
  if (tryGzip) {
    connection.addRequestProperty("Accept-Encoding","gzip");
  }
  if (getConnectTimeout() > 0) {
    connection.setConnectTimeout(1000 * getConnectTimeout());
  }
  if (getReadTimeout() > 0) {
    connection.setReadTimeout(1000 * getReadTimeout());
  }
  final String username=getUser();
  final String password=getPassword();
  if (username != null && password != null) {
    String userpassword=username + ":" + password;
    String encodedAuthorization=Base64.encodeBytes(userpassword.getBytes("UTF-8"));
    connection.setRequestProperty("Authorization","Basic " + encodedAuthorization);
  }
  return connection;
}
