{
  SimpleFeatureCollection fc=null;
  fc=(SimpleFeatureCollection)node.getChildValue(FeatureCollection.class);
  if (fc == null) {
    fc=new DefaultFeatureCollection(null,null);
  }
  SimpleFeature[] featureMembers=(SimpleFeature[])node.getChildValue(SimpleFeature[].class);
  if (featureMembers != null) {
    if (fc instanceof Collection) {
      for (int i=0; i < featureMembers.length; i++) {
        ((Collection)fc).add(featureMembers[i]);
      }
    }
 else {
      throw new IllegalStateException("Require DefaultFeatureCollection or ListFeatureCollection");
    }
  }
 else {
    if (fc instanceof Collection) {
      List<SimpleFeature> featureMember=node.getChildValues(SimpleFeature.class);
      for (      SimpleFeature f : featureMember) {
        ((Collection)fc).add(f);
      }
    }
 else {
      throw new IllegalStateException("Require DefaultFeatureCollection or ListFeatureCollection");
    }
  }
  if (!fc.isEmpty()) {
    if (EMFUtils.has(fct,"feature")) {
      EMFUtils.add(fct,"feature",fc);
    }
 else {
      EMFUtils.add(fct,"member",fc);
    }
  }
  return fct;
}
