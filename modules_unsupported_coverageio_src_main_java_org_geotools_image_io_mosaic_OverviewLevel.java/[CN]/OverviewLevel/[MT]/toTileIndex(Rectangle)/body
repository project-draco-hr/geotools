{
  final Rectangle index=new Rectangle(dx * xSubsampling,dy * ySubsampling);
  int x=search.x - mosaic.x * xSubsampling;
  int y=search.y - mosaic.y * ySubsampling;
  if (x >= 0)   index.x=x / index.width;
  if (y >= 0)   index.y=y / index.height;
  x+=search.width;
  y+=search.height;
  index.width=Math.min(nx,(x + (index.width - 1)) / index.width) - index.x;
  index.height=Math.min(ny,(y + (index.height - 1)) / index.height) - index.y;
  return index;
}
