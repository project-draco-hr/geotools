{
  Map<String,String> result=new HashMap<String,String>();
  Set<String> usedFieldNames=new HashSet<String>();
  usedFieldNames.add("the_geom");
  for (  AttributeDescriptor attDesc : schema.getAttributeDescriptors()) {
    if (attDesc instanceof GeometryDescriptor) {
      result.put(attDesc.getLocalName(),"the_geom");
    }
 else {
      String name=attDesc.getLocalName();
      result.put(attDesc.getLocalName(),getShapeCompatibleName(usedFieldNames,name));
    }
  }
  return result;
}
