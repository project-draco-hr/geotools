{
  this.listener=parentListener;
  fButton=new Button(parent,SWT.PUSH);
  fExtent=computeImageSize(parent);
  fImage=new Image(parent.getDisplay(),fExtent.x,fExtent.y);
  GC gc=new GC(fImage);
  gc.setBackground(fButton.getBackground());
  gc.fillRectangle(0,0,fExtent.x,fExtent.y);
  gc.dispose();
  fButton.setImage(fImage);
  fButton.addSelectionListener(new SelectionAdapter(){
    public void widgetSelected(    SelectionEvent event){
      ColorDialog colorDialog=new ColorDialog(fButton.getShell());
      colorDialog.setRGB(fColorValue);
      RGB newColor=colorDialog.open();
      if (newColor != null) {
        fColorValue=newColor;
        updateColorImage();
      }
      notifyParent(event);
    }
  }
);
  fButton.addDisposeListener(new DisposeListener(){
    public void widgetDisposed(    DisposeEvent event){
      if (fImage != null) {
        fImage.dispose();
        fImage=null;
      }
      if (fColor != null) {
        fColor.dispose();
        fColor=null;
      }
    }
  }
);
}
