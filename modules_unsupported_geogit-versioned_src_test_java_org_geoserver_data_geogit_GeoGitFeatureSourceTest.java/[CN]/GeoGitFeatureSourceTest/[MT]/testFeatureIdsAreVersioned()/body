{
  SimpleFeatureCollection collection=pointsSource.getFeatures(Query.ALL);
  SimpleFeatureIterator features=collection.features();
  Set<FeatureId> ids=new HashSet<FeatureId>();
  while (features.hasNext()) {
    SimpleFeature next=features.next();
    FeatureId identifier=next.getIdentifier();
    ids.add(identifier);
  }
  Ref typeTreeRef=repo.getRootTreeChild(pointsNs,pointsName);
  RevTree tree=repo.getTree(typeTreeRef.getObjectId());
  List<Ref> refs=toList(tree.iterator(null));
  assertEquals(3,refs.size());
  Map<String,Ref> expected=new HashMap<String,Ref>();
  for (  Ref ref : refs) {
    expected.put(ref.getName(),ref);
  }
  for (  FeatureId id : ids) {
    assertFalse(id instanceof ResourceId);
    assertNotNull(id.getID());
    assertNotNull(id + " has no featureVersion set",id.getFeatureVersion());
    Ref ref=expected.get(id.getID());
    assertNotNull(ref);
    assertEquals(ref.getObjectId().toString(),id.getFeatureVersion());
  }
}
