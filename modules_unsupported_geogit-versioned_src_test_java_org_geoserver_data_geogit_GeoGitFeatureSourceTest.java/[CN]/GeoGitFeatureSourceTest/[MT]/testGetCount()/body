{
  assertEquals(3,pointsSource.getCount(Query.ALL));
  assertEquals(3,linesSource.getCount(Query.ALL));
  ReferencedEnvelope bounds;
  Filter filter;
  filter=ff.id(Collections.singleton(ff.featureId(RepositoryTestCase.idP2)));
  assertEquals(1,pointsSource.getCount(new Query(pointsName,filter)));
  ReferencedEnvelope queryBounds=boundsOf(points1,points2);
  Polygon geometry=JTS.toGeometry(queryBounds);
  filter=ff.intersects(ff.property(pointsType.getGeometryDescriptor().getLocalName()),ff.literal(geometry));
  assertEquals(2,pointsSource.getCount(new Query(pointsName,filter)));
  ReferencedEnvelope transformedQueryBounds;
  CoordinateReferenceSystem queryCrs=CRS.decode("EPSG:3857");
  transformedQueryBounds=queryBounds.transform(queryCrs,true);
  geometry=JTS.toGeometry(transformedQueryBounds);
  geometry.setUserData(queryCrs);
  filter=ff.intersects(ff.property(pointsType.getGeometryDescriptor().getLocalName()),ff.literal(geometry));
  assertEquals(2,pointsSource.getCount(new Query(pointsName,filter)));
  filter=ECQL.toFilter("sp = 'StringProp2_3' OR ip = 2000");
  bounds=linesSource.getBounds(new Query(linesName,filter));
  assertEquals(2,linesSource.getCount(new Query(linesName,filter)));
}
