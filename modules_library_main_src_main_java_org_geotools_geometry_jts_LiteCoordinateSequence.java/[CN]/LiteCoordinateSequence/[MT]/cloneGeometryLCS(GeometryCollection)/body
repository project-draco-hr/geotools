{
  if (geom.getNumGeometries() == 0) {
    Geometry[] gs=new Geometry[0];
    return geomFac.createGeometryCollection(gs);
  }
  ArrayList gs=new ArrayList(geom.getNumGeometries());
  int n=geom.getNumGeometries();
  Class geomType=geom.getGeometryN(0).getClass();
  for (int t=0; t < n; t++) {
    Geometry clone=cloneGeometry(geom.getGeometryN(t));
    if (clone.getClass() != geomType) {
      geomType=null;
    }
    gs.add(t,clone);
  }
  if (geomType == Point.class) {
    return geomFac.createMultiPoint((Point[])gs.toArray(new Point[gs.size()]));
  }
 else   if (geomType == LineString.class) {
    return geomFac.createMultiLineString((LineString[])gs.toArray(new LineString[gs.size()]));
  }
 else   if (geomType == Polygon.class) {
    return geomFac.createMultiPolygon((Polygon[])gs.toArray(new Polygon[gs.size()]));
  }
 else {
    return geomFac.buildGeometry(gs);
  }
}
