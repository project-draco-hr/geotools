{
  final ImageGeometry geometry=metadata.getGeometry();
  final ImageReferencing referencing=metadata.getReferencing();
  if (key.equals(UNIT) && value instanceof String) {
    unit=(String)value;
    return;
  }
  if (key.equals(X_MINIMUM)) {
    xmin=(value instanceof Double) ? (Double)value : Double.parseDouble((String)value);
    return;
  }
  if (key.equals(Y_MINIMUM)) {
    ymin=(value instanceof Double) ? (Double)value : Double.parseDouble((String)value);
    return;
  }
  if (key.equals(Z_MINIMUM)) {
    zmin=(value instanceof Double) ? (Double)value : Double.parseDouble((String)value);
    return;
  }
  if (key.equals(X_MAXIMUM)) {
    xmax=(value instanceof Double) ? (Double)value : Double.parseDouble((String)value);
    return;
  }
  if (key.equals(Y_MAXIMUM)) {
    ymax=(value instanceof Double) ? (Double)value : Double.parseDouble((String)value);
    return;
  }
  if (key.equals(Z_MAXIMUM)) {
    zmax=(value instanceof Double) ? (Double)value : Double.parseDouble((String)value);
    return;
  }
  if (key.equals(WIDTH)) {
    geometry.setGridRange(0,0,Integer.parseInt((String)value));
    return;
  }
  if (key.equals(HEIGHT)) {
    geometry.setGridRange(1,0,Integer.parseInt((String)value));
    return;
  }
  if (key.equals(DEPTH)) {
    geometry.setGridRange(2,0,Integer.parseInt((String)value));
    return;
  }
  if (key.equals(X_RESOLUTION)) {
    xres=(value instanceof Double) ? (Double)value : Double.parseDouble((String)value);
    return;
  }
  if (key.equals(Y_RESOLUTION)) {
    yres=(value instanceof Double) ? (Double)value : Double.parseDouble((String)value);
    return;
  }
  if (key.equals(Z_RESOLUTION)) {
    zres=(value instanceof Double) ? (Double)value : Double.parseDouble((String)value);
    return;
  }
  if (key.equals(X_DIRECTION) && value instanceof String) {
    xdir=(String)value;
    return;
  }
  if (key.equals(Y_DIRECTION) && value instanceof String) {
    ydir=(String)value;
    return;
  }
  if (key.equals(Z_DIRECTION) && value instanceof String) {
    zdir=(String)value;
    return;
  }
  if (key.equals(PROJECTION) && value instanceof String) {
    referencing.setProjectionName((String)value);
    return;
  }
  if (key.equals(DATUM) && value instanceof String) {
    referencing.setDatum((String)value,null);
    return;
  }
  if (key.equals(PRIME_MERIDIAN) && value instanceof String) {
    referencing.setPrimeMeridianName((String)value);
    return;
  }
  if (key.equals(GREENWICH_LONGITUDE)) {
    referencing.setPrimeMeridianGreenwichLongitude((value instanceof Double) ? (Double)value : Double.parseDouble((String)value));
    return;
  }
  if (key.equals(ELLIPSOID) && value instanceof String) {
    referencing.setEllipsoidName((String)value);
    return;
  }
  if (key.equals(ELLIPSOID_UNIT) && value instanceof String) {
    referencing.setEllipsoidUnit((String)value);
    return;
  }
  if (key.equals(SEMI_MAJOR)) {
    if (value instanceof Double) {
      referencing.setSemiMajorAxis((Double)value);
    }
 else {
      referencing.setSemiMajorAxis(Double.parseDouble((String)value));
    }
    return;
  }
  if (key.equals(SEMI_MINOR)) {
    if (value instanceof Double) {
      referencing.setSemiMinorAxis((Double)value);
    }
 else {
      referencing.setSemiMinorAxis(Double.parseDouble((String)value));
    }
    return;
  }
  if (key.equals(INVERSE_FLATTENING)) {
    if (value instanceof Double) {
      referencing.setInverseFlattening((Double)value);
    }
 else {
      referencing.setInverseFlattening(Double.parseDouble((String)value));
    }
    return;
  }
  if (key.equals(COORDINATE_REFERENCE_SYSTEM_TYPE) && value instanceof String) {
    crs_type=(String)value;
    return;
  }
  if (key.equals(COORDINATE_REFERENCE_SYSTEM) && value instanceof String) {
    crs_name=(String)value;
    return;
  }
  if (key.equals(COORDINATE_SYSTEM_TYPE) && value instanceof String) {
    cs_type=(String)value;
    return;
  }
  if (key.equals(COORDINATE_SYSTEM) && value instanceof String) {
    cs_name=(String)value;
    return;
  }
  if (key.equals(CENTRAL_MERIDIAN) || key.equals(FALSE_EASTING) || key.equals(FALSE_NORTHING)|| key.equals(LATITUDE_OF_ORIGIN)) {
    if (value instanceof Double) {
      referencing.addParameter(key.toString(),(Double)value);
    }
 else {
      referencing.addParameter(key.toString(),Double.parseDouble((String)value));
    }
    return;
  }
}
