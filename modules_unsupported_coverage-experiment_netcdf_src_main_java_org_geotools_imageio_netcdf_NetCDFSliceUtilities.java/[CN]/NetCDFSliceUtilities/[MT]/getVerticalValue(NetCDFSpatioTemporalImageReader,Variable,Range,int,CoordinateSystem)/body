{
  double ve=Double.NaN;
  if (cs != null && cs.hasVerticalAxis()) {
    final int zIndex=NetCDFUtilities.getZIndex(variable,range,imageIndex);
    final int rank=variable.getRank();
    final Dimension verticalDimension=variable.getDimension(rank - NetCDFUtilities.Z_DIMENSION);
    final Variable axis=geoNetCDFReader.getCoordinate(verticalDimension.getName());
    if ((axis != null) && axis.isCoordinateVariable()) {
      final AxisType type=((CoordinateAxis)axis).getAxisType();
      if (!AxisType.GeoZ.equals(type) && !AxisType.Pressure.equals(type) && !AxisType.Height.equals(type))       return ve;
      if (((CoordinateAxis)axis).isNumeric() && axis instanceof CoordinateAxis1D) {
        final CoordinateAxis1D axis1D=(CoordinateAxis1D)axis;
        final double[] values=axis1D.getCoordValues();
        if (values != null && values.length > zIndex) {
          ve=values[zIndex];
        }
      }
    }
  }
  return ve;
}
