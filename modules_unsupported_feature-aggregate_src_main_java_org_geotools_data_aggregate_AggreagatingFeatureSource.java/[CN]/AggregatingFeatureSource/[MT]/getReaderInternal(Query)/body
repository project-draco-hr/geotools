{
  try {
    Query psQuery=new Query(query);
    Name psName=config.getPrimarySourceType().getStoreName();
    psQuery.setTypeName(config.getPrimarySourceType().getTypeName());
    DataStore ps=getStore().getStore(psName,false);
    SimpleFeatureType target=DataUtilities.createView(ps,psQuery).getSchema();
    target=retypeNameSchema(target);
    FeatureQueue queue=new FeatureQueue(config.getSourceTypes().size());
    AggregatingDataStore store=getStore();
    for (    SourceType st : config.getSourceTypes()) {
      FeatureCallable fc=new FeatureCallable(store,query,st.getStoreName(),st.getTypeName(),queue,target);
      queue.addSource(fc);
      store.submit(fc);
    }
    SimpleFeatureReader reader=new QueueReader(queue,target);
    return reader;
  }
 catch (  SchemaException e) {
    throw new IOException("Failed to compute target feature type",e);
  }
}
