{
  List<PrimaryKeyColumn> columns=new ArrayList<PrimaryKeyColumn>();
  ResultSet md=cx.getMetaData().getPrimaryKeys(null,schema,table);
  boolean next=md.next();
  if (next) {
    Statement stmt=cx.createStatement();
    try {
      TableMetadata tableMetadata=new TableMetadata(stmt,schema,table);
      while (next) {
        String columnName=md.getString("COLUMN_NAME").trim();
        int ordinal=tableMetadata.ordinal(columnName);
        if (ordinal >= 0) {
          Class<?> columnClass=tableMetadata.columnClass(ordinal);
          if (tableMetadata.isAutoIncrement(ordinal)) {
            columns.add(new AutoGeneratedPrimaryKeyColumn(columnName,columnClass));
          }
 else {
            columns.add(new NonIncrementingPrimaryKeyColumn(columnName,columnClass));
          }
        }
        next=md.next();
      }
    }
 catch (    SQLException e) {
    }
 finally {
      stmt.close();
    }
  }
  return columns;
}
