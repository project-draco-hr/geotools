{
  List<PrimaryKeyColumn> columns=new ArrayList<PrimaryKeyColumn>();
  StringBuilder sql=new StringBuilder("select ColumnName,ColumnPosition from dbc.indices WHERE ");
  if (schema != null) {
    sql.append("DatabaseName = '").append(schema).append("' AND ");
  }
  sql.append("TableName = '").append(table).append("' AND UniqueFlag = 'Y'");
  Statement st=cx.createStatement();
  java.sql.ResultSet result=st.executeQuery(sql.toString());
  boolean next=result.next();
  try {
    TableMetadata tableMetadata=new TableMetadata(st,schema,table);
    while (next) {
      int ordinal=Integer.parseInt(result.getString("ColumnPosition").trim());
      String columnName=result.getString("ColumnName").trim();
      Class<?> columnClass=tableMetadata.columnClass(ordinal);
      if (tableMetadata.isAutoIncrement(ordinal)) {
        columns.add(new AutoGeneratedPrimaryKeyColumn(columnName,columnClass));
      }
 else {
        columns.add(new NonIncrementingPrimaryKeyColumn(columnName,columnClass));
      }
      next=result.next();
    }
  }
 catch (  SQLException e) {
  }
 finally {
    st.close();
  }
  return columns;
}
