{
  DataStore csv=this.getDataStore();
  SimpleFeatureSource rows=csv.getFeatureSource(TYPE_NAME);
  FilterFactory ff=CommonFactoryFinder.getFilterFactory(null);
  SimpleFeatureCollection matches=rows.getFeatures(ff.less(ff.property("NUMBER"),ff.literal(200)));
  List<String> filteredCities=Arrays.asList("Trento","St Paul","Bangkok");
  int count=0;
  SimpleFeatureIterator iter=matches.features();
  while (iter.hasNext()) {
    SimpleFeature f=iter.next();
    filteredCities.contains(f.getAttribute("CITY"));
    count++;
  }
  iter.close();
  assertEquals(3,count);
  assertEquals(3,matches.size());
}
