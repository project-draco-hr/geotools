{
  ReferencedEnvelope env=new ReferencedEnvelope(query.getCoordinateSystem());
  FeatureReader<SimpleFeatureType,SimpleFeature> reader=getReaderInternal(query);
  if (reader != null) {
    while (reader.hasNext()) {
      Geometry geometry=(Geometry)reader.next().getDefaultGeometry();
      env.expandToInclude(geometry.getEnvelopeInternal());
    }
  }
  return env;
}
