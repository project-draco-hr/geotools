{
  int dims=2;
  for (int t=cs.length - 1; t >= 0; t--) {
    if (!(Double.isNaN(cs[t].z))) {
      dims=4;
      break;
    }
  }
  return dims;
}
