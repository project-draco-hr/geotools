{
  if (collection == null) {
    throw new NullPointerException("No content provided");
  }
  if (collection instanceof ListFeatureCollection) {
    ListFeatureCollection list=(ListFeatureCollection)collection;
    CollectionFeatureSource source=new CollectionFeatureSource(list);
    return source;
  }
  if (collection instanceof SpatialIndexFeatureCollection) {
    SpatialIndexFeatureCollection indexed=(SpatialIndexFeatureCollection)collection;
    SpatialIndexFeatureSource source=new SpatialIndexFeatureSource(indexed);
    return source;
  }
  if (collection instanceof TreeSetFeatureCollection) {
    TreeSetFeatureCollection tree=(TreeSetFeatureCollection)collection;
    CollectionFeatureSource source=new CollectionFeatureSource(tree);
    return source;
  }
  CollectionDataStore store=new CollectionDataStore(collection);
  try {
    return store.getFeatureSource(store.getTypeNames()[0]);
  }
 catch (  IOException e) {
    throw new RuntimeException("Something is wrong with the geotools code, " + "this exception should not happen",e);
  }
}
