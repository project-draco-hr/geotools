{
  StyleFactory factory=CommonFactoryFinder.getStyleFactory();
  RasterSymbolizer r=factory.createRasterSymbolizer();
  ChannelSelection sel=factory.channelSelection(factory.createSelectedChannelType("foo",factory.createContrastEnhancement()),factory.createSelectedChannelType("bar",factory.createContrastEnhancement()),factory.createSelectedChannelType("baz",factory.createContrastEnhancement()));
  r.setChannelSelection(sel);
  StringWriter out=new StringWriter();
  Ysld.encode(sld(r),out);
  YamlMap obj=new YamlMap(new Yaml().load(out.toString()));
  YamlMap channelMap=obj.seq("feature-styles").map(0).seq("rules").map(0).seq("symbolizers").map(0).map("raster").map("channels");
  assertFalse(channelMap.has("gray"));
  assertTrue(channelMap.has("red"));
  assertTrue(channelMap.has("green"));
  assertTrue(channelMap.has("blue"));
  assertThat(channelMap.map("red").str("name"),equalTo("foo"));
  assertFalse(channelMap.map("red").has("contrast-enhancement"));
  assertThat(channelMap.map("green").str("name"),equalTo("bar"));
  assertFalse(channelMap.map("green").has("contrast-enhancement"));
  assertThat(channelMap.map("blue").str("name"),equalTo("baz"));
  assertFalse(channelMap.map("blue").has("contrast-enhancement"));
}
