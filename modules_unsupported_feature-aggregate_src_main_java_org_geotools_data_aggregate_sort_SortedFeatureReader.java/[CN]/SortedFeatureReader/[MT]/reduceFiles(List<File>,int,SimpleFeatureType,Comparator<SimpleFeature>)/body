{
  while (files.size() > maxFiles) {
    List<File> currFiles=new ArrayList<File>(files.subList(0,maxFiles));
    SimpleFeatureReader reader=new MergeSortReader(schema,currFiles,comparator);
    File file=storeToFile(reader);
    files.removeAll(currFiles);
    files.add(file);
  }
}
