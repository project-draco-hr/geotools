{
  if (g != null) {
    if (g instanceof LinearRing) {
      g=g.getFactory().createLineString(((LinearRing)g).getCoordinateSequence());
    }
    String wkt=new WKTWriter().write(g);
    if (wkt.length() > 64000) {
      ByteArrayInputStream bin=new ByteArrayInputStream(wkt.getBytes());
      ps.setAsciiStream(column,bin,bin.available());
    }
 else {
      ps.setString(column,wkt);
    }
  }
 else {
    ps.setNull(column,Types.OTHER,"Geometry");
  }
}
