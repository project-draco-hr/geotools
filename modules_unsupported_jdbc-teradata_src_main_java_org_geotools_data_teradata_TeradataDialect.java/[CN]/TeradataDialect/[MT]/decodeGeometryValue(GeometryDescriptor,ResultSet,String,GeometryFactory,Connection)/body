{
  try {
    byte[] wkb=rs.getBytes(column + "_inline");
    if (wkb != null) {
      return new WKBReader(factory).read(wkb);
    }
    Clob clob=rs.getClob(column);
    InputStream in=clob.getAsciiStream();
    try {
      return new WKTReader(factory).read(new InputStreamReader(in));
    }
  finally {
      if (in != null)       in.close();
    }
  }
 catch (  ParseException e) {
    throw (IOException)new IOException("Error parsing geometry").initCause(e);
  }
}
