{
  String xPathTemp=xPath.toString();
  final int NOT_FOUND=-1;
  final String RELATIVE_PATH="/../";
  int i=xPathTemp.indexOf(RELATIVE_PATH);
  while (i != NOT_FOUND) {
    int slashPos=xPathTemp.lastIndexOf(XPATH_SEPARATOR,i - 1);
    if (slashPos != NOT_FOUND) {
      String left=xPathTemp.substring(0,slashPos + 1);
      String right=xPathTemp.substring(i + RELATIVE_PATH.length());
      xPathTemp=left + right;
    }
 else {
      break;
    }
    i=xPathTemp.indexOf(RELATIVE_PATH);
  }
  return ff.property(xPathTemp);
}
