{
  if (offset != null) {
    List<SortBy> sortAtts=new ArrayList<SortBy>();
    if (sortBy != null) {
      sortAtts.addAll(Arrays.asList(sortBy));
    }
    if (!(sortAtts.contains(SortBy.NATURAL_ORDER) || sortAtts.contains(SortBy.REVERSE_ORDER))) {
      sortAtts.add(SortBy.NATURAL_ORDER);
    }
    sortBy=sortAtts.toArray(new SortBy[sortAtts.size()]);
  }
  final String selectStatement=super.buildSQLQuery(typeName,mapper,attrTypes,filter,sortBy,offset,limit);
  StringBuilder sb=new StringBuilder(selectStatement);
  if (offset != null) {
    sb.append(" OFFSET ").append(offset);
  }
  if (limit != null) {
    sb.append(" LIMIT ").append(limit);
  }
  return sb.toString();
}
