{
  Color color=null;
  Matcher m=HEX_PATTERN.matcher(value);
  if (m.matches()) {
    color=parseAsHex(m,event);
  }
  if (color == null) {
    m=RGB_PATTERN.matcher(value);
    if (m.matches()) {
      color=parseAsRGB(m,event);
    }
  }
  color(color != null ? factory.filter.literal(color) : ExpressionHandler.parse(value,event,factory));
}
