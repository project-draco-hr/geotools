{
  Transaction trans=null;
  assertNull(sample1b);
  try {
    SimpleFeatureStore store=(SimpleFeatureStore)versioned.getFeatureSource(sampleName);
    trans=new DefaultTransaction("DecoratedTestCase.updateSampleFeatures()");
    store.setTransaction(trans);
    FilterFactory2 ff=new FilterFactoryImpl();
    Filter filter=ff.id(ff.featureId(idS1));
    store.modifyFeatures("st",newString1,filter);
    filter=ff.id(ff.featureId(idS2),ff.featureId(idS3));
    store.modifyFeatures(new String[]{"st","it"},new Object[]{newString2,newInt},filter);
    trans.commit();
    SimpleFeatureBuilder fb=new SimpleFeatureBuilder(sampleType);
    sample1b=fb.copy(sample1);
    sample1b.setAttribute("st",newString1);
    sample2b=fb.copy(sample2);
    sample2b.setAttribute("st",newString2);
    sample2b.setAttribute("it",newInt);
    sample3b=fb.copy(sample3);
    sample3b.setAttribute("st",newString2);
    sample3b.setAttribute("it",newInt);
  }
 catch (  Exception ex) {
    if (trans != null)     trans.rollback();
    throw ex;
  }
 finally {
    if (trans != null)     trans.close();
  }
}
