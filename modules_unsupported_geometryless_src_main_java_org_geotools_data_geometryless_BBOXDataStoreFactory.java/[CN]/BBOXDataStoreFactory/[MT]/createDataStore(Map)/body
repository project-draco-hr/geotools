{
  if (canProcess(params)) {
  }
 else {
    throw new IOException("The parameteres map isn't correct!!");
  }
  String user=(String)USER.lookUp(params);
  String passwd=(String)PASSWD.lookUp(params);
  String schema=(String)SCHEMA.lookUp(params);
  Charset charSet=(Charset)CHARSET.lookUp(params);
  String namespace=(String)NAMESPACE.lookUp(params);
  String driver=(String)DRIVER.lookUp(params);
  String urlprefix=(String)URLPREFIX.lookUp(params);
  String minxcolumn=(String)MINXCOLUMN.lookUp(params);
  String minycolumn=(String)MINYCOLUMN.lookUp(params);
  String maxxcolumn=(String)MAXXCOLUMN.lookUp(params);
  String maxycolumn=(String)MAXYCOLUMN.lookUp(params);
  String geom_name=(String)GEOMNAME.lookUp(params);
  if (!canProcess(params)) {
    return null;
  }
  DataSource dataSource=DataSourceUtil.buildDefaultDataSource(urlprefix,driver,user,passwd,null);
  if (geom_name == null) {
    geom_name=GEOM_NAME_DEFAULT;
  }
  if (namespace != null) {
    return new BBOXDataStore(dataSource,schema,namespace,minxcolumn,minycolumn,maxxcolumn,maxycolumn,geom_name);
  }
 else {
    return new BBOXDataStore(dataSource);
  }
}
