{
  if (initialized)   return;
  try {
    createShapeFilePyramd();
    REPOSITORY=new DefaultRepository();
    POINTMAP=new HashMap<Double,Map<String,Integer>>();
    POINTMAP.put(0.0,new HashMap<String,Integer>());
    POINTMAP.put(5.0,new HashMap<String,Integer>());
    POINTMAP.put(10.0,new HashMap<String,Integer>());
    POINTMAP.put(20.0,new HashMap<String,Integer>());
    POINTMAP.put(50.0,new HashMap<String,Integer>());
    URL url=TestData.url("shapes/streams.shp");
    ShapefileDataStore ds=(ShapefileDataStore)new ShapefileDataStoreFactory().createDataStore(url);
    String typeName=ds.getSchema().getTypeName();
    REPOSITORY.register("dsStreams",ds);
    MemoryDataStore dsStreams_5=createMemStoreVertical(ds.getSchema(),"dsStreams_5","streams_5");
    MemoryDataStore dsStreams_10=createMemStoreVertical(ds.getSchema(),"dsStreams_10","streams_10");
    MemoryDataStore dsStreams_20=createMemStoreVertical(ds.getSchema(),"dsStreams_20","streams_20");
    MemoryDataStore dsStreams_50=createMemStoreVertical(ds.getSchema(),"dsStreams_50","streams_50");
    MemoryDataStore dsStreams_5_10=createMemStoreMixed(ds.getSchema(),"dsStreams_5_10","streams_5_10");
    MemoryDataStore dsStreams_20_50=createMemStoreMixed(ds.getSchema(),"dsStreams_20_50","streams_20_50");
    MemoryDataStore dsStreams_5_10_20_50=createMemStoreHorizontal(ds.getSchema(),"dsStreams_5_10_20_50","streams_5_10_20_50");
    Transaction t=new DefaultTransaction();
    Query query=new Query(typeName,Filter.INCLUDE);
    FeatureReader<SimpleFeatureType,SimpleFeature> reader=ds.getFeatureReader(query,t);
    while (reader.hasNext()) {
      SimpleFeature stream=reader.next();
      POINTMAP.get(0.0).put(stream.getID(),((Geometry)stream.getDefaultGeometry()).getNumPoints());
      addGeneralizedFeatureVertical(stream,dsStreams_5,5.0);
      addGeneralizedFeatureVertical(stream,dsStreams_10,10.0);
      addGeneralizedFeatureVertical(stream,dsStreams_20,20.0);
      addGeneralizedFeatureVertical(stream,dsStreams_50,50.0);
      addGeneralizedFeatureMixed(stream,dsStreams_5_10,5.0,10.0);
      addGeneralizedFeatureMixed(stream,dsStreams_20_50,20.0,50.0);
      addGeneralizedFeatureHorizontal(stream,dsStreams_5_10_20_50);
    }
    reader.close();
    t.close();
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  initialized=true;
}
