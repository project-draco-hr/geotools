{
  FilterFactory ff=FilterFactory.createFilterFactory();
  CompareFilter cf=ff.createCompareFilter(FilterType.COMPARE_EQUALS);
  cf.addLeftValue(ff.createAttributeExpression(null,"module"));
  cf.addRightValue(ff.createLiteralExpression(MODULE));
  String[] ps=new String[]{"wkb_geometry","tlid"};
  Query q=new DefaultQuery("completechain",cf,ps);
  FeatureReader fr=ds.getFeatureReader(q,new DefaultTransaction());
  while (fr.hasNext()) {
    Feature f=fr.next();
    BigDecimal tlidBD=(BigDecimal)f.getAttribute(1);
    Long tlid=new Long(tlidBD.longValue());
    if (tlid == null)     throw new Exception("cchain has null tlid");
    completeChains.put(tlid,f.getAttribute(0));
  }
  fr.close();
}
