{
  final List<String> queryColumns=getQueryColumns(queryProperties,unsupportedFilter,fullSchema);
  final String[] attNames=queryColumns.toArray(new String[queryColumns.size()]);
  try {
    SimpleFeatureType querySchema=DataUtilities.createSubType(fullSchema,attNames);
    return querySchema;
  }
 catch (  SchemaException ex) {
    throw new DataSourceException("Some requested attributes do not match the table schema: " + ex.getMessage(),ex);
  }
}
