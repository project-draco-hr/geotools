{
  int ndigits=0;
  final double EPS=1E-6;
  final int length=categories.length;
  for (int i=0; i < length; i++) {
    final Category category=categories[i];
    final Category geophysics=category.geophysics(true);
    final Category packed=category.geophysics(false);
    final double ln=Math.log10((geophysics.maximum - geophysics.minimum) / (packed.maximum - packed.minimum));
    if (!Double.isNaN(ln)) {
      final int n=-(int)(Math.floor(ln + EPS));
      if (n > ndigits) {
        ndigits=Math.min(n,MAX_DIGITS);
      }
    }
  }
  return ndigits;
}
