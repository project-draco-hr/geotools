{
  Object layer;
  GeometryDescriptor geomType=schema.getGeometryDescriptor();
  long ogrGeomType=mapper.getOGRGeometryType(geomType);
  Object spatialReference=mapper.getSpatialReference(geomType.getCoordinateReferenceSystem());
  layer=ogr.DataSourceCreateLayer(dataSource,schema.getTypeName(),spatialReference,ogrGeomType,options);
  if (layer == null) {
    throw new DataSourceException("Could not create the OGR layer: " + ogr.GetLastErrorMsg());
  }
  return layer;
}
