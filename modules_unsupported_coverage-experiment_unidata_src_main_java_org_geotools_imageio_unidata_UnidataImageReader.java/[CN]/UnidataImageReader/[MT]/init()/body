{
  int numImages=0;
  try {
    if (dataset != null) {
      checkType=UnidataUtilities.getCheckType(dataset);
      extractCoordinatesVariable();
      extractBBOX();
      final File slicesIndexFile=ancillaryFileManager.getSlicesIndexFile();
      if (slicesIndexFile != null) {
        if (slicesIndexFile.exists()) {
          ancillaryFileManager.initSliceManager();
          numImages=ancillaryFileManager.slicesIndexManager.getNumberOfRecords();
          if (!ignoreMetadata) {
            initCatalog(slicesIndexFile.getParentFile(),FilenameUtils.removeExtension(FilenameUtils.getName(slicesIndexFile.getCanonicalPath())).replace(".",""));
            coverages.addAll(ancillaryFileManager.getCoveragesNames());
          }
        }
        if (numImages <= 0 || !slicesIndexFile.exists()) {
          ancillaryFileManager.resetSliceManager();
          numImages=initIndex();
          ancillaryFileManager.initSliceManager();
          numImages=ancillaryFileManager.slicesIndexManager.getNumberOfRecords();
        }
      }
 else {
        numImages=initIndex();
      }
    }
 else {
      throw new IllegalArgumentException("No valid NetCDF dataset has been found");
    }
  }
 catch (  InvalidRangeException e) {
    throw new IllegalArgumentException("Exception occurred during NetCDF file parsing",e);
  }
  setNumImages(numImages);
}
