{
  int size=size();
  if (a.length < size)   a=(Object[])java.lang.reflect.Array.newInstance(a.getClass().getComponentType(),size);
  Iterator it=iterator();
  try {
    Object[] result=a;
    for (int i=0; i < size; i++)     result[i]=it.next();
    if (a.length > size)     a[size]=null;
    return a;
  }
  finally {
    close(it);
  }
}
