{
  Connection con=null;
  try {
    con=dataStore.getDataSource().getConnection();
    DB2DialectInfo di=((DB2SQLDialectPrepared)dataStore.getSQLDialect()).getDb2DialectInfo();
    DatabaseMetaData md=con.getMetaData();
    di.setMajorVersion(md.getDatabaseMajorVersion());
    di.setMinorVersion(md.getDatabaseMinorVersion());
    di.setProductName(md.getDatabaseProductName());
    di.setProductVersion(md.getDatabaseProductVersion());
    if (dataStore.getDatabaseSchema() == null) {
      PreparedStatement ps=con.prepareStatement(GetCurrentSchema);
      ResultSet rs=ps.executeQuery();
      rs.next();
      dataStore.setDatabaseSchema(rs.getString(1));
      rs.close();
      ps.close();
    }
    PreparedStatement ps=con.prepareStatement(GetWKBZTypes);
    ResultSet rs=ps.executeQuery();
    rs.next();
    byte[] bytes=rs.getBytes(1);
    ByteOrderDataInStream dis=new ByteOrderDataInStream();
    dis.setInStream(new ByteArrayInStream(bytes));
    byte byteOrder=dis.readByte();
    if (byteOrder == WKBConstants.wkbNDR)     dis.setOrder(ByteOrderValues.LITTLE_ENDIAN);
    int geometryType=dis.readInt();
    if (geometryType == 1001)     di.setHasOGCWkbZTyps(true);
    rs.close();
    ps.close();
  }
 catch (  SQLException e) {
    throw new IOException(e.getMessage());
  }
  dataStore.closeSafe(con);
  return dataStore;
}
