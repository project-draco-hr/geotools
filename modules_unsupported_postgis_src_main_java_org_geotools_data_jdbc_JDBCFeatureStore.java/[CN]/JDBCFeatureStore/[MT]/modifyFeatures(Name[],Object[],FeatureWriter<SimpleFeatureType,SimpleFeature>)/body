{
  SimpleFeature feature;
  try {
    while (writer.hasNext()) {
      feature=writer.next();
      for (int i=0; i < names.length; i++) {
        try {
          feature.setAttribute(names[i],values[i]);
        }
 catch (        IllegalAttributeException e) {
          throw new DataSourceException("Could not update feature " + feature.getID() + " with "+ names[i]+ "="+ values[i],e);
        }
      }
      writer.write();
    }
  }
  finally {
    writer.close();
  }
}
