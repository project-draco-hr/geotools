{
  final int count=fids.length;
  final int groups=count / groupSize;
  final int remainder=count % groupSize;
  final StringBuilder sql=new StringBuilder();
  final String encodedFidAttribute=getColumnDefinition(fidAttribute);
  for (int i=0; i < groups; i++) {
    if (i > 0) {
      sql.append(groupSeparator);
    }
    sql.append(encodedFidAttribute);
    sql.append(prefix);
    addSubList(sql,fids,i * groupSize,(i + 1) * groupSize,separator);
    sql.append(suffix);
  }
  if (remainder > 0) {
    if (groups > 0) {
      sql.append(groupSeparator);
    }
    sql.append(encodedFidAttribute);
    sql.append(prefix);
    addSubList(sql,fids,count - remainder,count,separator);
    sql.append(suffix);
  }
  return sql.toString();
}
