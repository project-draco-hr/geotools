{
  init(reader);
  attributesMap=new HashMap<String,String>();
  IIOMetadata metadata;
  IIOMetadata streamMetadata;
  final int imageIndex=getImageIndex();
  try {
    metadata=reader.getImageMetadata(imageIndex);
    streamMetadata=reader.getStreamMetadata();
switch (hdf4_type) {
case TeraScan:
      setAttributesFromTerascanMetadata(metadata,streamMetadata);
    break;
case APS:
  setAttributesFromAPSMetadata(metadata,streamMetadata);
break;
}
}
 catch (IOException e) {
throw new IllegalArgumentException("Unable parsing metadata");
}
}
