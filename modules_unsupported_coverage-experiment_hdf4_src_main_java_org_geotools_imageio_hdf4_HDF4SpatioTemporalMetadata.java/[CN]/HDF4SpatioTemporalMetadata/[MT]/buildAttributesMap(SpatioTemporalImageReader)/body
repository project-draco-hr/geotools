{
  init(reader);
  attributesMap=new HashMap<String,String>();
  IIOMetadata metadata;
  IIOMetadata streamMetadata;
  final int imageIndex=getImageIndex();
  try {
    HDF4ImageReader hdf4ImageReader=(HDF4ImageReader)reader;
    metadata=hdf4ImageReader.getImageMetadata(imageIndex);
    streamMetadata=hdf4ImageReader.getStreamMetadata();
switch (hdf4_type) {
case TeraScan:
      setAttributesFromTerascanMetadata(metadata,streamMetadata);
    break;
case APS:
  setAttributesFromAPSMetadata(metadata,streamMetadata);
break;
}
}
 catch (IOException e) {
throw new IllegalArgumentException("Unable parsing metadata");
}
}
