{
  try {
    super.setInput(input,seekForwardOnly,ignoreMetadata);
    dataset=NetCDFUtilities.getDataset(input);
    if (dataset == null)     throw new IllegalArgumentException("Error occurred during NetCDF file parsing: obtained a null netcdf dataset");
    int numImages=0;
    final CheckType checkType=NetCDFUtilities.getCheckType(dataset);
    variableMap=new HashMap<Range,Variable>();
    coordinatesMap=new HashMap<String,Variable>();
    if (dataset != null) {
      final List<Variable> variables=dataset.getVariables();
      if (variables != null) {
        for (        final Variable variable : variables) {
          if (variable != null && variable instanceof VariableDS) {
            String varName=variable.getName();
            if (variable.isCoordinateVariable())             coordinatesMap.put(varName,variable);
            if (variable instanceof CoordinateAxis1D) {
              if (varName.equalsIgnoreCase(NetCDFUtilities.LAT) || varName.equalsIgnoreCase(NetCDFUtilities.LATITUDE) || varName.equalsIgnoreCase(NetCDFUtilities.LON)|| varName.equalsIgnoreCase(NetCDFUtilities.LONGITUDE)) {
                variable.read();
              }
            }
            if (!NetCDFUtilities.isVariableAccepted(variable,checkType))             continue;
            int[] shape=variable.getShape();
switch (shape.length) {
case 2:
              variableMap.put(new Range(numImages,numImages + 1),variable);
            numImages++;
          break;
case 3:
        variableMap.put(new Range(numImages,numImages + shape[0]),variable);
      numImages+=shape[0];
    break;
case 4:
  variableMap.put(new Range(numImages,numImages + shape[0] * shape[1]),variable);
numImages+=shape[0] * shape[1];
break;
}
}
}
}
}
}
 catch (IOException e) {
throw new IllegalArgumentException("Error occurred during NetCDF file parsing",e);
}
catch (InvalidRangeException e) {
throw new IllegalArgumentException("Error occurred during NetCDF file parsing",e);
}
directReader.setInput(input,seekForwardOnly,ignoreMetadata);
}
