{
  final long requestedTime=date.getTime();
  RevCommit closest=null;
  while (commitsInDescendingOrder.hasNext()) {
    RevCommit current=commitsInDescendingOrder.next();
    if (closest == null) {
      closest=current;
    }
 else {
      long delta=Math.abs(current.getTimestamp() - requestedTime);
      long prevDelta=Math.abs(closest.getTimestamp() - requestedTime);
      if (delta < prevDelta) {
        closest=current;
      }
    }
  }
  return closest;
}
