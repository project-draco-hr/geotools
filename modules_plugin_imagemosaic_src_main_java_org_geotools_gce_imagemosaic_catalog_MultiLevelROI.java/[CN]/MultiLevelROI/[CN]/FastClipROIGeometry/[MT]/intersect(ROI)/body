{
  final Geometry geom=getGeometry(roi);
  if (geom != null && geom.equalsExact(geom.getEnvelope())) {
    GeometryClipper clipper=new GeometryClipper(geom.getEnvelopeInternal());
    Geometry intersect=clipper.clip(getAsGeometry(),true);
    return new ROIGeometry(intersect);
  }
 else {
    return super.intersect(roi);
  }
}
