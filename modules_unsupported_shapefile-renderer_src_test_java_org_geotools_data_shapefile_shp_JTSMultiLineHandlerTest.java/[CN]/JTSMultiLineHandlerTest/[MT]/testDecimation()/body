{
  URL url=TestData.getResource(LabelingTest.class,"theme1.shp");
  ShapefileDataStore ds=(ShapefileDataStore)new ShapefileDataStoreFactory().createDataStore(url);
  Envelope env=new Envelope(-7.105552354197932,8.20555235419793,-3.239388966356115,4.191388966388683);
  CoordinateReferenceSystem crs=DefaultGeographicCRS.WGS84;
  MathTransform mt=CRS.findMathTransform(crs,DefaultGeographicCRS.WGS84);
  AffineTransform at=RendererUtilities.worldToScreenTransform(env,new Rectangle(300,300));
  MathTransform worldToScreen=ReferencingFactoryFinder.getMathTransformFactory(null).createAffineTransform(new GeneralMatrix(at));
  mt=ReferencingFactoryFinder.getMathTransformFactory(null).createConcatenatedTransform(mt,worldToScreen);
  ShapefileReader reader=new ShapefileReader(ShapefileRendererUtil.getShpFiles(ds),false,false);
  reader.setHandler(new org.geotools.renderer.shape.shapehandler.jts.MultiLineHandler(reader.getHeader().getShapeType(),env,mt,false,new Rectangle(300,300)));
  Geometry shape=(Geometry)reader.nextRecord().shape();
  assertEquals(3,shape.getCoordinates().length);
  shape=(Geometry)reader.nextRecord().shape();
  assertEquals(2,shape.getCoordinates().length);
  shape=(Geometry)reader.nextRecord().shape();
  assertEquals(2,shape.getCoordinates().length);
}
