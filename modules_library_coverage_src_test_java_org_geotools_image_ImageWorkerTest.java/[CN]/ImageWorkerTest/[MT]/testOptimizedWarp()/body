{
  GridCoverage2D ushortCoverage=EXAMPLES.get(5);
  GridCoverage2D coverage=project(ushortCoverage,CRS.parseWKT(GOOGLE_MERCATOR_WKT),null,"nearest",null,true);
  RenderedImage ri=coverage.getRenderedImage();
  ImageWorker.WARP_REDUCTION_ENABLED=false;
  AffineTransform at=new AffineTransform(0.4,0,0,0.5,-200,-200);
  RenderedOp fullChain=(RenderedOp)new ImageWorker(ri).affine(at,Interpolation.getInstance(Interpolation.INTERP_NEAREST),new double[]{0}).getRenderedImage();
  assertEquals("Scale",fullChain.getOperationName());
  fullChain.getTiles();
  ImageWorker.WARP_REDUCTION_ENABLED=true;
  RenderedOp reduced=(RenderedOp)new ImageWorker(ri).affine(at,Interpolation.getInstance(Interpolation.INTERP_NEAREST),new double[]{0}).getRenderedImage();
  reduced.getTiles();
  assertEquals("Warp",reduced.getOperationName());
  assertEquals(1,reduced.getSources().size());
  assertSame(ushortCoverage.getRenderedImage(),reduced.getSourceImage(0));
  assertEquals(fullChain.getBounds(),reduced.getBounds());
  assertEquals(0,reduced.getTileGridXOffset());
  assertEquals(0,reduced.getTileGridYOffset());
  assertEquals(ushortCoverage.getRenderedImage().getTileWidth(),reduced.getTileWidth());
  assertEquals(ushortCoverage.getRenderedImage().getTileHeight(),reduced.getTileHeight());
}
