{
  if (offset != null && offset.intValue() != 0) {
    throw new UnsupportedOperationException("Requested an startIndex of " + offset + " where its not supported");
  }
  StringBuffer sqlBuffer=new StringBuffer();
  sqlBuffer.append("SELECT ");
  sqlColumns(sqlBuffer,mapper,attrTypes);
  sqlFrom(sqlBuffer,typeName);
  encoder.setFIDMapper(mapper);
  sqlWhere(sqlBuffer,filter);
  if (sortBy != null) {
    sqlOrderBy(sqlBuffer,null,sortBy);
  }
  String sqlStmt=sqlBuffer.toString();
  return sqlStmt;
}
