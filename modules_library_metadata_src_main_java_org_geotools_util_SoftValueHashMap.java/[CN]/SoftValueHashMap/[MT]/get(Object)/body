{
synchronized (hash) {
    Object value=hash.get(key);
    if (value instanceof Reference) {
      value=((Reference)value).getAndClear();
      if (value != null) {
        @SuppressWarnings("unchecked") final K k=(K)key;
        hash.put(k,value);
        retainStrongly(k);
      }
 else {
        hash.remove(key);
      }
    }
    @SuppressWarnings("unchecked") final V v=(V)value;
    return v;
  }
}
