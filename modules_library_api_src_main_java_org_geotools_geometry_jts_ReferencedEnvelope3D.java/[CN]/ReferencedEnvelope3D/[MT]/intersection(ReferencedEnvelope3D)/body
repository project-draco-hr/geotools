{
  ensureCompatibleReferenceSystem(env);
  if (isNull() || env.isNull() || !intersects(env))   return new ReferencedEnvelope3D();
  double intMinX=getMinX() > env.getMinX() ? getMinX() : env.getMinX();
  double intMinY=getMinY() > env.getMinY() ? getMinY() : env.getMinY();
  double intMinZ=minz > env.minz ? minz : env.minz;
  double intMaxX=getMaxX() < env.getMaxX() ? getMaxX() : env.getMaxX();
  double intMaxY=getMaxY() < env.getMaxY() ? getMaxY() : env.getMaxY();
  double intMaxZ=maxz < env.maxz ? maxz : env.maxz;
  return new ReferencedEnvelope3D(intMinX,intMaxX,intMinY,intMaxY,intMinZ,intMaxZ,env.getCoordinateReferenceSystem());
}
