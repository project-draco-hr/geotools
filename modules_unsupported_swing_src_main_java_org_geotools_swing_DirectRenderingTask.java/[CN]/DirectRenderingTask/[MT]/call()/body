{
  if (!cancelled.get()) {
    try {
      running.set(true);
      for (      Layer layer : mapContent.layers()) {
        if (layer instanceof DirectLayer) {
          DirectLayer dlayer=(DirectLayer)layer;
          dlayer.draw(destinationGraphics,mapContent,viewport);
        }
      }
    }
  finally {
      running.set(false);
    }
  }
  return !isCancelled();
}
