{
  String typeName=featureType.getTypeName();
  if ((request.getTypeName() != null) && !typeName.equals(request.getTypeName())) {
    throw new IOException("Cannot query " + typeName + " with:"+ request);
  }
  if (request.getTypeName() == null) {
    request=new DefaultQuery(request);
    ((DefaultQuery)request).setTypeName(featureType.getTypeName());
  }
  final QueryCapabilities queryCapabilities=getQueryCapabilities();
  if (!queryCapabilities.supportsSorting(request.getSortBy())) {
    throw new DataSourceException("DataStore cannot provide the requested sort order");
  }
  return new JDBCFeatureCollection(this,request);
}
