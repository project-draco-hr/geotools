{
  checkTransaction();
  checkEditFilterMatchesCurrentVersion(filter);
  final SimpleFeatureCollection affectedFeatures=getFeatures(filter);
  final FeatureCollection newValues=new ModifyingFeatureCollection(affectedFeatures,attributeNames,attributeValues);
  VersioningTransactionState versioningState=getVersioningState();
  try {
    versioningState.stageUpdate(type.getName(),newValues);
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
}
