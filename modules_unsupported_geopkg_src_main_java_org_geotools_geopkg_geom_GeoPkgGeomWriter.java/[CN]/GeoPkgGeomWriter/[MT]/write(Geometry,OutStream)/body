{
  if (g == null) {
    return;
  }
  GeometryHeaderFlags flags=new GeometryHeaderFlags((byte)0);
  flags.setVersion((byte)0);
  flags.setEndianess(ByteOrderValues.BIG_ENDIAN);
  flags.setEnvelopeIndicator(g instanceof Point ? EnvelopeType.NONE : EnvelopeType.XY);
  GeometryHeader h=new GeometryHeader();
  h.setVersion((byte)0);
  h.setFlags(flags);
  h.setEnvelope(g.getEnvelopeInternal());
  h.setSrid(g.getSRID());
  byte[] buf=new byte[8];
  buf[0]=0x47;
  buf[1]=0x50;
  buf[2]=h.getVersion();
  buf[3]=flags.toByte();
  out.write(buf,4);
  int order=flags.getEndianess();
  ByteOrderValues.putInt(g.getSRID(),buf,order);
  out.write(buf,4);
  if (flags.getEnvelopeIndicator() != EnvelopeType.NONE) {
    Envelope env=g.getEnvelopeInternal();
    ByteOrderValues.putDouble(env.getMinX(),buf,order);
    out.write(buf,8);
    ByteOrderValues.putDouble(env.getMaxX(),buf,order);
    out.write(buf,8);
    ByteOrderValues.putDouble(env.getMinY(),buf,order);
    out.write(buf,8);
    ByteOrderValues.putDouble(env.getMaxY(),buf,order);
    out.write(buf,8);
  }
  new WKBWriter(2,order).write(g,out);
}
