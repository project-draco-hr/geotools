{
  mappedSource=mapping.getSource();
  if (cachedQuery == null || !cachedQuery.equals(query)) {
    sourceFeatures=(SimpleFeatureCollection)mappedSource.getFeatures(query);
    XmlFeatureSource xmlFeatureSource=(XmlFeatureSource)mappedSource;
    xmlFeatureSource.setNamespaces(mapping.getNamespaces());
    xmlFeatureSource.setItemXpath(mapping.getItemXpath());
    this.xmlResponse=((XmlFeatureCollection)sourceFeatures).xmlResponse();
    XmlMappingFeatureIterator.cachedQuery=query;
    XmlMappingFeatureIterator.cachedXmlResponse=xmlResponse;
  }
 else {
    this.xmlResponse=cachedXmlResponse;
    XmlMappingFeatureIterator.cachedXmlResponse=null;
    XmlMappingFeatureIterator.cachedQuery=null;
  }
}
