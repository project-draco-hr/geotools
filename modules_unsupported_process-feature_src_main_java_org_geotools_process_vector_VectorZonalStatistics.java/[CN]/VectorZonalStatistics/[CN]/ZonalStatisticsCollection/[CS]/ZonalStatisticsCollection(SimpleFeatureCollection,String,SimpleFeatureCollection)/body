{
  super(zones);
  this.dataAttribute=dataAttribute;
  this.data=data;
  SimpleFeatureTypeBuilder tb=new SimpleFeatureTypeBuilder();
  for (  AttributeDescriptor att : zones.getSchema().getAttributeDescriptors()) {
    tb.minOccurs(att.getMinOccurs());
    tb.maxOccurs(att.getMaxOccurs());
    tb.restrictions(att.getType().getRestrictions());
    if (att instanceof GeometryDescriptor) {
      GeometryDescriptor gatt=(GeometryDescriptor)att;
      tb.crs(gatt.getCoordinateReferenceSystem());
    }
    tb.add("z_" + att.getLocalName(),att.getType().getBinding());
  }
  AttributeDescriptor dataDescriptor=data.getSchema().getDescriptor(dataAttribute);
  tb.add("count",Long.class);
  tb.add("min",Double.class);
  tb.add("max",Double.class);
  tb.add("sum",Double.class);
  tb.add("avg",Double.class);
  tb.add("stddev",Double.class);
  tb.setName(zones.getSchema().getName());
  targetSchema=tb.buildFeatureType();
}
