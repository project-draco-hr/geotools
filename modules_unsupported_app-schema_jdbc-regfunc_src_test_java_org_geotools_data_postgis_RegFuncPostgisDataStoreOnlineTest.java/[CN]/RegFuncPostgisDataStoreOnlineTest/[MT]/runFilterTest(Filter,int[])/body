{
  DataStore datastore=null;
  try {
    datastore=DataStoreFinder.getDataStore(getParams());
    assertNotNull(datastore);
    Query query=new DefaultQuery(TEST_TABLE_NAME,filter);
    FeatureReader<SimpleFeatureType,SimpleFeature> reader=null;
    try {
      List<Integer> featureIds=new ArrayList<Integer>();
      reader=datastore.getFeatureReader(query,Transaction.AUTO_COMMIT);
      for (SimpleFeature feature=null; reader.hasNext(); ) {
        feature=reader.next();
        Integer id=Integer.valueOf(feature.getID().replace(TEST_TABLE_NAME + ".",""));
        featureIds.add(id);
      }
      assertEquals(sortedList(expectedFeatureIds),sorted(featureIds));
    }
  finally {
      if (reader != null) {
        reader.close();
      }
    }
  }
  finally {
    if (datastore != null) {
      datastore.dispose();
    }
  }
}
