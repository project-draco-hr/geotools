{
  Connection dbConnection=null;
  try {
    String dbSchema=config.getDatabaseSchemaName();
    StringBuffer sql=new StringBuffer();
    sql.append("SELECT srid FROM geometry_columns WHERE ");
    if (schemaEnabled && dbSchema != null && dbSchema.length() > 0) {
      sql.append("f_table_schema='");
      sql.append(dbSchema);
      sql.append("' AND ");
    }
    sql.append("f_table_name='");
    sql.append(tableName);
    sql.append("' AND f_geometry_column='");
    sql.append(geometryColumnName);
    sql.append("';");
    String sqlStatement=sql.toString();
    LOGGER.fine("srid statement is " + sqlStatement);
    dbConnection=getConnection(Transaction.AUTO_COMMIT);
    Statement statement=dbConnection.createStatement();
    ResultSet result=statement.executeQuery(sqlStatement);
    if (result.next()) {
      int retSrid=result.getInt("srid");
      JDBCUtils.close(statement);
      return retSrid;
    }
    result.close();
    sql=new StringBuffer();
    sql.append("SELECT SRID(\"");
    sql.append(geometryColumnName);
    sql.append("\") FROM \"");
    if (schemaEnabled && dbSchema != null && dbSchema.length() > 0) {
      sql.append(dbSchema);
      sql.append("\".\"");
    }
    sql.append(tableName);
    sql.append("\" LIMIT 1");
    sqlStatement=sql.toString();
    result=statement.executeQuery(sqlStatement);
    if (result.next()) {
      int retSrid=result.getInt(1);
      JDBCUtils.close(statement);
      return retSrid;
    }
    String mesg="No geometry column row for srid in table: " + tableName + ", geometry column "+ geometryColumnName;
    throw new DataSourceException(mesg);
  }
 catch (  SQLException sqle) {
    String message=sqle.getMessage();
    throw new DataSourceException(message,sqle);
  }
 finally {
    JDBCUtils.close(dbConnection,Transaction.AUTO_COMMIT,null);
  }
}
