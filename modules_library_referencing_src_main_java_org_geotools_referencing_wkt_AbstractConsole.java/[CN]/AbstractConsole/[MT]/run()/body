{
  try {
    while (!stop) {
      if (prompt != null) {
        out.write(prompt);
      }
      out.flush();
      line=readLine(in);
      if (line == null) {
        break;
      }
      try {
        execute(line);
      }
 catch (      Exception exception) {
        reportError(exception);
      }
    }
    out.flush();
    stop=false;
  }
 catch (  IOException exception) {
    reportError(exception);
  }
}
