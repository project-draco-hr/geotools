{
  if (record.length != header.getNumFields()) {
    throw new DbaseFileException("Wrong number of fields " + record.length + " expected "+ header.getNumFields());
  }
  buffer.position(0);
  buffer.put((byte)' ');
  byte[] bytes;
  for (int i=0; i < header.getNumFields(); i++) {
    if (record[i] == null) {
      bytes=nullValues[i];
    }
 else {
      bytes=fieldBytes(record[i],i);
      if (bytes.length != nullValues[i].length) {
        bytes=nullValues[i];
      }
    }
    buffer.put(bytes);
  }
  write();
}
