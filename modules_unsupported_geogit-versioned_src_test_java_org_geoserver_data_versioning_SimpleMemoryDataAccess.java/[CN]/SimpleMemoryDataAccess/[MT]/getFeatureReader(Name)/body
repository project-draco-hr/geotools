{
  return new FeatureReader<FeatureType,Feature>(){
    FeatureType featureType=getSchema(typeName);
    Iterator<SimpleFeature> iterator=features(typeName).values().iterator();
    public FeatureType getFeatureType(){
      return featureType;
    }
    public Feature next() throws IOException, IllegalAttributeException, NoSuchElementException {
      if (iterator == null) {
        throw new IOException("Feature Reader has been closed");
      }
      try {
        Feature next=iterator.next();
        if (next instanceof SimpleFeature) {
          return SimpleFeatureBuilder.copy((SimpleFeature)next);
        }
        return next;
      }
 catch (      NoSuchElementException end) {
        throw new DataSourceException("There are no more Features",end);
      }
    }
    public boolean hasNext(){
      return (iterator != null) && iterator.hasNext();
    }
    public void close(){
      if (iterator != null) {
        iterator=null;
      }
      if (featureType != null) {
        featureType=null;
      }
    }
  }
;
}
