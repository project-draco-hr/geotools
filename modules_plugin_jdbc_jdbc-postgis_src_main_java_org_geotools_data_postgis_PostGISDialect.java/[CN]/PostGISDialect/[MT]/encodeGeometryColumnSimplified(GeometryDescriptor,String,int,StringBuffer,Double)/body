{
  boolean geography="geography".equals(gatt.getUserData().get(JDBCDataStore.JDBC_NATIVE_TYPENAME));
  if (geography) {
    sql.append("encode(ST_AsBinary(ST_Simplify(");
    encodeColumnName(prefix,gatt.getLocalName(),sql);
    sql.append(", " + distance + ")),'base64')");
  }
 else {
    sql.append("encode(ST_AsBinary(ST_Simplify(ST_Force_2D(");
    encodeColumnName(prefix,gatt.getLocalName(),sql);
    sql.append("), " + distance + ")),'base64')");
  }
}
