{
  Object value;
  final Definition def=(Definition)definitions.get(text);
  if (def != null) {
    value=def.asObject;
    if (type.isAssignableFrom(value.getClass())) {
      return value;
    }
  }
 else   if (!isIdentifier(text)) {
    text=substitute(text);
    value=forwardParse(text);
    final Class actualType=value.getClass();
    if (type.isAssignableFrom(actualType)) {
      return value;
    }
    throw new FactoryException(Errors.format(ErrorKeys.ILLEGAL_CLASS_$2,actualType,type));
  }
  throw new NoSuchIdentifierException(Errors.format(ErrorKeys.NO_SUCH_AUTHORITY_CODE_$2,type,text),text);
}
