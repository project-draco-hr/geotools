{
  attributesMap=new HashMap<String,String>();
  IIOMetadata metadata;
  final int imageIndex=getImageIndex();
  try {
    metadata=reader.getImageMetadata(imageIndex);
    if (metadata instanceof GRIB1ImageMetadata) {
      Node root=metadata.getAsTree(GRIB1ImageMetadata.nativeMetadataFormatName);
      if (root != null) {
        Node gdsNode=root.getFirstChild();
        if (gdsNode != null) {
          final NamedNodeMap attributes=gdsNode.getAttributes();
          if (attributes != null) {
            final int numAttributes=attributes.getLength();
            for (int i=0; i < numAttributes; i++) {
              final Node node=attributes.item(i);
              if (node != null) {
                attributesMap.put(node.getNodeName(),node.getNodeValue());
              }
            }
          }
        }
        final Node pdsNode=gdsNode.getNextSibling();
        if (pdsNode != null) {
          final NamedNodeMap attributes=pdsNode.getAttributes();
          if (attributes != null) {
            final int numAttributes=attributes.getLength();
            for (int i=0; i < numAttributes; i++) {
              Node node=attributes.item(i);
              if (node != null) {
                attributesMap.put(node.getNodeName(),node.getNodeValue());
              }
            }
          }
        }
        final Node pdsLevelNode=pdsNode.getNextSibling();
        if (pdsLevelNode != null) {
          final NamedNodeMap attributes=pdsLevelNode.getAttributes();
          if (attributes != null) {
            final int numAttributes=attributes.getLength();
            for (int i=0; i < numAttributes; i++) {
              Node node=attributes.item(i);
              if (node != null) {
                attributesMap.put(node.getNodeName(),node.getNodeValue());
              }
            }
          }
        }
      }
    }
  }
 catch (  IOException e) {
    throw new IllegalArgumentException("Unable parsing metadata");
  }
}
