{
  dataStore.createSchema(poly3DType);
  SimpleFeatureType actualSchema=dataStore.getSchema(tname(POLY3D));
  assertFeatureTypesEqual(poly3DType,actualSchema);
  assertEquals(getNativeSRID(),actualSchema.getGeometryDescriptor().getUserData().get(JDBCDataStore.JDBC_NATIVE_SRID));
  FeatureWriter<SimpleFeatureType,SimpleFeature> fw=dataStore.getFeatureWriterAppend(tname(POLY3D),Transaction.AUTO_COMMIT);
  SimpleFeature f=fw.next();
  f.setAttribute(aname(ID),0);
  f.setAttribute(aname(GEOM),poly);
  f.setAttribute(aname(NAME),"3dpolygon!");
  fw.write();
  fw.close();
  final Hints hints=new Hints();
  hints.put(Hints.JTS_COORDINATE_SEQUENCE_FACTORY,new LiteCoordinateSequenceFactory());
  Query query=new DefaultQuery(tname(POLY3D));
  query.setHints(hints);
  FeatureReader<SimpleFeatureType,SimpleFeature> fr=dataStore.getFeatureReader(query,Transaction.AUTO_COMMIT);
  assertTrue(fr.hasNext());
  f=fr.next();
  Geometry fgeom=(Geometry)f.getDefaultGeometry();
  assertTrue("2D topology does not match",poly.equalsTopo(fgeom));
  assertTrue("Z values do not match",hasMatchingZValues(poly,fgeom));
  fr.close();
}
