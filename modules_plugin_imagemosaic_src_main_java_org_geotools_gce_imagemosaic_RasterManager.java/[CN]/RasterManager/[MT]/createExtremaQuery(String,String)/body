{
  final Query query=new Query(granuleCatalog.getType().getTypeName());
  query.setPropertyNames(Arrays.asList(attributeName));
  final FeatureCalc visitor=metadataName.toLowerCase().endsWith("maximum") ? new MaxVisitor(attributeName) : new MinVisitor(attributeName);
  granuleCatalog.computeAggregateFunction(query,visitor);
  return visitor;
}
