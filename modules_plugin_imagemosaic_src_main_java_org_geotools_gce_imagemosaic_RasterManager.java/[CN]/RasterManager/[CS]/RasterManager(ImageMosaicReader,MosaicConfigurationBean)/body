{
  Utilities.ensureNonNull("ImageMosaicReader",reader);
  this.parent=reader;
  this.expandMe=parent.expandMe;
  this.heterogeneousGranules=parent.heterogeneousGranules;
  granuleCatalog=parent.catalog;
  parent.catalog=null;
  coverageIdentifier=reader.getName();
  hints=reader.getHints();
  this.coverageIdentifier=reader.getName();
  this.coverageFactory=reader.getGridCoverageFactory();
  this.pathType=parent.pathType;
  overviewsController=new OverviewsController(reader.getHighestRes(),reader.getNumberOfOvervies(),reader.getOverviewsResolution());
  try {
    spatialDomainManager=new SpatialDomainManager(reader.getOriginalEnvelope(),(GridEnvelope2D)reader.getOriginalGridRange(),reader.getCrs(),reader.getOriginalGridToWorld(PixelInCell.CELL_CENTER),overviewsController);
  }
 catch (  TransformException e) {
    throw new DataSourceException(e);
  }
catch (  FactoryException e) {
    throw new DataSourceException(e);
  }
  extractOverviewPolicy();
  extractDecimationPolicy();
  loadSampleImage();
  if (configuration != null) {
    final SimpleFeatureType schema=granuleCatalog.getType();
    if (configuration.getAdditionalDomainAttributes() != null) {
      domainsManager=new DomainManager(configuration.getAdditionalDomainAttributes(),schema);
    }
    if (configuration.getTimeAttribute() != null) {
      final HashMap<String,String> init=new HashMap<String,String>();
      init.put(DomainDescriptor.TIME_DOMAIN,configuration.getTimeAttribute());
      timeDomainManager=new DomainManager(init,schema);
    }
    if (configuration.getElevationAttribute() != null) {
      final HashMap<String,String> init=new HashMap<String,String>();
      init.put(DomainDescriptor.ELEVATION_DOMAIN,configuration.getElevationAttribute());
      elevationDomainManager=new DomainManager(init,schema);
    }
  }
}
