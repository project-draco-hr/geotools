{
  gridValues=new float[(xNumCells + 1) * (yNumCells + 1)];
  for (int i=0; i <= yNumCells; i++) {
    for (int j=0; j <= xNumCells; j++) {
      DirectPosition dp=new DirectPosition2D(env.getLowerCorner().getOrdinate(0) + (j * dx),env.getUpperCorner().getOrdinate(1) - (i * dy));
      int index=(i * (1 + xNumCells)) + j;
      float value=getValue(dp);
      gridValues[index]=value;
    }
  }
  return gridValues;
}
