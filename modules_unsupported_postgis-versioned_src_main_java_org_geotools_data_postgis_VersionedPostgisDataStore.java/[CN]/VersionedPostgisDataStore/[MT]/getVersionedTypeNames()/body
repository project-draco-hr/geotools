{
  Connection conn=null;
  Statement st=null;
  ResultSet rs=null;
  List tables=new ArrayList();
  try {
    PostgisSQLBuilder sqlb=wrapped.createSQLBuilder();
    conn=wrapped.getDataSource().getConnection();
    st=conn.createStatement();
    rs=executeQuery(st,"SELECT NAME from " + sqlb.encodeTableName(TBL_VERSIONEDTABLES) + " WHERE SCHEMA = '"+ getConfig().getDatabaseSchemaName()+ "'"+ " AND VERSIONED ='"+ true+ "'");
    while (rs.next()) {
      tables.add(rs.getString(1));
    }
  }
 catch (  SQLException sqlException) {
    String message="Error querying database for list of versioned tables:" + sqlException.getMessage();
    throw new DataSourceException(message,sqlException);
  }
 finally {
    JDBCUtils.close(rs);
    JDBCUtils.close(st);
    JDBCUtils.close(conn,Transaction.AUTO_COMMIT,null);
  }
  return (String[])tables.toArray(new String[tables.size()]);
}
