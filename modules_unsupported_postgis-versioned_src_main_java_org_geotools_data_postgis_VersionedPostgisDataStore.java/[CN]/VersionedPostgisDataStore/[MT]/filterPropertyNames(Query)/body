{
  String[] names=wrapped.propertyNames(query);
  Set extraColumns=new HashSet();
  if (isVersionedFeatureCollection(query.getTypeName()) || isVersioned(query.getTypeName(),null)) {
    extraColumns.add("revision");
    extraColumns.add("expired");
    extraColumns.add("created");
  }
  FIDMapper mapper=getFIDMapper(query.getTypeName());
  for (int i=0; i < mapper.getColumnCount(); i++) {
    extraColumns.add(mapper.getColumnName(i).toLowerCase());
  }
  List filtered=new ArrayList(names.length);
  for (int i=0; i < names.length; i++) {
    if (!extraColumns.contains(names[i]))     filtered.add(names[i]);
  }
  return (String[])filtered.toArray(new String[filtered.size()]);
}
