{
  Connection conn=null;
  Statement st=null;
  ResultSet rs=null;
  try {
    conn=wrapped.getDataSource().getConnection();
    st=conn.createStatement();
    rs=st.executeQuery("select max(revision) from " + TBL_CHANGESETS);
    rs.next();
    return rs.getLong(1);
  }
 catch (  SQLException e) {
    throw new DataSourceException("Error getting last revision.",e);
  }
 finally {
    JDBCUtils.close(rs);
    JDBCUtils.close(st);
    JDBCUtils.close(conn,Transaction.AUTO_COMMIT,null);
  }
}
