{
  assertTrue(copyShapefiles(STREAM).canRead());
  ShapefileDataStore store=(ShapefileDataStore)new ShapefileDataStoreFactory().createDataStore(TestData.url(TestCaseSupport.class,STREAM));
  int count=0;
  FeatureReader<SimpleFeatureType,SimpleFeature> reader=store.getFeatureReader();
  try {
    while (reader.hasNext()) {
      count++;
      reader.next();
    }
    assertEquals(count,store.getCount(Query.ALL));
  }
  finally {
    reader.close();
  }
  store.dispose();
}
