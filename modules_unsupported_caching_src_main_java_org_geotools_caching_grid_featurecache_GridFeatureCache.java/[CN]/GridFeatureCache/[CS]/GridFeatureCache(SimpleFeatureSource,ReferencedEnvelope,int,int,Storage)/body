{
  super(fs);
  tracker=new GridSpatialIndex(CacheUtil.convert(env),gridsize,store,capacity);
  this.capacity=capacity;
  if (store.getFeatureTypes().size() == 0) {
    store.addFeatureType(fs.getSchema());
  }
 else   if (store.getFeatureTypes().size() == 1) {
    SimpleFeatureType sft=(SimpleFeatureType)store.getFeatureTypes().iterator().next();
    if (!sft.equals(fs.getSchema()) && fs.getSchema() != null) {
      tracker.clear();
      store.clearFeatureTypes();
      store.addFeatureType(fs.getSchema());
    }
  }
 else {
    tracker.clear();
    store.clearFeatureTypes();
    store.addFeatureType(fs.getSchema());
  }
  if (env != null && !env.equals(store.getBounds())) {
    store.setBounds(env);
  }
  tracker.flush();
}
