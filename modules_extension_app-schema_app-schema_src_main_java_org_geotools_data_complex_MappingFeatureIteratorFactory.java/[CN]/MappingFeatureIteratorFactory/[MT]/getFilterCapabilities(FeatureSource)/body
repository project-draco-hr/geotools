{
  FilterCapabilities capabilities=null;
  if (mappedSource instanceof JDBCFeatureSource) {
    capabilities=((JDBCFeatureSource)mappedSource).getDataStore().getFilterCapabilities();
  }
 else   if (mappedSource instanceof JDBCFeatureStore) {
    capabilities=((JDBCFeatureStore)mappedSource).getDataStore().getFilterCapabilities();
  }
 else {
    throw new IllegalArgumentException("Joining queries are only supported on JDBC data stores");
  }
  return capabilities;
}
