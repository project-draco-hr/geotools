{
  final double[] nodataValues=test.getNoDataValues();
  assertEquals("nodataValues.length",CATEGORIES.length,nodataValues.length);
  for (int i=0; i < CATEGORIES.length; i++) {
    assertEquals("nodataValues[" + i + ']',NO_DATA[i],nodataValues[i],0);
  }
  assertTrue("identity",!test.getSampleToGeophysics().isIdentity());
  assertEquals("scale",scale,test.getScale(),0);
  assertEquals("offset",offset,test.getOffset(),0);
  assertEquals("minimum",0,test.getMinimumValue(),0);
  assertEquals("maximum",255,test.getMaximumValue(),0);
  final GridSampleDimension invt=test.geophysics(true);
  assertTrue(test != invt);
  assertTrue("identity",invt.getSampleToGeophysics().isIdentity());
  assertEquals("scale",1,invt.getScale(),0);
  assertEquals("offset",0,invt.getOffset(),0);
  assertEquals("minimum",minimum * scale + offset,invt.getMinimumValue(),0);
  assertEquals("maximum",(maximum - 1) * scale + offset,invt.getMaximumValue(),EPS);
}
