{
  if (gridLocation == null) {
    throw new FactoryException("The grid location must be not null");
  }
synchronized (ntv2GridCache) {
    GridShiftFile grid=ntv2GridCache.get(gridLocation.toExternalForm());
    if (grid != null) {
      return grid;
    }
 else {
      if (gridLocation != null) {
        grid=loadNTv2Grid(gridLocation);
        if (grid != null) {
          ntv2GridCache.put(gridLocation.toExternalForm(),grid);
          return grid;
        }
      }
      throw new FactoryException("NTv2 Grid " + gridLocation + " could not be created.");
    }
  }
}
