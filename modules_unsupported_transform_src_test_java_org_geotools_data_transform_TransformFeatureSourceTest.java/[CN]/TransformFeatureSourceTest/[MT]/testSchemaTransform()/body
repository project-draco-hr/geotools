{
  SimpleFeatureSource transformed=transformWithExpressions();
  SimpleFeatureType schema=transformed.getSchema();
  SimpleFeatureType original=STATES.getSchema();
  assertEquals("bstates",schema.getTypeName());
  assertEquals(original.getName().getNamespaceURI(),schema.getName().getNamespaceURI());
  assertEquals(4,schema.getAttributeDescriptors().size());
  GeometryDescriptor geom=(GeometryDescriptor)schema.getDescriptor("geom");
  assertNotNull(geom);
  assertEquals(Geometry.class,geom.getType().getBinding());
  assertEquals("EPSG:4326",CRS.lookupIdentifier(geom.getCoordinateReferenceSystem(),true));
  AttributeDescriptor name=schema.getDescriptor("name");
  assertEquals(String.class,name.getType().getBinding());
  AttributeDescriptor total=schema.getDescriptor("total");
  assertEquals(Double.class,total.getType().getBinding());
  AttributeDescriptor logp=schema.getDescriptor("logp");
  assertEquals(Double.class,logp.getType().getBinding());
}
