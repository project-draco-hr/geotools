{
  Feature feature=(Feature)object;
  String id=feature.getIdentifier().getID();
  Name typeName;
  if (feature.getDescriptor() == null) {
    typeName=feature.getType().getName();
  }
 else {
    typeName=feature.getDescriptor().getName();
  }
  Element encoding=document.createElementNS(typeName.getNamespaceURI(),typeName.getLocalPart());
  if (!(feature instanceof SimpleFeature) && idSet != null) {
    if (idSet.idExists(id)) {
      encoding.setAttributeNS(XLINK.NAMESPACE,XLINK.HREF.getLocalPart(),"#" + id.toString());
      feature.setValue(Collections.emptyList());
      return encoding;
    }
 else {
      idSet.add(id);
    }
  }
  encoding.setAttributeNS(gml.getNamespaceURI(),"id",id);
  encodeClientProperties(feature,value);
  return encoding;
}
