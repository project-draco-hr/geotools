{
  if (getSchema() instanceof SimpleFeatureType) {
    SimpleFeatureCollection simple=DataUtilities.simple((FeatureCollection<SimpleFeatureType,SimpleFeature>)this);
    return (FeatureCollection<T,F>)new SortedSimpleFeatureCollection(simple,new SortBy[]{order});
  }
 else {
    throw new UnsupportedOperationException("Cannot sort on complex features at the moment");
  }
}
