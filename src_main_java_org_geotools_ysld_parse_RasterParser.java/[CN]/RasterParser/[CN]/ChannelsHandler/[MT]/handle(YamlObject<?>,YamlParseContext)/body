{
  YamlMap map=obj.map();
  if (map.has(Band.GRAY.key)) {
    if (map.has(Band.RED.key) || map.has(Band.GREEN.key) || map.has(Band.BLUE.key))     throw new IllegalArgumentException("grey and RGB can not be combined");
    SelectedChannelType gray=factory.style.selectedChannelType(null,null);
    selection.setGrayChannel(gray);
    context.push(Band.GRAY.key,new SelectedChannelHandler(gray));
  }
 else {
    if (!(map.has(Band.RED.key) && map.has(Band.GREEN.key) && map.has(Band.BLUE.key)))     throw new IllegalArgumentException("all of red green and blue must be preset");
    SelectedChannelType red=factory.style.selectedChannelType(null,null);
    SelectedChannelType green=factory.style.selectedChannelType(null,null);
    SelectedChannelType blue=factory.style.selectedChannelType(null,null);
    selection.setRGBChannels(red,green,blue);
    context.push(Band.RED.key,new SelectedChannelHandler(red));
    context.push(Band.GREEN.key,new SelectedChannelHandler(green));
    context.push(Band.BLUE.key,new SelectedChannelHandler(blue));
  }
}
