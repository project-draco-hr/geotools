{
  YamlMap map=obj.map();
  if (map.has("gray")) {
    if (map.has("red") || map.has("green") || map.has("blue"))     throw new IllegalArgumentException("grey and RGB can not be combined");
    SelectedChannelType gray=factory.style.selectedChannelType(null,null);
    selection.setGrayChannel(gray);
    context.push("gray",new SelectedChannelHandler(gray));
  }
 else {
    if (!(map.has("red") && map.has("green") && map.has("blue")))     throw new IllegalArgumentException("all of red green and blue must be preset");
    SelectedChannelType red=factory.style.selectedChannelType(null,null);
    SelectedChannelType green=factory.style.selectedChannelType(null,null);
    SelectedChannelType blue=factory.style.selectedChannelType(null,null);
    selection.setRGBChannels(red,green,blue);
    context.push("red",new SelectedChannelHandler(red));
    context.push("green",new SelectedChannelHandler(green));
    context.push("blue",new SelectedChannelHandler(blue));
  }
}
