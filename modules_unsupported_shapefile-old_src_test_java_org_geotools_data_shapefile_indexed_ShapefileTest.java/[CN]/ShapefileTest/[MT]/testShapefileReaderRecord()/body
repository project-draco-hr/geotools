{
  File file=copyShapefiles(STATEPOP);
  ShpFiles shpFiles=new ShpFiles(file.toURI().toURL());
  ShapefileReader reader=new ShapefileReader(shpFiles,false,false,new GeometryFactory());
  ArrayList offsets=new ArrayList();
  while (reader.hasNext()) {
    ShapefileReader.Record record=reader.nextRecord();
    offsets.add(new Integer(record.offset()));
    Geometry geom=(Geometry)record.shape();
    assertEquals(new Envelope(record.minX,record.maxX,record.minY,record.maxY),geom.getEnvelopeInternal());
    record.toString();
  }
  reader.close();
  copyShapefiles(STATEPOP);
  reader=new ShapefileReader(shpFiles,false,false,new GeometryFactory());
  for (int i=0, ii=offsets.size(); i < ii; i++) {
    reader.shapeAt(((Integer)offsets.get(i)).intValue());
  }
  reader.close();
}
