{
  List<String> attNames=new ArrayList<String>(schema.getAttributeCount() + 1);
  List<AttributeDescriptor> attDescriptors=schema.getAttributeDescriptors();
  for (  AttributeDescriptor property : attDescriptors) {
    attNames.add(property.getLocalName());
  }
  shapeIndex=attNames.indexOf(shapeColName);
  if (shapeIndex == -1) {
    String fidColumn=getFidColumn();
    int fidIndex=attNames.indexOf(shapeColName);
    if (fidIndex == -1) {
      attNames.add(fidColumn);
      fidIndex=attNames.size() - 1;
    }
    setColumnIndex(fidIndex);
  }
  return attNames.toArray(new String[attNames.size()]);
}
