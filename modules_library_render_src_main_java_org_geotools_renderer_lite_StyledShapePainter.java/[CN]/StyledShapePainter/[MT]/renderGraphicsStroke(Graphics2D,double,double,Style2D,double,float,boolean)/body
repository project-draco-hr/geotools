{
  if (LOGGER.isLoggable(Level.FINEST)) {
    LOGGER.finest("drawing GraphicsStroke@" + x + ","+ y);
  }
  graphics.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER,opacity));
  if (style instanceof GraphicStyle2D) {
    BufferedImage image=((GraphicStyle2D)style).getImage();
    renderImage(graphics,x,y,image,rotation,opacity,isLabelObstacle);
  }
 else   if (style instanceof MarkStyle2D) {
    MarkStyle2D ms2d=(MarkStyle2D)style;
    Shape transformedShape=ms2d.getTransformedShape((float)x,(float)y,(float)rotation);
    if (transformedShape != null) {
      if (ms2d.getFill() != null) {
        graphics.setPaint(ms2d.getFill());
        graphics.fill(transformedShape);
      }
      if (ms2d.getContour() != null) {
        graphics.setPaint(ms2d.getContour());
        graphics.setStroke(ms2d.getStroke());
        graphics.draw(transformedShape);
      }
      if (isLabelObstacle) {
        labelCache.put(transformedShape.getBounds2D());
      }
    }
  }
 else   if (style instanceof IconStyle2D) {
    IconStyle2D icons=(IconStyle2D)style;
    Icon icon=icons.getIcon();
    AffineTransform markAT=new AffineTransform(graphics.getTransform());
    markAT.translate(x,y);
    markAT.rotate(rotation);
    double dx=-icon.getIconWidth() / 2.0;
    double dy=-icon.getIconHeight() / 2.0;
    markAT.translate(dx,dy);
    AffineTransform temp=graphics.getTransform();
    try {
      graphics.setTransform(markAT);
      icon.paintIcon(null,graphics,0,0);
    }
  finally {
      graphics.setTransform(temp);
    }
    if (isLabelObstacle) {
      labelCache.put(new Rectangle2D.Double(x + dx,y + dy,icon.getIconWidth(),icon.getIconHeight()));
    }
  }
}
