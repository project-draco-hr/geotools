{
  for (; ; ) {
    int s=getState();
    if (ranOrCancelled(s)) {
      return;
    }
    if (compareAndSetState(s,COMPLETED)) {
      break;
    }
  }
  exception=t;
  result=null;
  releaseShared(0);
  done();
}
