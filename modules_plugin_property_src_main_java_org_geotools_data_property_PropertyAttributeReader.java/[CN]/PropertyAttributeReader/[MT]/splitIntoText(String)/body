{
  String split[]=new String[type.getAttributeCount()];
  int i=0;
  StringBuilder item=new StringBuilder();
  for (  String str : data.split("\\|",-1)) {
    if (i == type.getAttributeCount()) {
      throw new DataSourceException("format error: expected " + text.length + " attributes, stopped after finding "+ i+ ". ["+ line+ "] split into "+ Arrays.asList(text));
    }
    if (str.endsWith("\\")) {
      item.append(str);
      item.append("|");
    }
 else {
      item.append(str);
      split[i]=item.toString();
      i++;
      item=new StringBuilder();
    }
  }
  if (i < type.getAttributeCount()) {
    throw new DataSourceException("format error: expected " + type.getAttributeCount() + " attributes, but only found "+ i+ ". ["+ line+ "] split into "+ Arrays.asList(text));
  }
  return split;
}
