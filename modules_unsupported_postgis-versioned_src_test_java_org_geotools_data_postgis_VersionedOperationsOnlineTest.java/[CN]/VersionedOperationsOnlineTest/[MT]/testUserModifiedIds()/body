{
  VersionedPostgisDataStore ds=getDataStore();
  String newId=buildRiverHistory();
  String[] modifiedTypes=ds.getModifiedFeatureTypes("1",null);
  assertEquals(1,modifiedTypes.length);
  assertEquals("river",modifiedTypes[0]);
  Transaction ac=Transaction.AUTO_COMMIT;
  ModifiedFeatureIds mfids=ds.getModifiedFeatureFIDs("river","1","5",Filter.INCLUDE,new String[]{"lamb","trout"},ac);
  assertEquals(1,mfids.getCreated().size());
  assertEquals(1,mfids.getDeleted().size());
  assertEquals(1,mfids.getModified().size());
  mfids=ds.getModifiedFeatureFIDs("river","1","2",Filter.INCLUDE,new String[]{"trout"},ac);
  assertEquals(0,mfids.getCreated().size());
  assertEquals(0,mfids.getDeleted().size());
  assertEquals(0,mfids.getModified().size());
  mfids=ds.getModifiedFeatureFIDs("river","1","2",Filter.INCLUDE,new String[]{"lamb"},ac);
  assertEquals(0,mfids.getCreated().size());
  assertEquals(0,mfids.getDeleted().size());
  assertEquals(2,mfids.getModified().size());
  mfids=ds.getModifiedFeatureFIDs("river","1","4",Filter.INCLUDE,new String[]{"trout"},ac);
  assertEquals(0,mfids.getCreated().size());
  assertEquals(0,mfids.getDeleted().size());
  assertEquals(1,mfids.getModified().size());
  assertTrue(mfids.getModified().contains("river.rv2"));
}
