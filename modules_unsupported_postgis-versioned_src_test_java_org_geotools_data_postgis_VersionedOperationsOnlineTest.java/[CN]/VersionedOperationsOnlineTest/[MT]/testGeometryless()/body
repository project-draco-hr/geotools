{
  VersionedPostgisDataStore ds=getDataStore();
  ds.setVersioned("gless",true,"mambo","Trying my luck with a geometryless layer");
  VersioningFeatureStore fs=(VersioningFeatureStore)ds.getFeatureSource("gless");
  SimpleFeatureBuilder fb=new SimpleFeatureBuilder(ds.getSchema("gless"));
  fs.addFeatures(DataUtilities.collection(fb.buildFeature(null,new Object[]{"third",150.3})));
  fs.removeFeatures(ff.equals(ff.property("name"),ff.literal("first")));
  SimpleFeatureCollection fc=fs.getLog("FIRST","LAST",Filter.INCLUDE,null,0);
  assertEquals(2,fc.size());
  Filter firstFilter=ff.equals(ff.property("name"),ff.literal("first"));
  Filter secondFilter=ff.equals(ff.property("name"),ff.literal("second"));
  Query origQuery=new DefaultQuery("gless",ff.or(firstFilter,secondFilter));
  assertEquals(1,fs.getCount(origQuery));
  assertEquals(2,fs.getCount(Query.ALL));
  fs.rollback("FIRST",Filter.INCLUDE,null);
  assertEquals(2,fs.getCount(origQuery));
  assertEquals(2,fs.getCount(Query.ALL));
  ds.setVersioned("gless",false,"mambo","Trying my luck with a geometryless layer");
}
