{
  Statement statement=null;
  ResultSet result=null;
  Integer srid=null;
  try {
    if (schemaName == null)     schemaName="public";
    String sqlStatement="SELECT ref.AUTH_SRID FROM SYSSPATIAL.GEOMETRY_COLUMNS as col, SYSSPATIAL.spatial_ref_sys as ref WHERE " + "col.F_TABLE_SCHEMA = '" + schemaName + "' "+ "AND col.F_TABLE_NAME = '"+ tableName+ "' "+ "AND col.F_GEOMETRY_COLUMN = '"+ columnName+ "' "+ "AND col.SRID = ref.SRID";
    LOGGER.log(Level.FINE,"Geometry srid check; {0} ",sqlStatement);
    statement=cx.createStatement();
    result=statement.executeQuery(sqlStatement);
    if (result.next()) {
      srid=result.getInt(1);
    }
 else {
      dataStore.closeSafe(result);
      sqlStatement="SELECT ref.AUTH_SRID FROM SYSSPATIAL.GEOMETRY_COLUMNS as col, SYSSPATIAL.spatial_ref_sys as ref WHERE " + "col.F_TABLE_NAME = '" + tableName + "' "+ "AND col.F_GEOMETRY_COLUMN = '"+ columnName+ "' "+ "AND col.SRID = ref.SRID";
      result=statement.executeQuery(sqlStatement);
      if (result.next()) {
        srid=result.getInt(1);
      }
    }
  }
  finally {
    dataStore.closeSafe(result);
    dataStore.closeSafe(statement);
  }
  return srid;
}
