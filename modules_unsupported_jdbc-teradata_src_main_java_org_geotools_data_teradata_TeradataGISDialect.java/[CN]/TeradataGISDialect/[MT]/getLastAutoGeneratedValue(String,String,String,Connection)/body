{
  Statement stmt=cx.createStatement();
  try {
    StringBuffer sql=new StringBuffer("SELECT TOP 1 ");
    encodeColumnName(columnName,sql);
    sql.append(" FROM ");
    if (schemaName != null) {
      encodeColumnName(schemaName,sql);
      sql.append(".");
    }
    encodeColumnName(tableName,sql);
    sql.append(" ORDER BY ");
    encodeColumnName(columnName,sql);
    sql.append(" DESC");
    ResultSet resultSet=stmt.executeQuery(sql.toString());
    if (resultSet.next()) {
      int id=resultSet.getInt(1);
      createIndex(id,stmt);
      return id;
    }
 else {
      throw new IllegalStateException("Unable to determine next value in autogenerated sequence.  SQL was: " + sql);
    }
  }
  finally {
    stmt.close();
  }
}
