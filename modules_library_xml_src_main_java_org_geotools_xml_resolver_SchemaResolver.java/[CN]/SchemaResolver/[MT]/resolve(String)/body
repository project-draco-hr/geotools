{
  String resolvedLocation=null;
  if (location.startsWith("file:") || location.startsWith("jar:file:")) {
    resolvedLocation=location;
  }
  if (resolvedLocation == null && catalog != null) {
    resolvedLocation=catalog.resolveLocation(location);
  }
  if (resolvedLocation == null && classpath) {
    resolvedLocation=resolveClasspathLocation(location);
  }
  if (resolvedLocation == null && cache != null) {
    resolvedLocation=cache.resolveLocation(location);
  }
  if (resolvedLocation == null) {
    throw new RuntimeException(String.format("Failed to resolve %s",location));
  }
synchronized (this) {
    if (!resolvedLocationToOriginalLocationMap.containsKey(resolvedLocation)) {
      resolvedLocationToOriginalLocationMap.put(resolvedLocation,location);
    }
  }
  LOGGER.fine(String.format("Resolved %s -> %s",location,resolvedLocation));
  return resolvedLocation;
}
