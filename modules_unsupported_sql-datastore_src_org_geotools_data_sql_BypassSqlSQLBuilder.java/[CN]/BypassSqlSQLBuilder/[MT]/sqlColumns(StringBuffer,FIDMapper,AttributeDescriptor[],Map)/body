{
  String sqlExpression;
  String alias;
  for (int i=0; i < mapper.getColumnCount(); i++) {
    alias=mapper.getColumnName(i);
    sqlExpression=(String)aliases.get(alias);
    sql.append(encoder.escapeName(sqlExpression) + ", ");
  }
  for (int i=0; i < attributes.length; i++) {
    alias=attributes[i].getLocalName();
    sqlExpression=(String)aliases.get(alias);
    String fieldName=sqlExpression;
    if (!alias.equals(sqlExpression)) {
      fieldName+=" AS " + alias;
    }
    if (attributes[i] instanceof GeometryDescriptor) {
      sqlGeometryColumn(sql,attributes[i]);
    }
 else {
      sql.append(encoder.escapeName(fieldName));
    }
    if (i < (attributes.length - 1)) {
      sql.append(", ");
    }
  }
}
