{
  if (sortBy == null || sortBy.length == 0)   return;
  sql.append(" ORDER BY ");
  for (int i=0; i < sortBy.length; i++) {
    final SortBy sortAttribute=sortBy[i];
    if (SortBy.NATURAL_ORDER.equals(sortAttribute) || SortBy.REVERSE_ORDER.equals(sortAttribute)) {
      addOrderByPK(sql,mapper,sortAttribute.getSortOrder());
    }
 else {
      AttributeDescriptor type=(AttributeDescriptor)sortAttribute.getPropertyName().evaluate(ft);
      if (type != null) {
        sql.append(encoder.escapeName(type.getLocalName()));
      }
 else {
        sql.append(encoder.escapeName(sortAttribute.getPropertyName().getPropertyName()));
      }
      if (SortOrder.DESCENDING.equals(sortAttribute.getSortOrder())) {
        sql.append(" DESC");
      }
 else {
        sql.append(" ASC");
      }
    }
    if (i < sortBy.length - 1) {
      sql.append(", ");
    }
  }
}
