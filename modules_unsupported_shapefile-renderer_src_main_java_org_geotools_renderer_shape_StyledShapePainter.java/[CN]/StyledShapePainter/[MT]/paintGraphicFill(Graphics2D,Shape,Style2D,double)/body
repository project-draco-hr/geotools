{
  Rectangle2D boundsShape=shape.getBounds2D();
  Rectangle2D stippleSize=null;
  if (graphicFill instanceof MarkStyle2D) {
    Rectangle2D boundsFill=((MarkStyle2D)graphicFill).getShape().getBounds2D();
    double size=((MarkStyle2D)graphicFill).getSize();
    double aspect=(boundsFill.getHeight() > 0 && boundsFill.getWidth() > 0) ? boundsFill.getWidth() / boundsFill.getHeight() : 1.0;
    stippleSize=new Rectangle2D.Double(0,0,size * aspect,size);
  }
 else   if (graphicFill instanceof IconStyle2D) {
    Icon icon=((IconStyle2D)graphicFill).getIcon();
    stippleSize=new Rectangle2D.Double(0,0,icon.getIconWidth(),icon.getIconHeight());
  }
 else {
    return;
  }
  int nStippleX=(int)Math.ceil(boundsShape.getWidth() / stippleSize.getWidth());
  int nStippleY=(int)Math.ceil(boundsShape.getHeight() / stippleSize.getHeight());
  Graphics2D g=(Graphics2D)graphics.create();
  g.clip(shape);
  Shape clipShape=g.getClip();
  for (int i=0; i < nStippleX; i++) {
    for (int j=0; j < nStippleY; j++) {
      double translateX=boundsShape.getMinX() + i * stippleSize.getWidth();
      double translateY=boundsShape.getMinY() + j * stippleSize.getHeight();
      if (!clipShape.intersects(translateX,translateY,stippleSize.getWidth(),stippleSize.getHeight()))       continue;
      LiteShape2 stippleShape=createStippleShape(stippleSize,translateX,translateY);
      paint(g,stippleShape,graphicFill,scale);
    }
  }
}
