{
  int maxFeatures=0;
  Map<String,Serializable> params=new HashMap<String,Serializable>();
  params.put("dbtype","app-schema");
  URL url=getClass().getResource(TEST_DATA + mappingFile);
  Assert.assertNotNull(url);
  params.put("url",url.toExternalForm());
  DataAccess<FeatureType,Feature> dataAccess=null;
  try {
    dataAccess=DataAccessFinder.getDataStore(params);
    Assert.assertNotNull(dataAccess);
    FeatureType mappedFeatureType=dataAccess.getSchema(MAPPED_FEATURE);
    Assert.assertNotNull(mappedFeatureType);
    FeatureSource<FeatureType,Feature> source=dataAccess.getFeatureSource(MAPPED_FEATURE);
    FeatureCollection<FeatureType,Feature> features=source.getFeatures();
    MappingFeatureCollection mfc=(MappingFeatureCollection)features;
    mfc.getQuery().setMaxFeatures(queryMaxFeatures);
    FeatureIterator<Feature> iterator=features.features();
    maxFeatures=mfc.getQuery().getMaxFeatures();
  }
  finally {
    if (dataAccess != null) {
      dataAccess.dispose();
    }
  }
  return maxFeatures;
}
