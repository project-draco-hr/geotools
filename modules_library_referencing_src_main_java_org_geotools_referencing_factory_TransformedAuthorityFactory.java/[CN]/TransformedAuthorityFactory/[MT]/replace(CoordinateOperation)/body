{
  final CoordinateReferenceSystem oldSrcCRS=operation.getSourceCRS();
  final CoordinateReferenceSystem oldTgtCRS=operation.getTargetCRS();
  final CoordinateReferenceSystem sourceCRS=(oldSrcCRS != null) ? replace(oldSrcCRS) : null;
  final CoordinateReferenceSystem targetCRS=(oldTgtCRS != null) ? replace(oldTgtCRS) : null;
  if (Utilities.equals(oldSrcCRS,sourceCRS) && Utilities.equals(oldTgtCRS,targetCRS)) {
    return operation;
  }
  if (opFactory == null) {
    opFactory=getCoordinateOperationFactory();
  }
  CoordinateOperation modified;
  modified=opFactory.createOperation(sourceCRS,targetCRS);
  modified=(CoordinateOperation)pool.unique(modified);
  return modified;
}
