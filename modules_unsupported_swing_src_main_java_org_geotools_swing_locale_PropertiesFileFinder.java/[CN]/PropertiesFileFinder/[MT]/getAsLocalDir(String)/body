{
  int pos=path.lastIndexOf(File.separatorChar);
  File file=new File(path.substring(0,pos));
  if (!file.exists() || !file.isDirectory()) {
    throw new IllegalArgumentException("Invalid directory path: " + file);
  }
  return file;
}
