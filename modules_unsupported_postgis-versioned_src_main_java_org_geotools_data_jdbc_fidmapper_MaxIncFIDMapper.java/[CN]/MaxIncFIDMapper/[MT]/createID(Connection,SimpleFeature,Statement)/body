{
  Statement stmt=null;
  ResultSet rs=null;
  try {
    stmt=conn.createStatement();
    rs=stmt.executeQuery("Select MAX(" + getColumnName() + ") from "+ tableName);
    if (rs.next()) {
      long maxFid=rs.getLong(1);
      return String.valueOf(maxFid + 1);
    }
 else {
      throw new DataSourceException("Could not get MAX for " + tableName + "."+ getColumnName()+ ": No result returned from query");
    }
  }
 catch (  SQLException e) {
    throw new DataSourceException("An sql problem occurred. Are the table and the fid column there?",e);
  }
 finally {
    if (stmt != null) {
      try {
        stmt.close();
      }
 catch (      SQLException e) {
        LOGGER.log(Level.WARNING,"MaxIncFidMapper could not close statement:" + e,e);
      }
    }
    if (rs != null) {
      try {
        rs.close();
      }
 catch (      SQLException e) {
        LOGGER.log(Level.WARNING,"MaxIncFidMapper could not close resultset:" + e,e);
      }
    }
  }
}
