{
  String host=(String)HOST.lookUp(params);
  Integer port=(Integer)PORT.lookUp(params);
  String instance=(String)INSTANCE.lookUp(params);
  String user=(String)USER.lookUp(params);
  String passwd=(String)PASSWD.lookUp(params);
  String schema=(String)SCHEMA.lookUp(params);
  String namespace=(String)NAMESPACE.lookUp(params);
  String dbtype=(String)DBTYPE.lookUp(params);
  Integer maxConn=(Integer)MAXCONN.lookUp(params);
  Integer minConn=(Integer)MINCONN.lookUp(params);
  Boolean validateConn=(Boolean)VALIDATECONN.lookUp(params);
  if (!"oracle".equals(dbtype)) {
    throw new IOException("Parameter 'dbtype' must be oracle");
  }
  if (!canProcess(params)) {
    throw new IOException("Cannot connect using provided parameters");
  }
  boolean validate=validateConn != null && validateConn.booleanValue();
  int maxActive=maxConn != null ? maxConn.intValue() : 10;
  int maxIdle=minConn != null ? minConn.intValue() : 4;
  DataSource source=getDefaultDataSource(host,user,passwd,port.intValue(),instance,maxActive,maxIdle,validate);
  OracleDataStore dataStore=new OracleDataStore(source,namespace,schema,new HashMap());
  return dataStore;
}
