{
  String propertiesName=identifier + ".properties";
  Properties properties=new Properties();
  String propertiesFileName=System.getProperty(propertiesName);
  if (propertiesFileName == null) {
    String propertiesResourceName="/" + propertiesName;
    InputStream stream=InterpolationProperties.class.getResourceAsStream(propertiesResourceName);
    if (stream != null) {
      try {
        LOGGER.info("Loading properties from classpath resource " + propertiesResourceName);
        properties.load(new BufferedInputStream(stream));
      }
 catch (      Exception e) {
        throw new RuntimeException("Error loading properties from classpath resource " + propertiesResourceName,e);
      }
 finally {
        try {
          stream.close();
        }
 catch (        Exception e) {
        }
      }
    }
  }
 else {
    File propertiesFile=new File(propertiesFileName).getAbsoluteFile();
    try {
      propertiesFile=propertiesFile.getCanonicalFile();
    }
 catch (    IOException e) {
      LOGGER.log(Level.WARNING,"An error occurred while trying to construct the canonical path" + " for properties file " + propertiesFile.toString(),e);
    }
    InputStream stream=null;
    try {
      stream=new BufferedInputStream(new FileInputStream(propertiesFile));
      LOGGER.info("Loading properties file " + propertiesFile.toString());
      properties.load(stream);
    }
 catch (    Exception e) {
      throw new RuntimeException("Error loading properties file " + propertiesFile.toString(),e);
    }
 finally {
      if (stream != null) {
        try {
          stream.close();
        }
 catch (        Exception e) {
        }
      }
    }
  }
  properties.putAll(System.getProperties());
  return properties;
}
