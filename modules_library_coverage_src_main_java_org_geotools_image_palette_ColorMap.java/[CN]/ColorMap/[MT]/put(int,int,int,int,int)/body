{
  if (value < 0) {
    throw new IllegalArgumentException("By contract only positive numbers can be used");
  }
  int color=color(r,g,b,a);
  int index=indexFor(hash(color),table.length);
  accessCount++;
  for (ColorEntry e=table[index]; e != null; e=e.next) {
    scanCount++;
    if (e.color == color) {
      int oldValue=e.value;
      e.value=value;
      return oldValue;
    }
  }
  addEntry(color,value,index);
  return -1;
}
