{
  if (geometry instanceof GeometryCollection && geometry.getNumGeometries() == 1) {
    geometry=geometry.getGeometryN(0);
  }
  Geometry result;
  try {
    result=geometry.intersection(mask);
  }
 catch (  Exception e1) {
    try {
      result=EnhancedPrecisionOp.intersection(geometry,mask);
    }
 catch (    Exception e2) {
      result=geometry;
    }
  }
  if (result.isEmpty() && geometry.intersects(mask)) {
    try {
      result=EnhancedPrecisionOp.intersection(geometry,mask);
    }
 catch (    Exception e2) {
      result=geometry;
    }
  }
  if (result.isEmpty()) {
    return null;
  }
 else {
    return result;
  }
}
