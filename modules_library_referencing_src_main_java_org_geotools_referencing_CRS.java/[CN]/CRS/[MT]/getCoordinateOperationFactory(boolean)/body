{
  CoordinateOperationFactory factory=(lenient) ? lenientFactory : strictFactory;
  if (factory == null) {
    final Hints hints=GeoTools.getDefaultHints();
    if (lenient) {
      hints.put(Hints.LENIENT_DATUM_SHIFT,Boolean.TRUE);
    }
    factory=ReferencingFactoryFinder.getCoordinateOperationFactory(hints);
    if (lenient) {
      lenientFactory=factory;
    }
 else {
      strictFactory=factory;
    }
  }
  return factory;
}
