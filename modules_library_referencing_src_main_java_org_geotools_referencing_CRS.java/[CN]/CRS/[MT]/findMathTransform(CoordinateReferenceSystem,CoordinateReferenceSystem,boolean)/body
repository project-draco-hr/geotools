{
  if (equalsIgnoreMetadata(sourceCRS,targetCRS)) {
    return IdentityTransform.create(sourceCRS.getCoordinateSystem().getDimension());
  }
  CoordinateOperationFactory operationFactory=getCoordinateOperationFactory(lenient);
  return operationFactory.createOperation(sourceCRS,targetCRS).getMathTransform();
}
