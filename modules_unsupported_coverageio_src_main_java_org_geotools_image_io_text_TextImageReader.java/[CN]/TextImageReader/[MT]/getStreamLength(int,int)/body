{
  long length=getStreamLength();
  if (length > 0) {
    final int numImages=getNumImages(false);
    if (numImages > 0) {
      if (toImage == -1) {
        toImage=numImages;
      }
      if (fromImage < 0 || fromImage > numImages) {
        throw new IndexOutOfBoundsException(String.valueOf(fromImage));
      }
      if (toImage < 0 || toImage > numImages) {
        throw new IndexOutOfBoundsException(String.valueOf(toImage));
      }
      if (fromImage > toImage) {
        throw new IllegalArgumentException();
      }
      return length * (toImage - fromImage) / numImages;
    }
  }
  return length;
}
