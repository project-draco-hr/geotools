{
  HashMap<Key,Object> hints=new HashMap<>();
  hints.put(Hints.ENTITY_RESOLVER,PreventLocalEntityResolver.INSTANCE);
  SVGGraphicFactory svg=new SVGGraphicFactory(hints);
  try {
    URL url=SVGGraphicFactory.class.getResource("attack.svg");
    Icon icon=svg.getIcon(null,ff.literal(url),"image/svg",20);
    fail("expected entity resolution exception");
  }
 catch (  Exception e) {
    assertEquals(e.getMessage(),"Entity resolution disallowed for file:///etc/passwd");
  }
  hints=new HashMap<>();
  hints.put(Hints.ENTITY_RESOLVER,NullEntityResolver.INSTANCE);
  svg=new SVGGraphicFactory(hints);
  URL url=SVGGraphicFactory.class.getResource("attack.svg");
  Icon icon=svg.getIcon(null,ff.literal(url),"image/svg",20);
  assertNotNull(icon);
}
