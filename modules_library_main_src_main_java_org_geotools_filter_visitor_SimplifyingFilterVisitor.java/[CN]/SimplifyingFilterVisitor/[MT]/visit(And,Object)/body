{
  List<Filter> newChildren=new ArrayList<Filter>(filter.getChildren().size());
  for (  Filter child : filter.getChildren()) {
    Filter cloned=(Filter)child.accept(this,extraData);
    if (cloned == Filter.EXCLUDE)     return Filter.EXCLUDE;
    if (cloned == Filter.INCLUDE)     continue;
    newChildren.add(cloned);
  }
  if (newChildren.size() == 0)   return Filter.INCLUDE;
  if (newChildren.size() == 1)   return newChildren.get(0);
  return getFactory(extraData).and(newChildren);
}
