{
  JPanel content=new JPanel(new BorderLayout());
  this.setContentPane(content);
  this.setTitle("ImageAssert");
  String message;
  if (expected.getWidth() != actual.getWidth() || expected.getHeight() != actual.getHeight()) {
    message="Image sizes are different, expected " + expected.getWidth() + "x"+ expected.getHeight()+ " but actual is "+ actual.getWidth()+ "x"+ actual.getHeight();
  }
 else {
    message="The two images are perceptibly different.";
  }
  final JLabel topLabel=new JLabel("<html><body>" + message + "</html></body>");
  topLabel.setBorder(new EmptyBorder(4,4,4,4));
  content.add(topLabel,BorderLayout.NORTH);
  JPanel central=new JPanel(new GridLayout(1,2));
  central.add(titledImagePanel("Expected",expected));
  central.add(titledImagePanel("Actual",actual));
  content.add(central);
  JPanel commands=new JPanel(new FlowLayout(FlowLayout.RIGHT));
  JButton accept=new JButton("Overwrite reference");
  accept.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      CompareImageDialog.this.accept=true;
      CompareImageDialog.this.setVisible(false);
    }
  }
);
  JButton reject=new JButton("Images are different");
  reject.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      CompareImageDialog.this.accept=false;
      CompareImageDialog.this.setVisible(false);
    }
  }
);
  commands.add(accept);
  commands.add(reject);
  commands.setVisible(showCommands);
  content.add(commands,BorderLayout.SOUTH);
  pack();
}
