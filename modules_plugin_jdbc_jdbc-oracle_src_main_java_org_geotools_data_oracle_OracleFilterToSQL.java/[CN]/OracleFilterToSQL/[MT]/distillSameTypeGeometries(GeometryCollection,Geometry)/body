{
  if (original instanceof Polygon || original instanceof MultiPolygon) {
    List<Polygon> polys=new ArrayList<Polygon>();
    accumulateGeometries(polys,coll,Polygon.class);
    return original.getFactory().createMultiPolygon(((Polygon[])polys.toArray(new Polygon[polys.size()])));
  }
 else   if (original instanceof LineString || original instanceof MultiLineString) {
    List<LineString> ls=new ArrayList<LineString>();
    accumulateGeometries(ls,coll,LineString.class);
    return original.getFactory().createMultiLineString((LineString[])ls.toArray(new LineString[ls.size()]));
  }
 else   if (original instanceof Point || original instanceof MultiPoint) {
    List<LineString> points=new ArrayList<LineString>();
    accumulateGeometries(points,coll,LineString.class);
    return original.getFactory().createMultiPoint((Point[])points.toArray(new Point[points.size()]));
  }
 else {
    return original;
  }
}
