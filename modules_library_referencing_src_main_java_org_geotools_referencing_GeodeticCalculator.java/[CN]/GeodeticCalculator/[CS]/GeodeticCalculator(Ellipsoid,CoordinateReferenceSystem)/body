{
  if (ellipsoid == null) {
    throw new IllegalArgumentException(Errors.format(ErrorKeys.NULL_ARGUMENT_$1,"ellipsoid"));
  }
  this.ellipsoid=ellipsoid;
  semiMajorAxis=ellipsoid.getSemiMajorAxis();
  flattening=1 / ellipsoid.getInverseFlattening();
  geod=new Geodesic(semiMajorAxis,flattening);
  if (crs != null) {
    coordinateReferenceSystem=crs;
    geographicCRS=getGeographicCRS(crs);
    userToGeodetic=new TransformedDirectPosition(crs,geographicCRS,null);
  }
 else {
    userToGeodetic=null;
  }
}
