{
  final int TABLE_NAME=3;
  final int COLUMN_NAME=4;
  final int DATA_TYPE=5;
  final int TYPE_NAME=6;
  try {
    int dataType=rs.getInt(DATA_TYPE);
    if (dataType == Types.OTHER || dataType == Types.BINARY) {
      String typeName=rs.getString(TYPE_NAME);
      AttributeTypeBuilder builder=new AttributeTypeBuilder();
      Class geom=getGeomClass(typeName);
      if (geom == null) {
        return super.buildAttributeType(rs);
      }
      builder.setBinding(geom);
      int srid=determineSRID(rs.getString(TABLE_NAME),rs.getString(COLUMN_NAME));
      CoordinateReferenceSystem crs=null;
      try {
        crs=CRS.decode("EPSG:" + srid);
      }
 catch (      Exception e) {
        crs=null;
      }
      builder.setCRS(crs);
      builder.setNillable(true);
      builder.setName(rs.getString(COLUMN_NAME));
      return builder.buildDescriptor(rs.getString(COLUMN_NAME));
    }
 else {
      return super.buildAttributeType(rs);
    }
  }
 catch (  SQLException e) {
    throw new IOException("SQL exception occurred: " + e.getMessage());
  }
}
