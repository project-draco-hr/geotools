{
  try {
    ReferencedEnvelope re=new ReferencedEnvelope(new Envelope(0,10,0,10),CRS.decode("EPSG:2927",true));
    int tenMetersPixels=(int)Math.round(10 / 0.00028);
    RendererUtilities.SCALE_UNIT_COMPENSATION=false;
    double scale=RendererUtilities.calculateOGCScale(re,tenMetersPixels,new HashMap());
    assertEquals(1,scale,0.0001);
    RendererUtilities.SCALE_UNIT_COMPENSATION=true;
    scale=RendererUtilities.calculateOGCScale(re,tenMetersPixels,new HashMap());
    assertEquals(0.304803,scale,0.0001);
  }
  finally {
    RendererUtilities.SCALE_UNIT_COMPENSATION=true;
  }
}
