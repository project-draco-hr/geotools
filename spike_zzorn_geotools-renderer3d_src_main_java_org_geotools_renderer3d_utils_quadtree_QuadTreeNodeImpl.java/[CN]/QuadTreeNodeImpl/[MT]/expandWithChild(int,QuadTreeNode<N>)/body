{
  checkNodeIsAttached();
  if (!myExpanded) {
    myExpanded=true;
    if (myChildren == null) {
      myChildren=new QuadTreeNode[NUMBER_OF_SUBNODES];
    }
    for (int i=0; i < NUMBER_OF_SUBNODES; i++) {
      if (myChildren[i] != null) {
        throw new IllegalStateException("A newly expanded node should not have any children");
      }
      if (i == childSubquadrant) {
        myChildren[i]=childNode;
      }
 else {
        final BoundingRectangle rectangle=myBoundingRectangle.createSubquadrantBoundingRectangle(i);
        myChildren[i]=myQuadTree.createQuadTreeNode(rectangle,this);
      }
    }
    for (int i=0; i < myChildren.length; i++) {
      if (i != childSubquadrant) {
        myQuadTree.initnodedata(myChildren[i]);
      }
    }
    for (    NodeListener<N> nodeListener : myNodeListeners) {
      nodeListener.onExpanded(this);
    }
  }
}
