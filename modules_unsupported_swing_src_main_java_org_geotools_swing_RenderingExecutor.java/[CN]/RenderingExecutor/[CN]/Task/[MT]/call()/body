{
  if (!cancelled) {
    GTRenderer renderer=mapPane.getRenderer();
    try {
      renderer.addRenderListener(this);
      Rectangle drawingArea=mapContent.getViewport().getScreenArea();
      Composite composite=graphics.getComposite();
      graphics.setComposite(AlphaComposite.getInstance(AlphaComposite.CLEAR,0.0f));
      graphics.fill(drawingArea);
      graphics.setComposite(composite);
      numFeatures=0;
      renderer.paint(graphics,drawingArea,mapContent.getViewport().getBounds(),mapContent.getViewport().getWorldToScreen());
    }
  finally {
      renderer.removeRenderListener(this);
    }
  }
  if (cancelled) {
    return TaskResult.CANCELLED;
  }
 else   if (failed) {
    return TaskResult.FAILED;
  }
 else {
    return TaskResult.COMPLETED;
  }
}
