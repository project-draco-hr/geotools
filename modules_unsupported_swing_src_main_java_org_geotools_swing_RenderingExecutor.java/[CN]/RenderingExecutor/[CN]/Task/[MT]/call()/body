{
  if (!cancelled) {
    GTRenderer renderer=mapPane.getRenderer();
    try {
      renderer.addRenderListener(this);
      Composite composite=graphics.getComposite();
      graphics.setComposite(AlphaComposite.getInstance(AlphaComposite.CLEAR,0.0f));
      graphics.fill(paintArea);
      graphics.setComposite(composite);
      numFeatures=0;
      renderer.paint(graphics,mapPane.getVisibleRect(),envelope,mapPane.getWorldToScreenTransform());
    }
  finally {
      renderer.removeRenderListener(this);
    }
  }
  if (cancelled) {
    return TaskResult.CANCELLED;
  }
 else   if (failed) {
    return TaskResult.FAILED;
  }
 else {
    return TaskResult.COMPLETED;
  }
}
