{
  final String TYPE_NAME="hospitals";
  WFS_1_0_0_DataStore ds;
  int totalFeatures;
  URL host=new URL("http://mapserver.refractions.net/cgi-bin/mapserv48?map=/home/www/mapserv/maps/victoria-wms.map&SERVICE=WFS&VERSION=1.0.0&REQUEST=GetCapabilities");
  WFSDataStoreFactory dsfac=new WFSDataStoreFactory();
  Map params=new HashMap();
  params.put(WFSDataStoreFactory.URL.key,host);
  params.put(WFSDataStoreFactory.TIMEOUT.key,10000);
  params.put(WFSDataStoreFactory.BUFFER_SIZE.key,100);
  params.put(WFSDataStoreFactory.TRY_GZIP.key,Boolean.TRUE);
  params.put(WFSDataStoreFactory.LENIENT.key,Boolean.TRUE);
  ds=(WFS_1_0_0_DataStore)dsfac.createDataStore(params);
  assertTrue(ds.strategy instanceof MapServerWFSStrategy);
  FilterFactory fac=FilterFactoryFinder.createFilterFactory();
  GeometryFilter filter=fac.createGeometryFilter(FilterType.GEOMETRY_BBOX);
  String attName=ds.getSchema(TYPE_NAME).getGeometryDescriptor().getLocalName();
  filter.addLeftGeometry(fac.createAttributeExpression(attName));
  filter.addRightGeometry(fac.createBBoxExpression(ds.getBounds(new DefaultQuery(TYPE_NAME))));
  Query query=new DefaultQuery(TYPE_NAME,filter);
  SimpleFeatureCollection features=ds.getFeatureSource(TYPE_NAME).getFeatures(query);
  SimpleFeatureIterator iter=features.features();
  try {
    int count=0;
    while (iter.hasNext()) {
      iter.next();
      count++;
    }
    totalFeatures=count;
  }
  finally {
    iter.close();
  }
  SimpleFeatureSource source=ds.getFeatureSource(TYPE_NAME);
  SimpleFeatureCollection reader=source.getFeatures(Query.ALL);
  assertCorrectSize(reader,totalFeatures);
  reader=source.getFeatures(Filter.NONE);
  assertCorrectSize(reader,totalFeatures);
  reader=source.getFeatures(new DefaultQuery(TYPE_NAME,Filter.NONE));
  assertCorrectSize(reader,totalFeatures);
}
