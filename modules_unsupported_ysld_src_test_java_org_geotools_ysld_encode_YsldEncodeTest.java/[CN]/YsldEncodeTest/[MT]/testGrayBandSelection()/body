{
  StyleFactory factory=CommonFactoryFinder.getStyleFactory();
  RasterSymbolizer r=factory.createRasterSymbolizer();
  ChannelSelection sel=factory.channelSelection(factory.createSelectedChannelType("foo",factory.createContrastEnhancement()));
  r.setChannelSelection(sel);
  StringWriter out=new StringWriter();
  Ysld.encode(sld(r),out);
  YamlMap obj=new YamlMap(new Yaml().load(out.toString()));
  YamlMap channelMap=obj.seq("feature-styles").map(0).seq("rules").map(0).seq("symbolizers").map(0).map("raster").map("channels");
  assertThat(channelMap,yHasEntry("gray"));
  assertThat(channelMap,not(yHasEntry("red")));
  assertThat(channelMap,not(yHasEntry("green")));
  assertThat(channelMap,not(yHasEntry("blue")));
  assertThat(channelMap.map("gray"),yHasEntry("name",equalTo("foo")));
  assertThat(channelMap.map("gray"),not(yHasEntry("contrast-enhancement")));
}
