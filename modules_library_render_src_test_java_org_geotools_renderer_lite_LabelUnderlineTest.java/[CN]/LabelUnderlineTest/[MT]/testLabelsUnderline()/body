{
  File property=new File(TestData.getResource(this,"nonStraightLines.properties").toURI());
  PropertyDataStore dataStore=new PropertyDataStore(property.getParentFile());
  SimpleFeatureSource featureSource=dataStore.getFeatureSource("nonStraightLines");
  ReferencedEnvelope bounds=featureSource.getBounds();
  bounds.expandBy(1,1);
  Style style=RendererBaseTest.loadStyle(this,"underlineStyle.sld");
  MapContent mapContent=new MapContent();
  mapContent.addLayer(new FeatureLayer(featureSource,style));
  StreamingRenderer renderer=new StreamingRenderer();
  renderer.setMapContent(mapContent);
  renderer.setJava2DHints(new RenderingHints(KEY_ANTIALIASING,VALUE_ANTIALIAS_ON));
  BufferedImage image=new BufferedImage(1000,1000,BufferedImage.TYPE_3BYTE_BGR);
  Graphics2D graphics=image.createGraphics();
  graphics.setColor(Color.LIGHT_GRAY);
  graphics.fillRect(0,0,image.getWidth(),image.getHeight());
  renderer.paint(graphics,new Rectangle(0,0,image.getWidth(),image.getHeight()),bounds);
  File reference=new File("./src/test/resources/org/geotools/renderer/lite/test-data/underlineStyle.sld.png");
  ImageAssert.assertEquals(reference,image,3000);
}
