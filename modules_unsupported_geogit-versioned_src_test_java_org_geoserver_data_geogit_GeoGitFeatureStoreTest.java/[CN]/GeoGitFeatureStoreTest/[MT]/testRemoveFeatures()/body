{
  insertAndAdd(lines1,lines2,lines3,points1,points2,points3);
  new GeoGIT(repo).commit().call();
  Id filter=ff.id(Collections.singleton(ff.featureId(idP1)));
  Transaction tx=new DefaultTransaction();
  points.setTransaction(tx);
  try {
    assertEquals(3,points.getFeatures().size());
    points.removeFeatures(filter);
    assertEquals(2,points.getFeatures().size());
    assertEquals(3,dataStore.getFeatureSource(pointsTypeName).getFeatures().size());
    tx.commit();
    assertEquals(2,dataStore.getFeatureSource(pointsTypeName).getFeatures().size());
  }
 catch (  Exception e) {
    tx.rollback();
    throw e;
  }
 finally {
    tx.close();
  }
  assertEquals(2,points.getFeatures().size());
  assertEquals(0,points.getFeatures(filter).size());
}
