{
  URL url=getClass().getResource("foo.jar");
  assertNotNull(url);
  FactoryRegistry reg=new FactoryCreator(DummyInterface.class);
  Iterator it=reg.getServiceProviders(DummyInterface.class,false);
  assertFalse(it.hasNext());
  URLClassLoader cl=new URLClassLoader(new URL[]{url});
  GeoTools.addClassLoader(cl);
  reg.scanForPlugins();
  it=reg.getServiceProviders(DummyInterface.class,false);
  Set<String> classes=new HashSet<String>();
  while (it.hasNext()) {
    classes.add(it.next().getClass().getName());
  }
  assertEquals(2,classes.size());
  assertTrue(classes.contains("pkg.Foo"));
  assertTrue(classes.contains("org.geotools.factory.DummyInterfaceImpl"));
}
