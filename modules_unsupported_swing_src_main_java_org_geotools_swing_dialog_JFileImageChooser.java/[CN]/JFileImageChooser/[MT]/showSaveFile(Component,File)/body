{
  JFileImageChooser chooser=new JFileImageChooser(workingDir);
  chooser.setFilter(supportedWriters);
  chooser.setDialogTitle("Save image");
  File file=null;
  if (chooser.showSaveDialog(parent) == JFileImageChooser.APPROVE_OPTION) {
    file=chooser.getSelectedFile();
    String name=file.getAbsolutePath();
    int dot=name.lastIndexOf('.');
    FormatFilter filter=(FormatFilter)chooser.getFileFilter();
    if (dot < 0) {
      name=name + filter.getDefaultSuffix();
      file=new File(name);
    }
  }
  return file;
}
