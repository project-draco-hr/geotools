{
  String[] names=query.getPropertyNames();
  if ((names == null) || query.retrieveAllProperties()) {
    String typeName=query.getTypeName();
    SimpleFeatureType schema=getSchema(typeName);
    names=new String[schema.getAttributeCount()];
    for (int i=0; i < schema.getAttributeCount(); i++) {
      names[i]=schema.getDescriptor(i).getLocalName();
    }
  }
  return names;
}
