{
  SimpleFeatureIterator it=features();
  try {
    Exception exception=null;
    while (it.hasNext()) {
      try {
        visitor.visit(it.next());
      }
 catch (      Exception e) {
        if (exception != null)         exception=e;
      }
    }
    if (exception != null) {
      if (exception instanceof RuntimeException) {
        throw (RuntimeException)exception;
      }
 else {
        throw new RuntimeException(exception);
      }
    }
  }
  finally {
    close(it);
  }
}
