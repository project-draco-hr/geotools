{
  if (rank > 2) {
    if (rank == 3) {
      return index;
    }
 else {
      return (int)Math.ceil(index / UnidataUtilities.getZDimensionLength(variableDS));
    }
  }
  return -1;
}
