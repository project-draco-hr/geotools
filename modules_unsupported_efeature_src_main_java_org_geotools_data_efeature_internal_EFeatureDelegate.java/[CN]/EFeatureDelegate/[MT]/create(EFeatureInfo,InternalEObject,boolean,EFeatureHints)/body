{
  EFeatureDelegate eDelegate;
  if (eHints.eSingletonFeatures()) {
    eDelegate=eSingleton.get();
    if (eDelegate == null) {
      eDelegate=new EFeatureDelegate(eStructure,eImpl,eTrusted,eHints);
      eSingleton.set(eDelegate);
    }
 else     if (eImpl instanceof EFeatureDelegate) {
      eDelegate=(EFeatureDelegate)eImpl;
      eDelegate.eReplace(eStructure,eDelegate.eImpl,false,eHints);
    }
 else {
      eDelegate.eReplace(eStructure,eImpl,eTrusted,eHints);
    }
  }
 else   if (eImpl instanceof EFeatureDelegate) {
    eDelegate=(EFeatureDelegate)eImpl;
    eDelegate.eReplace(eStructure,eDelegate.eImpl,false,eHints);
  }
 else {
    eDelegate=new EFeatureDelegate(eStructure,eImpl,eTrusted,eHints);
  }
  String eSetID=eDelegate.getID();
  EFeatureIDFactory eIDFactory=eStructure.eContext().eIDFactory();
  if (!(eSetID == null || eSetID.length() == 0)) {
    eIDFactory.useID(eDelegate,eSetID);
  }
 else {
    eSetID=eIDFactory.createID(eDelegate);
  }
  return eDelegate;
}
