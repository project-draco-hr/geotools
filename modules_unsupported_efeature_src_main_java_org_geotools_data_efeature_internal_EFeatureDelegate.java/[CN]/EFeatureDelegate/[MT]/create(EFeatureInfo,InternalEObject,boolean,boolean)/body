{
  EFeatureDelegate eDelegate;
  if (eSingletonFeatures) {
    eDelegate=eSingleton.get();
    if (eDelegate == null) {
      eDelegate=EFeatureDelegate.create(eStructure,(InternalEObject)eImpl,eTrusted,false);
      eSingleton.set(eDelegate);
    }
 else     if (eImpl instanceof EFeatureDelegate) {
      eDelegate=(EFeatureDelegate)eImpl;
      eDelegate.setStructure(eStructure);
      eSingleton.set(eDelegate);
    }
 else {
      eDelegate.eReplace(eStructure,(InternalEObject)eImpl,eTrusted);
    }
  }
 else {
    eDelegate=new EFeatureDelegate(eStructure,eImpl,eTrusted);
  }
  String eSetID=eDelegate.getID();
  EFeatureIDFactory eIDFactory=eStructure.eContext().eIDFactory();
  if (!(eSetID == null || eSetID.length() == 0)) {
    eIDFactory.useID(eDelegate,eSetID);
  }
 else {
    eSetID=eIDFactory.createID(eDelegate);
  }
  return eDelegate;
}
