{
  URL schemaURL=getClass().getResource(schemaBase);
  File dir;
  try {
    dir=new File(schemaURL.toURI());
  }
 catch (  URISyntaxException e) {
    throw new RuntimeException(e);
  }
  PropertyDataStore dataStore=new PropertyDataStore(dir);
  SimpleFeatureSource simpleFeatureSource=dataStore.getFeatureSource(GEOLOGIC_UNIT);
  SimpleFeatureCollection fCollection=simpleFeatureSource.getFeatures();
  reader=EmfAppSchemaReader.newInstance();
  SchemaIndex schemaIndex=reader.parse(new URL("http://www.geosciml.org/geosciml/2.0/xsd/geosciml.xsd"));
  typeRegistry=new FeatureTypeRegistry();
  typeRegistry.addSchemas(schemaIndex);
  FeatureType simpleType=(FeatureType)typeRegistry.getAttributeType(GEOLOGIC_UNIT_TYPE);
  inputFeatures=getInputFeatures(fCollection,simpleType);
  FeatureType guSchema=new FeatureTypeImpl(GEOLOGIC_UNIT,simpleType.getDescriptors(),null,true,simpleType.getRestrictions(),GMLSchema.ABSTRACTFEATURETYPE_TYPE,null);
  return new InputDataAccess(inputFeatures,guSchema,FeatureChainingTest.GEOLOGIC_UNIT_NAME);
}
