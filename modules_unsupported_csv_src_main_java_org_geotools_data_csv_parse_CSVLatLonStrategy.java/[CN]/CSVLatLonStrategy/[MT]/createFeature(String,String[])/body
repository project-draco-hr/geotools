{
  SimpleFeatureType featureType=getFeatureType();
  SimpleFeatureBuilder builder=new SimpleFeatureBuilder(featureType);
  GeometryDescriptor geometryDescriptor=featureType.getGeometryDescriptor();
  GeometryFactory geometryFactory=new GeometryFactory();
  Double x=null, y=null;
  String[] headers=csvFileState.getCSVHeaders();
  for (int i=0; i < headers.length; i++) {
    String header=headers[i];
    if (i < csvRecord.length) {
      String value=csvRecord[i].trim();
      if (geometryDescriptor != null && isLatitude(header)) {
        y=Double.valueOf(value);
      }
 else       if (geometryDescriptor != null && isLongitude(header)) {
        x=Double.valueOf(value);
      }
 else {
        builder.set(header,value);
      }
    }
 else {
      builder.set(header,null);
    }
  }
  if (x != null && y != null && geometryDescriptor != null) {
    Coordinate coordinate=new Coordinate(x,y);
    Point point=geometryFactory.createPoint(coordinate);
    builder.set(geometryDescriptor.getLocalName(),point);
  }
  return builder.buildFeature(csvFileState.getTypeName() + "-" + recordId);
}
