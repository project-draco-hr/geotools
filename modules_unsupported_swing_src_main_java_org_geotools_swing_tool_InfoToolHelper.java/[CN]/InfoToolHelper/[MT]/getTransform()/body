{
  if (transform == null && !transformFailed && dataCRS != null) {
    MapContent content=getMapContent();
    if (content == null) {
      throw new IllegalStateException("null map content");
    }
    CoordinateReferenceSystem contentCRS=content.getCoordinateReferenceSystem();
    try {
      transform=CRS.findMathTransform(contentCRS,dataCRS,true);
    }
 catch (    Exception ex) {
      LOGGER.warning("Can't transform map content to layer CRS");
      transformFailed=true;
    }
  }
  return transform;
}
