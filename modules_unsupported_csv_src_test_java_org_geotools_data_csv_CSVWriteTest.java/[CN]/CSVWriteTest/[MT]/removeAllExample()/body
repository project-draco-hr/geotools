{
  Map<String,Serializable> params=new HashMap<String,Serializable>();
  params.put("file",file);
  DataStore store=DataStoreFinder.getDataStore(params);
  Transaction t=new DefaultTransaction("locations");
  try {
    FeatureWriter<SimpleFeatureType,SimpleFeature> writer=store.getFeatureWriter("locations",Filter.INCLUDE,t);
    try {
      while (writer.hasNext()) {
        writer.next();
        writer.remove();
      }
    }
  finally {
      writer.close();
    }
    SimpleFeatureStore featureStore=(SimpleFeatureStore)store.getFeatureSource("locations");
    assertEquals("featureStore should be empty",0,featureStore.getFeatures().size());
    assertEquals("file should have no content","",checkFileContents(file));
    t.commit();
  }
 catch (  Throwable eek) {
    t.rollback();
  }
 finally {
    t.close();
    store.dispose();
  }
}
