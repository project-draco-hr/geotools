{
  int width=Math.max((int)Math.floor(Math.log10(maximum)) + 1,format.getMinimumIntegerDigits());
  int digits=Math.min(format.getMaximumFractionDigits(),MAXIMUM_DIGITS);
  if (format instanceof DecimalFormat) {
    final DecimalFormat decimal=(DecimalFormat)format;
    if (digits > 0 || decimal.isDecimalSeparatorAlwaysShown()) {
      width++;
    }
    width+=Math.max(decimal.getNegativePrefix().length(),decimal.getPositivePrefix().length());
    digits+=Math.max(decimal.getNegativeSuffix().length(),decimal.getPositiveSuffix().length());
  }
  final FieldPosition position=new FieldPosition(NumberFormat.FRACTION_FIELD);
  position.setBeginIndex(width);
  position.setEndIndex(width+=digits);
  return position;
}
