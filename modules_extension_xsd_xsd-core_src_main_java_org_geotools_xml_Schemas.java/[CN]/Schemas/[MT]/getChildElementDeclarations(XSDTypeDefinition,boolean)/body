{
  List particles=getChildElementParticles(type,includeParents);
  List elements=new ArrayList();
  for (Iterator p=particles.iterator(); p.hasNext(); ) {
    XSDParticle particle=(XSDParticle)p.next();
    XSDElementDeclaration decl=(XSDElementDeclaration)particle.getContent();
    if (decl.isElementDeclarationReference()) {
      decl=decl.getResolvedElementDeclaration();
    }
    elements.add(decl);
  }
  return elements;
}
