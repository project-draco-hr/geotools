{
  ColorMapUtilities.ensureNonNull("RasterSymbolizer",rs);
  final ChannelSelectionNode csNode=new ChannelSelectionNode();
  final ColorMapNode cmNode=new ColorMapNode(this.getHints());
  final ContrastEnhancementNode ceNode=new ContrastEnhancementNode(this.getHints());
  setSink(ceNode);
  final ChannelSelection cs=rs.getChannelSelection();
  csNode.addSource(this.getSource(0));
  csNode.addSink(cmNode);
  csNode.visit(cs);
  final ColorMap cm=rs.getColorMap();
  cmNode.addSource(csNode);
  csNode.addSink(cmNode);
  cmNode.visit(cm);
  final ContrastEnhancement ce=rs.getContrastEnhancement();
  ceNode.addSource(cmNode);
  cmNode.addSink(ceNode);
  ceNode.visit(ce);
}
