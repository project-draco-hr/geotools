{
  final OverviewsEmbedder oe=new OverviewsEmbedder();
  oe.setDownsampleStep(2);
  oe.setNumSteps(5);
  oe.setScaleAlgorithm(OverviewsEmbedder.SubsampleAlgorithm.Nearest.toString());
  oe.setTileCache(JAI.getDefaultInstance().getTileCache());
  oe.setTileWidth(256);
  oe.setTileHeight(256);
  oe.setSourcePath(TestData.file(this,"DEM_.tiff").getAbsolutePath());
  oe.addProcessingEventListener(new ProcessingEventListener(){
    private double lastProgress=-1;
    @Override public void getNotification(    ProcessingEvent event){
      assertTrue(lastProgress <= event.getPercentage());
      lastProgress=event.getPercentage();
      assertTrue(lastProgress <= 100);
      assertTrue(lastProgress >= 0);
      LOGGER.info(event.toString());
    }
    @Override public void exceptionOccurred(    ExceptionEvent event){
      LOGGER.warning(event.toString());
    }
  }
);
  oe.run();
  final ImageReader reader=new TIFFImageReaderSpi().createReaderInstance();
  reader.setInput(ImageIO.createImageInputStream(org.geotools.test.TestData.file(this,"DEM_.tiff")));
  assertTrue(reader.getNumImages(true) == 6);
  reader.dispose();
}
