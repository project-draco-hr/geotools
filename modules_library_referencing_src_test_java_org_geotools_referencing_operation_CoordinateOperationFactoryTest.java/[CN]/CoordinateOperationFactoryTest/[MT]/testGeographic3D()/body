{
  final CoordinateReferenceSystem sourceCRS=crsFactory.createFromWKT(NAD27_Z);
  final CoordinateReferenceSystem targetCRS=crsFactory.createFromWKT(WGS84_Z);
  final CoordinateOperation op=opFactory.createOperation(sourceCRS,targetCRS);
  final MathTransform mt=op.getMathTransform();
  assertNotSame(sourceCRS,op.getSourceCRS());
  assertNotSame(targetCRS,op.getTargetCRS());
  assertTrue(op instanceof Transformation);
  assertTrue(sourceCRS instanceof CompoundCRS);
  assertTrue(op.getSourceCRS() instanceof GeographicCRS);
  assertTrue(targetCRS instanceof CompoundCRS);
  assertTrue(op.getTargetCRS() instanceof GeographicCRS);
  assertFalse(sourceCRS.equals(targetCRS));
  assertFalse(op.getSourceCRS().equals(op.getTargetCRS()));
  assertFalse(mt.isIdentity());
  assertInterfaced(mt);
  assertTransformEquals3_3(mt,0,0,0,0.001654978796746043,0.0012755944235822696,66.4042236590758);
  assertTransformEquals3_3(mt,5,8,20,5.0012629560319874,8.001271729856333,120.27929787151515);
  assertTransformEquals3_3(mt,5,8,-20,5.001262964005206,8.001271737831601,80.2792978901416);
  assertTransformEquals3_3(mt,-5,-8,-20,-4.99799698932651,-7.998735783965731,9.007854541763663);
}
