{
  scaleX*=scaleX;
  scaleY*=scaleY;
  double factorX=getNormalizationFactorSquared(kernel,HORIZONTAL);
  double factorY=getNormalizationFactorSquared(kernel,VERTICAL);
  double factor2=(factorX * scaleX + factorY * scaleY) / (factorX + factorY);
  return Math.sqrt(factor2);
}
