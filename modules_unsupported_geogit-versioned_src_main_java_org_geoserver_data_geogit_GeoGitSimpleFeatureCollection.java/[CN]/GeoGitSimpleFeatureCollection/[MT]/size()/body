{
  if (this.cachedSize != null) {
    return this.cachedSize.intValue();
  }
  if (Filter.INCLUDE.equals(filter)) {
    final BigInteger size=typeTree.size();
    return size.intValue();
  }
  final FeatureRefIterator refs=new FeatureRefIterator(typeTree,filter);
  int size;
  if (refs.isFullySupported()) {
    size=Iterators.size(refs);
  }
 else {
    Iterator<SimpleFeature> features=new GeoGitFeatureIterator(refs,type,filter,odb);
    size=Iterators.size(features);
  }
  this.cachedSize=Integer.valueOf(size);
  return size;
}
