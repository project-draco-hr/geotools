{
  Map<String,Serializable> params=new HashMap<String,Serializable>();
  params.put("TESTING",Boolean.TRUE);
  final URL capabilitiesUrl=getClass().getResource("/org/geotools/data/wfs/impl/test-data/" + capabilitiesFile);
  if (capabilitiesUrl == null) {
    throw new IllegalArgumentException(capabilitiesFile + " not found");
  }
  params.put(WFSDataStoreFactory.URL.key,capabilitiesUrl);
  DataStore dataStore=DataStoreFinder.getDataStore(params);
  assertNotNull(dataStore);
  assertTrue(dataStore instanceof WFSContentDataStore);
  WFSContentDataStore wfsDs=(WFSContentDataStore)dataStore;
  assertEquals(expectedVersion.toString(),wfsDs.getInfo().getVersion());
  return wfsDs;
}
