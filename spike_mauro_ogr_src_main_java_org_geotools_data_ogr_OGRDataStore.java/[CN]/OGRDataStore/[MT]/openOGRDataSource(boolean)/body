{
  Pointer ds=null;
  Pointer<Byte> sourcePtr=pointerToCString(ogrSourceName);
  int mode=update ? 1 : 0;
  if (ogrDriver != null) {
    Pointer driver=OGRGetDriverByName(pointerToCString(ogrDriver));
    if (driver == null) {
      throw new IOException("Could not find a driver named " + driver);
    }
    ds=OGR_Dr_Open(driver,sourcePtr,mode);
    if (ds == null) {
      throw new IOException("OGR could not open '" + ogrSourceName + "' in "+ (update ? "read-write" : "read-only")+ " mode with driver "+ ogrDriver);
    }
  }
 else {
    ds=OGROpenShared(sourcePtr,mode,null);
    if (ds == null) {
      throw new IOException("OGR could not open '" + ogrSourceName + "' in "+ (update ? "read-write" : "read-only")+ " mode");
    }
  }
  return ds;
}
