{
  Pointer layer;
  GeometryDescriptor geomType=schema.getGeometryDescriptor();
  ValuedEnum<OGRwkbGeometryType> ogrGeomType=mapper.getOGRGeometryType(geomType);
  Pointer spatialReference=mapper.getSpatialReference(geomType.getCoordinateReferenceSystem());
  layer=OGR_DS_CreateLayer(dataSource,pointerToCString(schema.getTypeName()),spatialReference,ogrGeomType,optionsPointer);
  if (layer == null) {
    throw new DataSourceException("Could not create the OGR layer: " + OGRUtils.getCString(CPLGetLastErrorMsg()));
  }
  return layer;
}
