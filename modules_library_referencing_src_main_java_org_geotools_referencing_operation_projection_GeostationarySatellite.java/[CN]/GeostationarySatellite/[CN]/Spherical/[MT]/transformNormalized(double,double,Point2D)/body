{
  double tmp=Math.cos(phi);
  double Vx=Math.cos(lambda) * tmp;
  double Vy=Math.sin(lambda) * tmp;
  double Vz=Math.sin(phi);
  if (((radius_g - Vx) * Vx - Vy * Vy - Vz * Vz) < 0.) {
    throw new ProjectionException();
  }
  tmp=radius_g - Vx;
  double x=radius_g_1 * Math.atan(Vy / tmp);
  double y=radius_g_1 * Math.atan(Vz / Math.hypot(Vy,tmp));
  p2d.setLocation(x,y);
  return p2d;
}
