{
  if (e0 == e1 && segIndex0 == segIndex1)   return;
  numTests++;
  Coordinate p00=e0.getCoordinates()[segIndex0];
  Coordinate p01=e0.getCoordinates()[segIndex0 + 1];
  Coordinate p10=e1.getCoordinates()[segIndex1];
  Coordinate p11=e1.getCoordinates()[segIndex1 + 1];
  li.computeIntersection(p00,p01,p10,p11);
  if (li.hasIntersection()) {
    if (recordIsolated) {
      e0.setIsolated(false);
      e1.setIsolated(false);
    }
    numIntersections++;
    if (!isTrivialIntersection(e0,segIndex0,e1,segIndex1)) {
      hasIntersection=true;
      if (includeProper || !li.isProper()) {
        e0.addIntersections(li,segIndex0,0);
        e1.addIntersections(li,segIndex1,1);
      }
      if (li.isProper()) {
        properIntersectionPoint=(Coordinate)li.getIntersection(0).clone();
        hasProper=true;
        if (!isBoundaryPoint(li,bdyNodes))         hasProperInterior=true;
      }
    }
  }
}
