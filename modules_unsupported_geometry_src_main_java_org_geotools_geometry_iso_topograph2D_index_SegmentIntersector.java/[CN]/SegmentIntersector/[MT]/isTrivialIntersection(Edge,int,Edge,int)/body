{
  if (e0 == e1) {
    if (li.getIntersectionNum() == 1) {
      if (isAdjacentSegments(segIndex0,segIndex1))       return true;
      if (e0.isClosed()) {
        int maxSegIndex=e0.getNumPoints() - 1;
        if ((segIndex0 == 0 && segIndex1 == maxSegIndex) || (segIndex1 == 0 && segIndex0 == maxSegIndex)) {
          return true;
        }
      }
    }
  }
  return false;
}
