{
  ContentFeatureSource fs=dataStore.getFeatureSource(tname("curves"));
  FilterFactory ff=dataStore.getFilterFactory();
  PropertyIsEqualTo filter=ff.equal(ff.property(aname("name")),ff.literal("Arc segment"),true);
  Query q=new Query(tname("curves"),filter);
  q.getHints().put(Hints.LINEARIZATION_TOLERANCE,0.1);
  ContentFeatureCollection fc=fs.getFeatures(q);
  assertEquals(1,fc.size());
  SimpleFeature feature=DataUtilities.first(fc);
  Geometry g=(Geometry)feature.getDefaultGeometry();
  assertNotNull(g);
  assertTrue(g instanceof SingleCurvedGeometry);
  SingleCurvedGeometry<?> curved=(SingleCurvedGeometry<?>)g;
  double[] cp=curved.getControlPoints();
  assertArrayEquals(new double[]{10,15,15,20,20,15},cp,0d);
  assertEquals(0.1,curved.getTolerance(),0d);
}
