{
  dataStore.createSchema(poly3DType);
  SimpleFeatureType actualSchema=dataStore.getSchema(tname(POLY3D));
  assertFeatureTypesEqual(poly3DType,actualSchema);
  assertEquals(getNativeSRID(),actualSchema.getGeometryDescriptor().getUserData().get(JDBCDataStore.JDBC_NATIVE_SRID));
  GeometryFactory gf=new GeometryFactory();
  LinearRing shell=gf.createLinearRing(new Coordinate[]{new Coordinate(0,0,0),new Coordinate(1,1,1),new Coordinate(1,0,1),new Coordinate(0,0,0)});
  Polygon poly=gf.createPolygon(shell,null);
  FeatureWriter<SimpleFeatureType,SimpleFeature> fw=dataStore.getFeatureWriterAppend(tname(POLY3D),Transaction.AUTO_COMMIT);
  SimpleFeature f=fw.next();
  f.setAttribute(aname(ID),0);
  f.setAttribute(aname(GEOM),poly);
  f.setAttribute(aname(NAME),"3dpolygon!");
  fw.write();
  fw.close();
  FeatureReader<SimpleFeatureType,SimpleFeature> fr=dataStore.getFeatureReader(new DefaultQuery(tname(POLY3D)),Transaction.AUTO_COMMIT);
  assertTrue(fr.hasNext());
  f=fr.next();
  assertTrue(poly.equalsTopo((Geometry)f.getDefaultGeometry()));
  fr.close();
}
