{
  final double offset=PixelTranslation.getPixelTranslation(anchor) + 0.5;
  final int dimension=envelope.getDimension();
  index=new int[dimension * 2];
  for (int i=0; i < dimension; i++) {
    index[i]=(int)Math.round(envelope.getMinimum(i) + offset);
    index[i + dimension]=(int)Math.round(envelope.getMaximum(i) + offset);
  }
  if (isHighIncluded) {
    for (int i=index.length / 2; i < index.length; i++) {
      index[i]++;
    }
  }
  checkCoherence();
}
