{
  WFSNGDataStore datastore=(WFSNGDataStore)getDataStore();
  WFSProtocol wfs=datastore.getWFSProtocol();
  String prefixedTypeName=null;
  Set<QName> names=wfs.getFeatureTypeNames();
  Iterator<QName> it=names.iterator();
  while (it.hasNext() && prefixedTypeName == null) {
    QName name=it.next();
    if (entry.getName().getLocalPart().equals(name.getLocalPart()) && entry.getName().getNamespaceURI().equals(name.getNamespaceURI())) {
      prefixedTypeName=name.getPrefix() + entry.getName().getSeparator() + name.getLocalPart();
    }
  }
  final SimpleFeatureType fType;
  CoordinateReferenceSystem crs;
  try {
    crs=CRS.decode(wfs.getDefaultCRS(prefixedTypeName));
  }
 catch (  NoSuchAuthorityCodeException ex) {
    IOException exception=new IOException("can't decode default CRS for featureType " + prefixedTypeName);
    exception.initCause(ex);
    throw exception;
  }
catch (  FactoryException ex) {
    IOException exception=new IOException("can't decode default CRS for featureType " + prefixedTypeName);
    exception.initCause(ex);
    throw exception;
  }
  final URL describeUrl=wfs.getDescribeFeatureTypeURLGet(prefixedTypeName);
  QName featureDescriptorName=wfs.getFeatureTypeName(prefixedTypeName);
  fType=EmfAppSchemaParser.parseSimpleFeatureType(featureDescriptorName,describeUrl,crs);
  SimpleFeatureTypeBuilder tb=new SimpleFeatureTypeBuilder();
  tb.init(fType);
  tb.setName(entry.getName());
  GeometryDescriptor defaultGeometry=fType.getGeometryDescriptor();
  if (defaultGeometry != null) {
    tb.setDefaultGeometry(defaultGeometry.getLocalName());
    tb.setCRS(defaultGeometry.getCoordinateReferenceSystem());
  }
  try {
    featureType=tb.buildFeatureType();
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  return featureType;
}
