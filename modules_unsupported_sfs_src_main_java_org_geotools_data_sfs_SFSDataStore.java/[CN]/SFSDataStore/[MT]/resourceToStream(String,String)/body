{
  URL url=new URL(baseURL + resource);
  HttpURLConnection urlConnection=(HttpURLConnection)url.openConnection();
  urlConnection.setRequestProperty("Accept-Encoding","gzip");
  urlConnection.setDoInput(true);
  if (postData != null) {
    urlConnection.setRequestMethod("POST");
    urlConnection.setRequestProperty("Content-Type","application/x-www-form-urlencoded");
    urlConnection.setDoOutput(true);
    OutputStreamWriter wr=null;
    try {
      wr=new OutputStreamWriter(urlConnection.getOutputStream());
      wr.write(postData);
      wr.flush();
    }
  finally {
      if (wr != null) {
        wr.close();
      }
    }
  }
 else {
    urlConnection.setRequestMethod("GET");
  }
  if (urlConnection.getResponseCode() != 200) {
    throw new IOException("Server reported and error with code " + urlConnection.getResponseCode() + ": "+ urlConnection.getResponseMessage());
  }
 else {
    InputStream is=urlConnection.getInputStream();
    String encoding=urlConnection.getContentEncoding();
    if ("gzip".equalsIgnoreCase(encoding)) {
      is=new GZIPInputStream(is);
    }
    return is;
  }
}
