{
  ColorMapUtilities.ensureNonNull("ColorMapEntry",entry);
  Expression color=entry.getColor();
  ColorMapUtilities.ensureNonNull("color",color);
  String colorString=(String)color.evaluate(null,String.class);
  if (colorString != null && colorString.startsWith("${")) {
    color=ExpressionExtractor.extractCqlExpressions(colorString);
    colorString=color.evaluate(null,String.class);
  }
  ColorMapUtilities.ensureNonNull("colorString",colorString);
  return Color.decode(colorString);
}
