{
  ColorMapUtilities.ensureNonNull("ColorMapEntry",entry);
  Expression quantity=entry.getQuantity();
  ColorMapUtilities.ensureNonNull("quantity",quantity);
  Double quantityString=(Double)quantity.evaluate(null,Double.class);
  if (quantityString == null && quantity instanceof Literal) {
    String quantityExp=quantity.evaluate(null,String.class);
    quantity=ExpressionExtractor.extractCqlExpressions(quantityExp);
    quantityString=quantity.evaluate(null,Double.class);
  }
  ColorMapUtilities.ensureNonNull("quantityString",quantityString);
  double q=quantityString.doubleValue();
  return q;
}
