{
  String typeName=requestType.getTypeName();
  SimpleFeatureType schemaType=getSchema(typeName);
  LOGGER.fine("requestType: " + requestType);
  LOGGER.fine("schemaType: " + schemaType);
  int compare=DataUtilities.compare(requestType,schemaType);
  Query query;
  if (compare == 0) {
    query=new DefaultQuery(typeName,filter);
  }
 else   if (compare == 1) {
    String[] names=attributeNames(requestType,filter);
    query=new DefaultQuery(typeName,filter,Query.DEFAULT_MAX,names,"getFeatureReader");
  }
 else {
    throw new IOException("Type " + typeName + " does match request");
  }
  if ((filter == Filter.INCLUDE) || filter.equals(Filter.INCLUDE)) {
    return new EmptyFeatureReader(requestType);
  }
  FeatureReader<SimpleFeatureType,SimpleFeature> reader=getFeatureReader(query,transaction);
  if (compare == 1) {
    reader=new ReTypeFeatureReader(reader,requestType);
  }
  return reader;
}
