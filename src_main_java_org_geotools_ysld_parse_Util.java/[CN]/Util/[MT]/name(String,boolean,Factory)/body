{
  try {
    Expression expr=ECQL.toExpression(value,factory.filter);
    if (expr instanceof PropertyName && !ATTRIBUTE_PATTERN.matcher(value).matches()) {
      return factory.filter.literal(((PropertyName)expr).getPropertyName());
    }
    return expr;
  }
 catch (  CQLException e) {
    if (COLOR_PATTERN.matcher(value).matches()) {
      return factory.filter.literal(value);
    }
 else     if (WELLKNOWNNAME_PATTERN.matcher(value).matches()) {
      return factory.filter.literal(value);
    }
 else {
      if (safe) {
        return null;
      }
    }
    throw new IllegalArgumentException("Bad expression: " + value,e);
  }
}
