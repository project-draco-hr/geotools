{
  SimpleFeatureCollection features=loadFeatures(STATE_POP,Query.ALL);
  int count=features.size();
  assertTrue("Have features",count > 0);
  assertEquals("Number of Features loaded",49,features.size());
  assertEquals(49,countFeatures(features));
  SimpleFeatureType schema=firstFeature(features).getFeatureType();
  assertNotNull(schema.getGeometryDescriptor());
  assertEquals("Number of Attributes",253,schema.getAttributeCount());
  assertEquals("Value of statename is wrong",firstFeature(features).getAttribute("STATE_NAME"),"Illinois");
  assertEquals("Value of land area is wrong",((Double)firstFeature(features).getAttribute("LAND_KM")).doubleValue(),143986.61,0.001);
}
