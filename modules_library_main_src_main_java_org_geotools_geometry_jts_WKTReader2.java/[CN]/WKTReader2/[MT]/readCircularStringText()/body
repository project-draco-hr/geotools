{
  List<Coordinate> coordinates=getCoordinateList(true);
  if (coordinates.size() == 0) {
    return geometryFactory.createLineString(new Coordinate[0]);
  }
 else   if (coordinates.size() < 3) {
    throw new ParseException("A CIRCULARSTRING must contain at least 3 control points");
  }
 else {
    double[] controlPoints=toControlPoints(coordinates);
    if (controlPoints[0] == controlPoints[controlPoints.length - 2] && controlPoints[1] == controlPoints[controlPoints.length - 1]) {
      return new CircularRing(controlPoints,geometryFactory,tolerance);
    }
 else {
      return new CircularString(controlPoints,geometryFactory,tolerance);
    }
  }
}
