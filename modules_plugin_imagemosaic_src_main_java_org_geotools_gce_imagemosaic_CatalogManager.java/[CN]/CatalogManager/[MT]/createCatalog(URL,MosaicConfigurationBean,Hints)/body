{
  CatalogConfigurationBean catalogBean=configuration.getCatalogConfigurationBean();
  checkTypeName(sourceURL,configuration);
  if (hints != null && hints.containsKey(Hints.MOSAIC_LOCATION_ATTRIBUTE)) {
    final String hintLocation=(String)hints.get(Hints.MOSAIC_LOCATION_ATTRIBUTE);
    if (!catalogBean.getLocationAttribute().equalsIgnoreCase(hintLocation)) {
      throw new DataSourceException("wrong location attribute");
    }
  }
  return GranuleCatalogFactory.createGranuleCatalog(sourceURL,catalogBean,null);
}
