{
  AggregatingDataStore store=(AggregatingDataStore)DataStoreFinder.getDataStore(params);
  assertNotNull(store);
  assertEquals(2,store.getTypeNames().length);
  assertTrue(store.isTolerant());
  AggregateTypeConfiguration bp=store.getConfiguration("BasicPolygons");
  assertNotNull(bp);
  assertEquals("BasicPolygons",bp.getName());
  assertEquals(2,bp.getSourceTypes().size());
  assertSingleSourceType("BasicPolygons",new NameImpl("store1"),bp);
  assertSingleSourceType("BasicPolygons2",new NameImpl("store2"),bp);
  AggregateTypeConfiguration rs=store.getConfiguration("RoadSegments");
  assertNotNull(rs);
  assertEquals("RoadSegments",rs.getName());
  assertEquals(2,rs.getSourceTypes().size());
  assertSingleSourceType("RoadSegments",new NameImpl("store1"),rs);
  assertSingleSourceType("RoadSegments2",new NameImpl("store3"),rs);
}
