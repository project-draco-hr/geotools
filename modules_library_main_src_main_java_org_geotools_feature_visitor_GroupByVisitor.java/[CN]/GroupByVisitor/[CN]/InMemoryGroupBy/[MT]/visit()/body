{
  Map<List<Object>,CalcResult> results=new HashMap<>();
  for (  Map.Entry<List<Object>,DefaultFeatureCollection> entry : groupByIndexes.entrySet()) {
    FeatureCalc visitor=aggregate.create(expression);
    try {
      entry.getValue().accepts(visitor,progressListener);
    }
 catch (    Exception exception) {
      throw new RuntimeException("Error visiting features collections.",exception);
    }
    results.put(entry.getKey(),visitor.getResult());
  }
  return results;
}
