{
  SimpleFeatureTypeBuilder tb=new SimpleFeatureTypeBuilder();
  for (  AttributeDescriptor ad : schema.getAttributeDescriptors()) {
    if (ad instanceof GeometryDescriptor) {
      GeometryDescriptor gd=(GeometryDescriptor)ad;
      Class<?> binding=ad.getType().getBinding();
      if (Point.class.isAssignableFrom(binding) || GeometryCollection.class.isAssignableFrom(binding)) {
        tb.add(ad);
      }
 else {
        Class target;
        if (LineString.class.isAssignableFrom(binding)) {
          target=MultiLineString.class;
        }
 else         if (Polygon.class.isAssignableFrom(binding)) {
          target=MultiPolygon.class;
        }
 else {
          throw new RuntimeException("Don't know how to handle geometries of type " + binding.getCanonicalName());
        }
        tb.minOccurs(ad.getMinOccurs());
        tb.maxOccurs(ad.getMaxOccurs());
        tb.nillable(ad.isNillable());
        tb.add(ad.getLocalName(),target,gd.getCoordinateReferenceSystem());
      }
    }
 else {
      tb.add(ad);
    }
  }
  tb.setName(schema.getName());
  return tb.buildFeatureType();
}
