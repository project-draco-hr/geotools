{
  Envelope box=clip.getEnvelopeInternal();
  FilterFactory ff=CommonFactoryFinder.getFilterFactory(null);
  String srs=null;
  if (features.getSchema().getCoordinateReferenceSystem() != null) {
    srs=CRS.toSRS(features.getSchema().getCoordinateReferenceSystem());
  }
  BBOX bboxFilter=ff.bbox("",box.getMinX(),box.getMinY(),box.getMaxX(),box.getMaxY(),srs);
  return new ClippingFeatureCollection(features.subCollection(bboxFilter),clip);
}
