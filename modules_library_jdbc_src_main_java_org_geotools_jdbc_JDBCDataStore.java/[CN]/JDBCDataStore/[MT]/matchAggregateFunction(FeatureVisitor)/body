{
  Class visitorClass=isGroupByVisitor(visitor) ? ((GroupByVisitor)visitor).getAggregateVisitor().getClass() : visitor.getClass();
  String function=null;
  while (function == null && visitorClass != null) {
    function=getAggregateFunctions().get(visitorClass);
    visitorClass=visitorClass.getSuperclass();
  }
  if (function == null) {
    LOGGER.info("Unable to find aggregate function matching visitor: " + visitor.getClass());
  }
  return function;
}
