{
  TestData.unzipFile(this,"ensmean.zip");
  final URL timeElevURL=TestData.url(this,"ensmean");
  System.setProperty("org.geotools.shapefile.datetime","true");
  final AbstractGridFormat format=getFormat(timeElevURL);
  assertNotNull(format);
  final ImageMosaicReader reader=getReader(timeElevURL,format);
  assertNotNull(format);
  final String[] metadataNames=reader.getMetadataNames();
  assertNotNull(metadataNames);
  assertEquals(metadataNames.length,4);
  assertEquals("true",reader.getMetadataValue("HAS_TIME_DOMAIN"));
  final String timeMetadata=reader.getMetadataValue("TIME_DOMAIN");
  assertNotNull(timeMetadata);
  assertEquals(16,timeMetadata.split(",").length);
  assertEquals("true",reader.getMetadataValue("HAS_ELEVATION_DOMAIN"));
  final String elevationMetadata=reader.getMetadataValue("ELEVATION_DOMAIN");
  assertNotNull(elevationMetadata);
  assertEquals(2,elevationMetadata.split(",").length);
  final ParameterValue<GridGeometry2D> gg=AbstractGridFormat.READ_GRIDGEOMETRY2D.createValue();
  final GeneralEnvelope envelope=reader.getOriginalEnvelope();
  final Dimension dim=new Dimension();
  dim.setSize(reader.getOriginalGridRange().getSpan(0) / 2.0,reader.getOriginalGridRange().getSpan(1) / 2.0);
  final Rectangle rasterArea=((GridEnvelope2D)reader.getOriginalGridRange());
  rasterArea.setSize(dim);
  final GridEnvelope2D range=new GridEnvelope2D(rasterArea);
  gg.setValue(new GridGeometry2D(range,envelope));
  final ParameterValue<List> time=ImageMosaicFormat.TIME.createValue();
  final List<Date> timeValues=new ArrayList<Date>();
  final SimpleDateFormat sdf=new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.sss'Z'");
  sdf.setTimeZone(TimeZone.getTimeZone("GMT+0"));
  Date date=sdf.parse("2008-10-20T14:00:00.000Z");
  timeValues.add(date);
  time.setValue(timeValues);
  final ParameterValue<List> elevation=AbstractGridFormat.ELEVATION.createValue();
  elevation.setValue(Arrays.asList(10.0));
  final ParameterValue<double[]> bkg=ImageMosaicFormat.BACKGROUND_VALUES.createValue();
  bkg.setValue(new double[]{-9999.0});
  final GridCoverage2D coverage=getCoverage(reader,new GeneralParameterValue[]{gg,time,bkg,elevation});
  testCoverage(reader,new GeneralParameterValue[]{gg,time,bkg,elevation},"Time-Elevation Test",coverage);
}
