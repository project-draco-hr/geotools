{
  final Hints hints=new Hints(Hints.DEFAULT_COORDINATE_REFERENCE_SYSTEM,CRS.decode("EPSG:4326",true));
  AbstractGridCoverage2DReader reader=null;
  try {
    LOGGER.info("Testing Invalid location attribute. (A DataSourceException should be catched) ");
    reader=((AbstractGridFormat)GridFormatFinder.findFormat(rgbURL,hints)).getReader(rgbURL,new Hints(Hints.MOSAIC_LOCATION_ATTRIBUTE,"aaaa"));
    Assert.assertNull(reader);
  }
 catch (  Throwable e) {
    Assert.fail(e.getLocalizedMessage());
  }
  try {
    reader=(AbstractGridCoverage2DReader)((AbstractGridFormat)GridFormatFinder.findFormat(rgbURL,hints)).getReader(rgbURL,new Hints(Hints.MOSAIC_LOCATION_ATTRIBUTE,"location"));
    Assert.assertNotNull(reader);
    reader.dispose();
    Assert.assertTrue(true);
  }
 catch (  Throwable e) {
    Assert.fail(e.getLocalizedMessage());
  }
  try {
    reader=(AbstractGridCoverage2DReader)((AbstractGridFormat)GridFormatFinder.findFormat(rgbURL)).getReader(rgbURL,new Hints(Hints.MAX_ALLOWED_TILES,Integer.valueOf(2)));
    Assert.assertNotNull(reader);
    @SuppressWarnings("unused") GridCoverage2D gc=(GridCoverage2D)reader.read(null);
    Assert.fail("MAX_ALLOWED_TILES was not respected");
  }
 catch (  Throwable e) {
    if (reader != null)     reader.dispose();
    Assert.assertTrue(true);
  }
  try {
    reader=(AbstractGridCoverage2DReader)((AbstractGridFormat)GridFormatFinder.findFormat(rgbURL)).getReader(rgbURL,new Hints(Hints.MAX_ALLOWED_TILES,Integer.valueOf(1000)));
    Assert.assertNotNull(reader);
    GridCoverage2D gc=(GridCoverage2D)reader.read(null);
    Assert.assertTrue(true);
    gc.dispose(true);
    reader.dispose();
  }
 catch (  Exception e) {
    Assert.fail(e.getLocalizedMessage());
  }
}
