{
  data.createSchema(poly3DType);
  SimpleFeatureType actualSchema=data.getSchema(POLY3D);
  assertFeatureTypesEqual(poly3DType,actualSchema);
  GeometryFactory gf=new GeometryFactory();
  LinearRing shell=gf.createLinearRing(new Coordinate[]{new Coordinate(0,0,0),new Coordinate(1,1,1),new Coordinate(1,0,1),new Coordinate(0,0,0)});
  Polygon poly=gf.createPolygon(shell,null);
  FeatureWriter<SimpleFeatureType,SimpleFeature> fw=data.getFeatureWriterAppend(POLY3D,Transaction.AUTO_COMMIT);
  SimpleFeature f=fw.next();
  f.setAttribute(ID,0);
  f.setAttribute(GEOM,poly);
  f.setAttribute(NAME,"3dpolygon!");
  fw.write();
  fw.close();
  FeatureReader<SimpleFeatureType,SimpleFeature> fr=data.getFeatureReader(new DefaultQuery(POLY3D),Transaction.AUTO_COMMIT);
  assertTrue(fr.hasNext());
  f=fr.next();
  assertTrue(poly.equals((Geometry)f.getDefaultGeometry()));
  fr.close();
}
