{
  final Configuration filterConfig=getFilterConfiguration();
  final QName encName;
  if (filterConfig instanceof org.geotools.filter.v1_0.OGCConfiguration || filterConfig instanceof org.geotools.filter.v1_1.OGCConfiguration) {
    encName=org.geotools.filter.v1_0.OGC.Filter;
  }
 else {
    encName=org.geotools.filter.v2_0.FES.Filter;
  }
  Encoder encoder=new Encoder(filterConfig);
  encoder.setOmitXMLDeclaration(true);
  encoder.setEncoding(Charset.forName("UTF-8"));
  String encoded=encoder.encodeAsString(filter,encName);
  encoded=encoded.replaceAll("\n","");
  return encoded;
}
