{
  Set<String> supportedOutputFormats=getServerSupportedOutputFormats(operation);
  String overrideOutputFormat=config.getOutputformatOverride();
  if (overrideOutputFormat != null && supportedOutputFormats.contains(overrideOutputFormat)) {
    return overrideOutputFormat;
  }
  List<String> clientSupportedFormats=getClientSupportedOutputFormats(operation);
  for (  String clientSupported : clientSupportedFormats) {
    if (supportedOutputFormats.contains(clientSupported)) {
      return clientSupported;
    }
  }
  throw new IllegalArgumentException("Client does not support any of the server supported output formats for " + operation);
}
