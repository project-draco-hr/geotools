{
  Source source=new DOMSource(document);
  Parser fake=new Parser(configuration);
  handler=fake.getParserHandler();
  try {
    SAXResult result=new SAXResult(handler);
    TransformerFactory xformerFactory=TransformerFactory.newInstance();
    Transformer xformer=xformerFactory.newTransformer();
    xformer.transform(source,result);
  }
 catch (  TransformerConfigurationException e) {
    new ParserConfigurationException().initCause(e);
  }
catch (  TransformerException e) {
    throw (IOException)new IOException().initCause(e);
  }
  return handler.getValue();
}
