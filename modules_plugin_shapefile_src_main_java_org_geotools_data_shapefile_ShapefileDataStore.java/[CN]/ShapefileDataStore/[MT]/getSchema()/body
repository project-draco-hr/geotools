{
  if (schema == null) {
    List<AttributeDescriptor> types=readAttributes();
    SimpleFeatureType parent=null;
    GeometryDescriptor geomDescriptor=(GeometryDescriptor)types.get(0);
    Class<?> geomBinding=geomDescriptor.getType().getBinding();
    if ((geomBinding == Point.class) || (geomBinding == MultiPoint.class)) {
      parent=BasicFeatureTypes.POINT;
    }
 else     if ((geomBinding == Polygon.class) || (geomBinding == MultiPolygon.class)) {
      parent=BasicFeatureTypes.POLYGON;
    }
 else     if ((geomBinding == LineString.class) || (geomBinding == MultiLineString.class)) {
      parent=BasicFeatureTypes.LINE;
    }
    SimpleFeatureTypeBuilder builder=new SimpleFeatureTypeBuilder();
    builder.setDefaultGeometry(geomDescriptor.getLocalName());
    builder.addAll(types);
    builder.setName(createFeatureTypeName());
    if (namespace != null) {
      builder.setNamespaceURI(namespace);
    }
 else {
      builder.setNamespaceURI(BasicFeatureTypes.DEFAULT_NAMESPACE);
    }
    builder.setAbstract(false);
    if (parent != null) {
      builder.setSuperType(parent);
    }
    schema=builder.buildFeatureType();
  }
  return schema;
}
